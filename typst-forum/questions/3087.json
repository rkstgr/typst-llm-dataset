{
  "topic_metadata": {
    "id": 3087,
    "title": "What is the equivalent of LaTeX's \"\\includegraphics*[scale = 0.3, trim = 0 100 0 200\"]{tiger.png}?",
    "slug": "what-is-the-equivalent-of-latexs-includegraphics-scale-0-3-trim-0-100-0-200-tiger-png",
    "posts_count": 8,
    "created_at": "2025-03-03T17:01:36.360Z",
    "last_posted_at": "2025-03-10T16:26:53.145Z",
    "views": 145,
    "like_count": 2,
    "reply_count": 5,
    "has_accepted_answer": true,
    "accepted_answer_post_number": 2,
    "accepted_answer_username": "flokl",
    "tags": [
      "graphics",
      "latex-migration"
    ],
    "category_id": 5,
    "participant_count": 4,
    "word_count": 569
  },
  "posts": [
    {
      "id": 9330,
      "post_number": 1,
      "username": "pejef",
      "name": "Peter Frings",
      "created_at": "2025-03-03T17:01:36.464Z",
      "updated_at": "2025-03-08T21:25:53.265Z",
      "cooked": "<p>I use a lot of screenshots in my documents (technical specifications of a software application). They all differ in dimensions, sometimes in resolution (72/144dpi), but I need them to have a consistent scale (the larger images are scaled down to fit, so that’s ok).</p>\n<p>Often, I need to trim them as well.</p>\n<p>As far as I understand, the scale in <code>#image(width: 30%, …)</code> refers to the size of the container, similar to LaTeX’s <code>[width = 0.3\\linewidth]</code> option. But that’s not what I need.</p>\n<p>Any suggestions to get this functionality would be more than welcome!</p>\n<p>Thanks,<br>\nPeter.</p>",
      "raw": "I use a lot of screenshots in my documents (technical specifications of a software application). They all differ in dimensions, sometimes in resolution (72/144dpi), but I need them to have a consistent scale (the larger images are scaled down to fit, so that's ok).\n\nOften, I need to trim them as well.\n\nAs far as I understand, the scale in ```#image(width: 30%, …)``` refers to the size of the container, similar to LaTeX's `[width = 0.3\\linewidth]` option. But that's not what I need.\n\nAny suggestions to get this functionality would be more than welcome! \n\nThanks,\nPeter.",
      "reply_to_post_number": null,
      "reply_count": 0,
      "quote_count": 0,
      "like_count": 0,
      "reads": 39,
      "score": 272.8,
      "accepted_answer": false,
      "trust_level": 1,
      "user_id": 1297
    },
    {
      "id": 9348,
      "post_number": 2,
      "username": "flokl",
      "name": "",
      "created_at": "2025-03-03T23:12:18.284Z",
      "updated_at": "2025-03-03T23:26:12.959Z",
      "cooked": "<p>Hi <a class=\"mention\" href=\"/u/pejef\">@pejef</a>,</p>\n<p>I’m not exactly sure what this LaTeX command does, but if you want to scale an image based on its size, you could <a href=\"https://typst.app/docs/reference/layout/measure/\">measure</a> the image’s dimensions and use the scaled measured size as the image’s width/height.</p>\n<pre data-code-wrap=\"typst\"><code class=\"lang-typst\">\n#let scale(scale: 1.0, img) = context {\n  let size = measure(img)\n  set image(width: size.width * scale)\n  img\n}\n\n#scale(scale: .3, image(\"test.png\")) \n</code></pre>\n<p>“Trim” can be emulated by enclosing the image with a box and using <a href=\"https://typst.app/docs/reference/layout/box/#parameters-inset\">inset</a> and <a href=\"https://typst.app/docs/reference/layout/box/#parameters-clip\">clip</a>.</p>\n<pre data-code-wrap=\"typst\"><code class=\"lang-typst\">#box(clip: true, inset: (left: -2cm), image(\"test.png\"))\n</code></pre>",
      "raw": "Hi @pejef,\n\nI'm not exactly sure what this LaTeX command does, but if you want to scale an image based on its size, you could [measure](https://typst.app/docs/reference/layout/measure/) the image's dimensions and use the scaled measured size as the image's width/height.\n\n```typst\n\n#let scale(scale: 1.0, img) = context {\n  let size = measure(img)\n  set image(width: size.width * scale)\n  img\n}\n\n#scale(scale: .3, image(\"test.png\")) \n```\n\n\"Trim\" can be emulated by enclosing the image with a box and using [inset](https://typst.app/docs/reference/layout/box/#parameters-inset) and [clip](https://typst.app/docs/reference/layout/box/#parameters-clip).\n\n```typst\n#box(clip: true, inset: (left: -2cm), image(\"test.png\"))\n```",
      "reply_to_post_number": null,
      "reply_count": 2,
      "quote_count": 0,
      "like_count": 2,
      "reads": 34,
      "score": 56.8,
      "accepted_answer": true,
      "trust_level": 3,
      "user_id": 8
    },
    {
      "id": 9353,
      "post_number": 3,
      "username": "pejef",
      "name": "Peter Frings",
      "created_at": "2025-03-04T08:44:51.071Z",
      "updated_at": "2025-03-04T08:44:51.071Z",
      "cooked": "<p>Ah, nice. So I guess I can make a function with optional arguments that combines the clipping and scaling (and rotation if needed) and combines all this.</p>\n<p>Thanks!</p>",
      "raw": "Ah, nice. So I guess I can make a function with optional arguments that combines the clipping and scaling (and rotation if needed) and combines all this. \n\nThanks!",
      "reply_to_post_number": 2,
      "reply_count": 0,
      "quote_count": 0,
      "like_count": 0,
      "reads": 31,
      "score": 6.2,
      "accepted_answer": false,
      "trust_level": 1,
      "user_id": 1297
    },
    {
      "id": 9598,
      "post_number": 4,
      "username": "pejef",
      "name": "Peter Frings",
      "created_at": "2025-03-10T15:09:03.193Z",
      "updated_at": "2025-03-10T15:09:03.193Z",
      "cooked": "<p>Unfortunately, I can’t make a function that combines the scaling and trimming.<br>\nLet’s say I want to get this (let’s assume that the options are mutually exclusive).</p>\n<pre><code class=\"lang-auto\">#let includegraphics(path, trim: (0pt, 0pt, 0pt, 0pt), scale: none, width: none, height: none) = {\n}\n</code></pre>\n<p>With the <code>trim</code> being relative to the original size of the image.</p>\n<p>Some examples of usage:</p>\n<pre><code class=\"lang-auto\">#includegraphics(\"my-image.png\", scale = 0.7)\n#includegraphics(\"my-image.png\", trim = (10pt, 0pt, 70pt, 100pt))\n#includegraphics(\"my-image.png\", trim = (10pt, 0pt, 70pt, 100pt), scale = 0.8)\n#includegraphics(\"my-image.png\", height = 7cm)\n// etc\n</code></pre>\n<p>To do this, I would have to get the original dimensions of the image (without scaling).<br>\nThen trim as specified.<br>\nThen scale the trimmed image, either by the given scale, either by calculating the scale as (given size/trimmed size)</p>\n<p>However, I can’t seem to get the original dimensions of image?</p>\n<p>Thanks,<br>\nPeter.</p>",
      "raw": "Unfortunately, I can't make a function that combines the scaling and trimming.\nLet's say I want to get this (let's assume that the options are mutually exclusive).\n```\n#let includegraphics(path, trim: (0pt, 0pt, 0pt, 0pt), scale: none, width: none, height: none) = {\n}\n```\nWith the ```trim``` being relative to the original size of the image.\n\nSome examples of usage:\n```\n#includegraphics(\"my-image.png\", scale = 0.7)\n#includegraphics(\"my-image.png\", trim = (10pt, 0pt, 70pt, 100pt))\n#includegraphics(\"my-image.png\", trim = (10pt, 0pt, 70pt, 100pt), scale = 0.8)\n#includegraphics(\"my-image.png\", height = 7cm)\n// etc\n```\n\nTo do this, I would have to get the original dimensions of the image (without scaling).\nThen trim as specified.\nThen scale the trimmed image, either by the given scale, either by calculating the scale as (given size/trimmed size)\n\nHowever, I can't seem to get the original dimensions of image? \n\nThanks,\nPeter.",
      "reply_to_post_number": 2,
      "reply_count": 1,
      "quote_count": 0,
      "like_count": 0,
      "reads": 25,
      "score": 10.0,
      "accepted_answer": false,
      "trust_level": 1,
      "user_id": 1297
    },
    {
      "id": 9600,
      "post_number": 5,
      "username": "gezepi",
      "name": "",
      "created_at": "2025-03-10T15:14:48.626Z",
      "updated_at": "2025-03-10T15:14:48.626Z",
      "cooked": "<p>The only way I know of to trim an image in Typst is by using this package:</p><aside class=\"onebox allowlistedgeneric\" data-onebox-src=\"https://typst.app/universe/package/grayness\">\n  <header class=\"source\">\n      <img src=\"https://forum.typst.app/uploads/default/original/1X/098187a593d51c4db99324614e2baeeb1bb355cc.png\" class=\"site-icon\" data-dominant-color=\"3CA8B6\" width=\"32\" height=\"32\">\n\n      <a href=\"https://typst.app/universe/package/grayness\" target=\"_blank\" rel=\"noopener\">Typst</a>\n  </header>\n\n  <article class=\"onebox-body\">\n    <div class=\"aspect-image\" style=\"--aspect-ratio:690/361;\"><img src=\"https://forum.typst.app/uploads/default/optimized/1X/db1c18ed802fe6841bee62606931f352da10ed09_2_690x362.png\" class=\"thumbnail\" data-dominant-color=\"7CC2C5\" width=\"690\" height=\"362\"></div>\n\n<h3><a href=\"https://typst.app/universe/package/grayness\" target=\"_blank\" rel=\"noopener\">grayness – Typst Universe</a></h3>\n\n  <p>Simple image editing capabilities like converting to grayscale and cropping via a WASM plugin.</p>\n\n\n  </article>\n\n  <div class=\"onebox-metadata\">\n    \n    \n  </div>\n\n  <div style=\"clear: both\"></div>\n</aside>\n\n<p>I don’t know if it would satisfy your needs out of the box, but it might help you get to your solution.</p>",
      "raw": "The only way I know of to trim an image in Typst is by using this package:\nhttps://typst.app/universe/package/grayness\n\nI don't know if it would satisfy your needs out of the box, but it might help you get to your solution.",
      "reply_to_post_number": null,
      "reply_count": 0,
      "quote_count": 0,
      "like_count": 0,
      "reads": 22,
      "score": 9.4,
      "accepted_answer": false,
      "trust_level": 3,
      "user_id": 326
    },
    {
      "id": 9601,
      "post_number": 6,
      "username": "sijo",
      "name": "",
      "created_at": "2025-03-10T15:19:11.517Z",
      "updated_at": "2025-03-10T15:19:11.517Z",
      "cooked": "<aside class=\"quote no-group\" data-username=\"pejef\" data-post=\"4\" data-topic=\"3087\">\n<div class=\"title\">\n<div class=\"quote-controls\"></div>\n<img loading=\"lazy\" alt=\"\" width=\"24\" height=\"24\" src=\"https://forum.typst.app/letter_avatar_proxy/v4/letter/p/66104C/48.png\" class=\"avatar\"> pejef:</div>\n<blockquote>\n<p>However, I can’t seem to get the original dimensions of image?</p>\n</blockquote>\n</aside>\n<p>Doesn’t <code>measure(img)</code> do what you want?</p>",
      "raw": "[quote=\"pejef, post:4, topic:3087\"]\nHowever, I can’t seem to get the original dimensions of image?\n[/quote]\n\nDoesn't `measure(img)` do what you want?",
      "reply_to_post_number": 4,
      "reply_count": 1,
      "quote_count": 1,
      "like_count": 0,
      "reads": 18,
      "score": 8.6,
      "accepted_answer": false,
      "trust_level": 3,
      "user_id": 332
    },
    {
      "id": 9605,
      "post_number": 7,
      "username": "pejef",
      "name": "Peter Frings",
      "created_at": "2025-03-10T15:59:41.660Z",
      "updated_at": "2025-03-10T15:59:41.660Z",
      "cooked": "<p>Good suggestion!</p>\n<pre><code class=\"lang-auto\">  // Measure the natural size of the image\n  let img = measure(image(path))\n  let orig_w = img.width\n  let orig_h = img.height\n</code></pre>\n<p>unfortunately, Typst is not happy:</p>\n<pre><code class=\"lang-auto\">error: can only be used when context is known\n   ┌─ barcode.typ:43:12\n   │\n43 │   let img = measure(image(path))\n   │             ^^^^^^^^^^^^^^^^^^^^\n</code></pre>\n<p>Mission impossible?</p>",
      "raw": "Good suggestion!\n```\n  // Measure the natural size of the image\n  let img = measure(image(path))\n  let orig_w = img.width\n  let orig_h = img.height\n```\nunfortunately, Typst is not happy:\n```\nerror: can only be used when context is known\n   ┌─ barcode.typ:43:12\n   │\n43 │   let img = measure(image(path))\n   │             ^^^^^^^^^^^^^^^^^^^^\n```\n\nMission impossible?",
      "reply_to_post_number": 6,
      "reply_count": 1,
      "quote_count": 0,
      "like_count": 0,
      "reads": 18,
      "score": 13.6,
      "accepted_answer": false,
      "trust_level": 1,
      "user_id": 1297
    },
    {
      "id": 9609,
      "post_number": 8,
      "username": "sijo",
      "name": "",
      "created_at": "2025-03-10T16:26:53.145Z",
      "updated_at": "2025-03-10T16:27:05.809Z",
      "cooked": "<p>As the error says, you must provide a context:</p>\n<pre data-code-wrap=\"typc\"><code class=\"lang-typc\">context {\n  let img = measure(image(path))\n  let orig_w = img.width\n  let orig_h = img.height\n}\n</code></pre>\n<p>Note that you cannot use <code>orig_w</code> or <code>orig_h</code> outside of the context block. You must surround with <code>context</code> the whole piece of code that uses the context.</p>",
      "raw": "As the error says, you must provide a context:\n\n```typc\ncontext {\n  let img = measure(image(path))\n  let orig_w = img.width\n  let orig_h = img.height\n}\n```\n\nNote that you cannot use `orig_w` or `orig_h` outside of the context block. You must surround with `context` the whole piece of code that uses the context.",
      "reply_to_post_number": 7,
      "reply_count": 0,
      "quote_count": 0,
      "like_count": 0,
      "reads": 17,
      "score": 3.4,
      "accepted_answer": false,
      "trust_level": 3,
      "user_id": 332
    }
  ],
  "scraped_at": "2025-06-10T09:50:49.598448"
}