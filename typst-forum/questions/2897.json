{
  "topic_metadata": {
    "id": 2897,
    "title": "How to fix an equation numbering overlapping with the equation?",
    "slug": "how-to-fix-an-equation-numbering-overlapping-with-the-equation",
    "posts_count": 4,
    "created_at": "2025-02-20T11:10:33.642Z",
    "last_posted_at": "2025-02-20T14:09:44.044Z",
    "views": 80,
    "like_count": 1,
    "reply_count": 2,
    "has_accepted_answer": true,
    "accepted_answer_post_number": 2,
    "accepted_answer_username": "aarnent",
    "tags": [
      "scripting",
      "layout",
      "math"
    ],
    "category_id": 5,
    "participant_count": 2,
    "word_count": 320
  },
  "posts": [
    {
      "id": 8816,
      "post_number": 1,
      "username": "Shujun_Tan",
      "name": "Shujun Tan",
      "created_at": "2025-02-20T11:10:33.892Z",
      "updated_at": "2025-02-22T09:58:14.324Z",
      "cooked": "<p>Hi, everyone. I found that my long equation overlaps with the equation numbering.  How could I address this problem? Thank you.</p>\n<pre><code class=\"lang-auto\">#set heading(numbering: \"1.1\")\n#set par(justify: true)\n#set page(numbering: \"1 of 1\")\n\n#set math.equation(numbering: (..nums) =&gt; {\n  let section = counter(heading).get().first()\n  numbering(\"(1.1)\", section, ..nums)\n})\n\n#show heading.where(level: 1): it =&gt; {\n  counter(math.equation).update(0)\n  it\n}\n\n#show ref: it =&gt; {\n  let eq = math.equation\n  let el = it.element\n  if el != none and el.func() == eq {\n    // Override equation references.\n   \"expression \"\n    numbering(\n      el.numbering,\n      ..counter(eq).at(el.location())\n    )\n  } else {\n    // Other references as usual.\n    it\n  }\n}\n\n\n#import \"@preview/glossarium:0.5.1\": make-glossary, register-glossary, print-glossary, gls, glspl\n#show: make-glossary\n\n$\nPP[(s_a,r_a),(s_b,r_b)] &amp;= frac(PP_(\"incr\")(L_a,L_b)^N, PP_(\"incr\")(L_a,L_b)^N + PP_(\"incr\")(L_b,L_a)^N) \\\n&amp;= frac([1/4 B(u_S (s_a),u_S (s_b)) + 1/4 B(u_R (r_a),u_R (r_b))]^N,[1/4 B(u_S (s_a),u_S (s_b)) + 1/4 B(u_R (r_a),u_R (r_b))]^N + [1/4 B(u_S (s_b),u_S (s_a)) + 1/4 B(u_R (r_a),u_R (r_b))]^N) \\\n&amp;= cases(\n  1\",\" s_a &gt;= s_b \"and\" r_a &gt;= r_b \"and at least one of them strictly holds\" \\\n  0.5\",\" (s_a = s_b \"and\" r_a = r_b) \"or\" (s_a &gt; s_b \"and\" r_a &lt; r_b) \"or\" (s_a &lt; s_b \"and\" r_a &gt; r_b) \\\n  0\",\" \"otherwise (that is,\" s_a &lt;= s_b \"and\" r_a &lt;= r_b \"and at least one of them strictly holds)\"\n)\n$ &lt;ChoiceProb&gt;\n</code></pre>\n<p>You see, the numbering (0.1) overlaps with the long formula:</p>\n<p><div class=\"lightbox-wrapper\"><a class=\"lightbox\" href=\"https://forum.typst.app/uploads/default/original/2X/9/9c3f7ba116eb9930e3f2cb46f9dcbc2807b1f55f.png\" data-download-href=\"https://forum.typst.app/uploads/default/9c3f7ba116eb9930e3f2cb46f9dcbc2807b1f55f\" title=\"QQ20250220-111350\"><img src=\"https://forum.typst.app/uploads/default/optimized/2X/9/9c3f7ba116eb9930e3f2cb46f9dcbc2807b1f55f_2_690x180.png\" alt=\"QQ20250220-111350\" data-base62-sha1=\"mieuOd8ViPBi4qFuKgiARgGuixF\" width=\"690\" height=\"180\" srcset=\"https://forum.typst.app/uploads/default/optimized/2X/9/9c3f7ba116eb9930e3f2cb46f9dcbc2807b1f55f_2_690x180.png, https://forum.typst.app/uploads/default/original/2X/9/9c3f7ba116eb9930e3f2cb46f9dcbc2807b1f55f.png 1.5x, https://forum.typst.app/uploads/default/original/2X/9/9c3f7ba116eb9930e3f2cb46f9dcbc2807b1f55f.png 2x\" data-dominant-color=\"F5F4F4\"><div class=\"meta\"><svg class=\"fa d-icon d-icon-far-image svg-icon\" aria-hidden=\"true\"><use href=\"#far-image\"></use></svg><span class=\"filename\">QQ20250220-111350</span><span class=\"informations\">893Ã—234 56.6 KB</span><svg class=\"fa d-icon d-icon-discourse-expand svg-icon\" aria-hidden=\"true\"><use href=\"#discourse-expand\"></use></svg></div></a></div></p>",
      "raw": "Hi, everyone. I found that my long equation overlaps with the equation numbering.  How could I address this problem? Thank you.\n\n\n\n```\n#set heading(numbering: \"1.1\")\n#set par(justify: true)\n#set page(numbering: \"1 of 1\")\n\n#set math.equation(numbering: (..nums) => {\n  let section = counter(heading).get().first()\n  numbering(\"(1.1)\", section, ..nums)\n})\n\n#show heading.where(level: 1): it => {\n  counter(math.equation).update(0)\n  it\n}\n\n#show ref: it => {\n  let eq = math.equation\n  let el = it.element\n  if el != none and el.func() == eq {\n    // Override equation references.\n   \"expression \"\n    numbering(\n      el.numbering,\n      ..counter(eq).at(el.location())\n    )\n  } else {\n    // Other references as usual.\n    it\n  }\n}\n\n\n#import \"@preview/glossarium:0.5.1\": make-glossary, register-glossary, print-glossary, gls, glspl\n#show: make-glossary\n\n$\nPP[(s_a,r_a),(s_b,r_b)] &= frac(PP_(\"incr\")(L_a,L_b)^N, PP_(\"incr\")(L_a,L_b)^N + PP_(\"incr\")(L_b,L_a)^N) \\\n&= frac([1/4 B(u_S (s_a),u_S (s_b)) + 1/4 B(u_R (r_a),u_R (r_b))]^N,[1/4 B(u_S (s_a),u_S (s_b)) + 1/4 B(u_R (r_a),u_R (r_b))]^N + [1/4 B(u_S (s_b),u_S (s_a)) + 1/4 B(u_R (r_a),u_R (r_b))]^N) \\\n&= cases(\n  1\",\" s_a >= s_b \"and\" r_a >= r_b \"and at least one of them strictly holds\" \\\n  0.5\",\" (s_a = s_b \"and\" r_a = r_b) \"or\" (s_a > s_b \"and\" r_a < r_b) \"or\" (s_a < s_b \"and\" r_a > r_b) \\\n  0\",\" \"otherwise (that is,\" s_a <= s_b \"and\" r_a <= r_b \"and at least one of them strictly holds)\"\n)\n$ <ChoiceProb>\n```\n\nYou see, the numbering (0.1) overlaps with the long formula:\n\n![QQ20250220-111350|690x180](upload://mieuOd8ViPBi4qFuKgiARgGuixF.png)",
      "reply_to_post_number": null,
      "reply_count": 0,
      "quote_count": 0,
      "like_count": 0,
      "reads": 32,
      "score": 196.4,
      "accepted_answer": false,
      "trust_level": 1,
      "user_id": 283
    },
    {
      "id": 8819,
      "post_number": 2,
      "username": "aarnent",
      "name": "",
      "created_at": "2025-02-20T11:35:04.660Z",
      "updated_at": "2025-02-20T11:35:04.660Z",
      "cooked": "<p>There is the <a href=\"https://typst.app/docs/reference/math/equation/#parameters-number-align\">equation.number-align</a> property that you can set. Does that work for you, or do you seek a more customisable solution?</p>",
      "raw": "There is the [equation.number-align](https://typst.app/docs/reference/math/equation/#parameters-number-align) property that you can set. Does that work for you, or do you seek a more customisable solution?",
      "reply_to_post_number": null,
      "reply_count": 1,
      "quote_count": 0,
      "like_count": 0,
      "reads": 31,
      "score": 21.2,
      "accepted_answer": true,
      "trust_level": 3,
      "user_id": 501
    },
    {
      "id": 8823,
      "post_number": 3,
      "username": "Shujun_Tan",
      "name": "Shujun Tan",
      "created_at": "2025-02-20T13:33:42.184Z",
      "updated_at": "2025-02-20T13:33:42.184Z",
      "cooked": "<p>Yeah it does, thank you!</p>",
      "raw": "Yeah it does, thank you!",
      "reply_to_post_number": 2,
      "reply_count": 1,
      "quote_count": 0,
      "like_count": 0,
      "reads": 25,
      "score": 10.0,
      "accepted_answer": false,
      "trust_level": 1,
      "user_id": 283
    },
    {
      "id": 8824,
      "post_number": 4,
      "username": "aarnent",
      "name": "",
      "created_at": "2025-02-20T14:09:44.044Z",
      "updated_at": "2025-02-20T14:09:44.044Z",
      "cooked": "<p>No problem. If that solved it, please mark the comment as the solution using the checkmark icon. It makes it easier for future readers to filter &amp; find <img src=\"https://forum.typst.app/images/emoji/apple/slight_smile.png?v=12\" title=\":slight_smile:\" class=\"emoji\" alt=\":slight_smile:\" loading=\"lazy\" width=\"20\" height=\"20\"></p>",
      "raw": "No problem. If that solved it, please mark the comment as the solution using the checkmark icon. It makes it easier for future readers to filter & find :slight_smile:",
      "reply_to_post_number": 3,
      "reply_count": 0,
      "quote_count": 0,
      "like_count": 1,
      "reads": 24,
      "score": 19.8,
      "accepted_answer": false,
      "trust_level": 3,
      "user_id": 501
    }
  ],
  "scraped_at": "2025-06-10T09:51:26.881080"
}