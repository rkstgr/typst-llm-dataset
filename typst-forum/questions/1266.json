{
  "topic_metadata": {
    "id": 1266,
    "title": "Why the definition of \"show regex\" doesn't work in a function?",
    "slug": "why-the-definition-of-show-regex-doesnt-work-in-a-function",
    "posts_count": 4,
    "created_at": "2024-10-21T15:25:05.758Z",
    "last_posted_at": "2024-10-21T16:38:41.992Z",
    "views": 156,
    "like_count": 3,
    "reply_count": 1,
    "has_accepted_answer": true,
    "accepted_answer_post_number": 3,
    "accepted_answer_username": "ParaN3xus",
    "tags": [
      "scripting"
    ],
    "category_id": 5,
    "participant_count": 3,
    "word_count": 230
  },
  "posts": [
    {
      "id": 4419,
      "post_number": 1,
      "username": "andres.gimenez",
      "name": "Andrés Jorge Giménez Muñoz",
      "created_at": "2024-10-21T15:25:05.949Z",
      "updated_at": "2024-10-21T15:25:05.949Z",
      "cooked": "<p>I want to define several rules with show regex in a template. If you define show regex within the insole, before the bodysuit works.</p>\n<pre data-code-wrap=\"typ\"><code class=\"lang-typ\">#let my-template(\n  body\n) = {\n  [My template]\n\n  show regex(\"=+/?(.+)\"): it =&gt; {\n     it.fields()\n  }\n\n  body\n}\n</code></pre>\n<p>But if I define a function in another file and call it from the template, it doesn’t work for me. Why does this happen?</p>\n<pre data-code-wrap=\"typ\"><code class=\"lang-typ\">#import \"./sugar.typ\": *\n\n#let my-template(\n  body\n) = {\n  [My template]\n\n  __sugar()\n\n  body\n}\n</code></pre>\n<p>Let me leave an example</p>\n<p><a href=\"https://typst.app/project/rDUPwG7CTptF_cKa8D2_Pv\" class=\"onebox\" target=\"_blank\" rel=\"noopener\">https://typst.app/project/rDUPwG7CTptF_cKa8D2_Pv</a></p>",
      "raw": "I want to define several rules with show regex in a template. If you define show regex within the insole, before the bodysuit works. \n\n```typ\n#let my-template(\n  body\n) = {\n  [My template]\n\n  show regex(\"=+/?(.+)\"): it => {\n     it.fields()\n  }\n\n  body\n}\n```\n\nBut if I define a function in another file and call it from the template, it doesn't work for me. Why does this happen?\n\n```typ\n#import \"./sugar.typ\": *\n\n#let my-template(\n  body\n) = {\n  [My template]\n\n  __sugar()\n\n  body\n}\n```\n\nLet me leave an example\n\nhttps://typst.app/project/rDUPwG7CTptF_cKa8D2_Pv",
      "reply_to_post_number": null,
      "reply_count": 0,
      "quote_count": 0,
      "like_count": 0,
      "reads": 33,
      "score": 356.6,
      "accepted_answer": false,
      "trust_level": 1,
      "user_id": 543
    },
    {
      "id": 4423,
      "post_number": 2,
      "username": "SillyFreak",
      "name": "SillyFreak",
      "created_at": "2024-10-21T15:42:40.651Z",
      "updated_at": "2024-10-21T15:43:47.115Z",
      "cooked": "<p>This looks like a duplicate of this post:</p>\n<aside class=\"quote quote-modified\" data-post=\"1\" data-topic=\"1042\">\n  <div class=\"title\">\n    <div class=\"quote-controls\"></div>\n    <img loading=\"lazy\" alt=\"\" width=\"24\" height=\"24\" src=\"https://forum.typst.app/letter_avatar_proxy/v4/letter/l/00298C/48.png\" class=\"avatar\">\n    <a href=\"https://forum.typst.app/t/why-is-the-template-function-i-wrote-not-working-properly/1042\">Why is the template function I wrote not working properly?</a> <a class=\"badge-category__wrapper \" href=\"/c/questions/5\"><span data-category-id=\"5\" style=\"--category-badge-color: #F7C000; --category-badge-text-color: #fdfdfd;\" data-drop-close=\"true\" class=\"badge-category \" title=\"Your questions about using Typst and the web app go in this category.\"><span class=\"badge-category__name\">Questions</span></span></a>\n  </div>\n  <blockquote>\n    I am trying to put all my style and ctheorem customisations in a separate template file. I want to call a single #show all in my document. The code below works, except that I can’t seem to call two functions within #all() that both take and return #doc. As per my comments within the code, the theorems are formatting perfectly, but the styles are not applying. I am new and don’t (yet) properly understand how Typst is processing everything. Also, if I call styles first and then theorems, styles wo…\n  </blockquote>\n</aside>\n\n<p>Edit: not exactly, but I think the answer there will help you a lot.</p>",
      "raw": "This looks like a duplicate of this post:\n\nhttps://forum.typst.app/t/why-is-the-template-function-i-wrote-not-working-properly/1042\n\nEdit: not exactly, but I think the answer there will help you a lot.",
      "reply_to_post_number": null,
      "reply_count": 0,
      "quote_count": 0,
      "like_count": 1,
      "reads": 34,
      "score": 31.8,
      "accepted_answer": false,
      "trust_level": 3,
      "user_id": 32
    },
    {
      "id": 4424,
      "post_number": 3,
      "username": "ParaN3xus",
      "name": "ParaN3xus",
      "created_at": "2024-10-21T15:43:58.812Z",
      "updated_at": "2024-10-21T15:43:58.812Z",
      "cooked": "<p>This is because <code>show</code> only works on content within its scope. In your example, this scope is the interior of the <code>__sugar()</code> function definition.</p>\n<p>The principle of <code>show</code> is that it will take everything that matches its selector below and within its scope, and process it using the function you specify. So when you call <code>__sugar()</code>, <code>show</code> did nothing because there is nothing else in it’s  scope.</p>\n<p>To fix this issue, you need to write another <code>show</code> in the scope you want. For example:</p>\n<pre data-code-wrap=\"typ\"><code class=\"lang-typ\">#let __sugar(content) = {\n  show regex(\"=+/?(.+)\"): it =&gt; {\n    it.fields()\n  }\n  content\n}\n\n#let my-template(\n  body\n) = {\n  [My template]\n\n  show: __sugar\n\n  body\n}\n</code></pre>",
      "raw": "This is because `show` only works on content within its scope. In your example, this scope is the interior of the `__sugar()` function definition.\n\nThe principle of `show` is that it will take everything that matches its selector below and within its scope, and process it using the function you specify. So when you call `__sugar()`, `show` did nothing because there is nothing else in it's  scope.\n\nTo fix this issue, you need to write another `show` in the scope you want. For example:\n```typ\n#let __sugar(content) = {\n  show regex(\"=+/?(.+)\"): it => {\n    it.fields()\n  }\n  content\n}\n\n#let my-template(\n  body\n) = {\n  [My template]\n\n  show: __sugar\n\n  body\n}\n```",
      "reply_to_post_number": null,
      "reply_count": 1,
      "quote_count": 0,
      "like_count": 1,
      "reads": 32,
      "score": 101.4,
      "accepted_answer": true,
      "trust_level": 2,
      "user_id": 14
    },
    {
      "id": 4432,
      "post_number": 4,
      "username": "andres.gimenez",
      "name": "Andrés Jorge Giménez Muñoz",
      "created_at": "2024-10-21T16:38:41.992Z",
      "updated_at": "2024-10-21T16:41:30.221Z",
      "cooked": "<p>Thanks for the reply.</p>",
      "raw": "Thanks for the reply.",
      "reply_to_post_number": 3,
      "reply_count": 0,
      "quote_count": 0,
      "like_count": 1,
      "reads": 29,
      "score": 20.8,
      "accepted_answer": false,
      "trust_level": 1,
      "user_id": 543
    }
  ],
  "scraped_at": "2025-06-10T09:56:15.543244"
}