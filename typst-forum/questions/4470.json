{
  "topic_metadata": {
    "id": 4470,
    "title": "Why is a @reference not resolved when passed as argument to a function?",
    "slug": "why-is-a-reference-not-resolved-when-passed-as-argument-to-a-function",
    "posts_count": 4,
    "created_at": "2025-06-05T03:50:05.814Z",
    "last_posted_at": "2025-06-05T17:18:51.629Z",
    "views": 46,
    "like_count": 0,
    "reply_count": 1,
    "has_accepted_answer": true,
    "accepted_answer_post_number": 2,
    "accepted_answer_username": "fabien_sanglard",
    "tags": [
      "referencing",
      "syntax"
    ],
    "category_id": 5,
    "participant_count": 2,
    "word_count": 323
  },
  "posts": [
    {
      "id": 13731,
      "post_number": 1,
      "username": "fabien_sanglard",
      "name": "fabien sanglard",
      "created_at": "2025-06-05T03:50:05.896Z",
      "updated_at": "2025-06-05T21:47:03.996Z",
      "cooked": "<p>I have created a quote function.</p>\n<pre data-code-wrap=\"typ\"><code class=\"lang-typ\">#let quote(text, author) = {\n  rect(\n     inset: 0in,\n     box(\n        width: 100%,\n        fill: silver,\n        inset: 1em,\n        [#text\n        #align(right)[#sym.dash #author]\n        ],   \n      )\n  )\n}\n</code></pre>\n<p>It works as expect.</p>\n<pre data-code-wrap=\"typ\"><code class=\"lang-typ\">#quote(\"blablablabla\", \"John\")\n</code></pre>\n<p>The problem is that if I try to add a reference in the author parameter (e.g: <code>John@myReference</code>). Then it just prints that “text” verbatim, without resolving the reference (I see <code>- John@myReference</code> as the author of the quote instead of <code>John[1]</code>. Is there a solution to this or my <code>quote</code> function is wrong?</p>",
      "raw": "I have created a quote function.\n```\n#let quote(text, author) = {\n  rect(\n     inset: 0in,\n     box(\n        width: 100%,\n        fill: silver,\n        inset: 1em,\n        [#text\n        #align(right)[#sym.dash #author]\n        ],   \n      )\n  )\n}\n```\nIt works as expect.\n\n```\n#quote(\"blablablabla\", \"John\")\n```\n\nThe problem is that if I try to add a reference in the author parameter (e.g: `John@myReference`). Then it just prints that \"text\" verbatim, without resolving the reference (I see `- John@myReference` as the author of the quote instead of `John[1]`. Is there a solution to this or my `quote` function is wrong?",
      "reply_to_post_number": null,
      "reply_count": 0,
      "quote_count": 0,
      "like_count": 0,
      "reads": 20,
      "score": 8.8,
      "accepted_answer": false,
      "trust_level": 1,
      "user_id": 1707
    },
    {
      "id": 13732,
      "post_number": 2,
      "username": "fabien_sanglard",
      "name": "fabien sanglard",
      "created_at": "2025-06-05T04:05:29.893Z",
      "updated_at": "2025-06-05T04:05:29.893Z",
      "cooked": "<p>I found the answer. I will leave it here in case it can help someone. The problem is that I was invoking the function with a <code>string</code> instead of a <code>content</code>.</p>\n<pre data-code-wrap=\"typ\"><code class=\"lang-typ\">#quote(\"blablablabla\", [John@myRef])\n</code></pre>\n<p>works \\0/ !</p>",
      "raw": "I found the answer. I will leave it here in case it can help someone. The problem is that I was invoking the function with a `string` instead of a `content`.\n\n```\n#quote(\"blablablabla\", [John@myRef])\n```\n\nworks \\0/ !",
      "reply_to_post_number": null,
      "reply_count": 0,
      "quote_count": 0,
      "like_count": 0,
      "reads": 20,
      "score": 8.6,
      "accepted_answer": true,
      "trust_level": 1,
      "user_id": 1707
    },
    {
      "id": 13758,
      "post_number": 3,
      "username": "fabien_sanglard",
      "name": "fabien sanglard",
      "created_at": "2025-06-05T13:58:06.527Z",
      "updated_at": "2025-06-05T14:05:17.633Z",
      "cooked": "<p>Still this is a bit tedious to have to call the function with content instead of a string.<br>\nwhy can I not convert the string <code>author</code> back into a content with <code>[#author]</code>? The following does not work.</p>\n<pre data-code-wrap=\"typ\"><code class=\"lang-typ\">#let quote(text, author) = {\n  rect(\n     inset: 0in,\n     box(\n        width: 100%,\n        fill: silver,\n        inset: 1em,\n        [#text\n        #align(right)[#sym.dash #author]\n        ],   \n      )\n  )\n}\n</code></pre>\n<p>Notice how I try to convert the string into a content with <code>[#string]</code> (to no avail).</p>",
      "raw": "Still this is a bit tedious to have to call the function with content instead of a string. \nwhy can I not convert the string `author` back into a content with `[#author]`? The following does not work.\n\n```\n#let quote(text, author) = {\n  rect(\n     inset: 0in,\n     box(\n        width: 100%,\n        fill: silver,\n        inset: 1em,\n        [#text\n        #align(right)[#sym.dash #author]\n        ],   \n      )\n  )\n}\n```\n\nNotice how I try to convert the string into a content with `[#string]` (to no avail).",
      "reply_to_post_number": null,
      "reply_count": 1,
      "quote_count": 0,
      "like_count": 0,
      "reads": 20,
      "score": 13.6,
      "accepted_answer": false,
      "trust_level": 1,
      "user_id": 1707
    },
    {
      "id": 13786,
      "post_number": 4,
      "username": "Andrew",
      "name": "",
      "created_at": "2025-06-05T17:18:51.629Z",
      "updated_at": "2025-06-05T17:18:51.629Z",
      "cooked": "<p><a href=\"https://typst.app/docs/reference/model/ref/#syntax\">The reference syntax</a> is only available in <a href=\"https://typst.app/docs/reference/syntax/#markup\">markup mode</a>. You shouldn’t use things like they are not supposed to be used, this gives no benefit whatsoever. You can use <a href=\"https://typst.app/docs/reference/foundations/eval/\"><code>eval</code></a> to evaluate stuff.</p>\n<p>There is a built-in <a href=\"https://typst.app/docs/reference/model/quote/\"><code>quote</code></a> function:</p>\n<pre data-code-wrap=\"typ\"><code class=\"lang-typ\">#show quote.where(block: true): set pad(0pt)\n#show quote.where(block: true): block.with(\n  width: 100%,\n  inset: 1em,\n  stroke: 1pt,\n  fill: silver,\n)\n\n#let attr = eval.with(mode: \"markup\")\n\n#figure(supplement: \"Mastodon\")[] &lt;myRef&gt;\n\n#quote(\"blablablabla\", block: true, attribution: [John@myRef])\n\n#quote(\"blablablabla\", block: true, attribution: attr(\"John@myRef\"))\n</code></pre>\n<p><div class=\"lightbox-wrapper\"><a class=\"lightbox\" href=\"https://forum.typst.app/uploads/default/original/2X/4/4a14f68969ee946e3617d8c4c392f53ec1ee7bae.png\" data-download-href=\"https://forum.typst.app/uploads/default/4a14f68969ee946e3617d8c4c392f53ec1ee7bae\" title=\"image\"><img src=\"https://forum.typst.app/uploads/default/original/2X/4/4a14f68969ee946e3617d8c4c392f53ec1ee7bae.png\" alt=\"image\" data-base62-sha1=\"azmffgwDHSdeNLFXUBvLh0CcsuW\" width=\"591\" height=\"173\"><div class=\"meta\"><svg class=\"fa d-icon d-icon-far-image svg-icon\" aria-hidden=\"true\"><use href=\"#far-image\"></use></svg><span class=\"filename\">image</span><span class=\"informations\">591×173 6.83 KB</span><svg class=\"fa d-icon d-icon-discourse-expand svg-icon\" aria-hidden=\"true\"><use href=\"#discourse-expand\"></use></svg></div></a></div></p>",
      "raw": "[The reference syntax](https://typst.app/docs/reference/model/ref/#syntax) is only available in [markup mode](https://typst.app/docs/reference/syntax/#markup). You shouldn't use things like they are not supposed to be used, this gives no benefit whatsoever. You can use [`eval`](https://typst.app/docs/reference/foundations/eval/) to evaluate stuff.\n\nThere is a built-in [`quote`](https://typst.app/docs/reference/model/quote/) function:\n\n```typ\n#show quote.where(block: true): set pad(0pt)\n#show quote.where(block: true): block.with(\n  width: 100%,\n  inset: 1em,\n  stroke: 1pt,\n  fill: silver,\n)\n\n#let attr = eval.with(mode: \"markup\")\n\n#figure(supplement: \"Mastodon\")[] <myRef>\n\n#quote(\"blablablabla\", block: true, attribution: [John@myRef])\n\n#quote(\"blablablabla\", block: true, attribution: attr(\"John@myRef\"))\n```\n\n![image|591x173](upload://azmffgwDHSdeNLFXUBvLh0CcsuW.png)",
      "reply_to_post_number": 3,
      "reply_count": 0,
      "quote_count": 0,
      "like_count": 0,
      "reads": 18,
      "score": 83.2,
      "accepted_answer": false,
      "trust_level": 3,
      "user_id": 51
    }
  ],
  "scraped_at": "2025-06-10T09:46:45.704763"
}