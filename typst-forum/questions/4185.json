{
  "topic_metadata": {
    "id": 4185,
    "title": "How to determine if the current page has a heading of level 1?",
    "slug": "how-to-determine-if-the-current-page-has-a-heading-of-level-1",
    "posts_count": 3,
    "created_at": "2025-05-20T13:31:35.932Z",
    "last_posted_at": "2025-05-20T15:15:44.521Z",
    "views": 48,
    "like_count": 3,
    "reply_count": 0,
    "has_accepted_answer": true,
    "accepted_answer_post_number": 2,
    "accepted_answer_username": "Eric",
    "tags": [
      "scripting",
      "layout"
    ],
    "category_id": 5,
    "participant_count": 3,
    "word_count": 281
  },
  "posts": [
    {
      "id": 12805,
      "post_number": 1,
      "username": "Alex",
      "name": "Alex",
      "created_at": "2025-05-20T13:31:36.094Z",
      "updated_at": "2025-05-20T13:37:40.543Z",
      "cooked": "<p>Hello everyone,</p>\n<p>For a personal project, i want to set a rectangle on the side of a pages in a book based on the section the current page is and based on the oddity of the current page. My code look a little bit like this :</p>\n<pre data-code-wrap=\"typst\"><code class=\"lang-typst\">#set page(\n  paper: \"a6\",\n  margin: CONFIG.MARGIN,\n  numbering: \"1\",\n  number-align: left,\n  background: context{\n    let current-page = here().page() // Get number of page\n    // get chapter (or section) based on number of heading\n    let section = query(selector(heading.where(level : 1)).before(here())).len()\n\n    // place rectangle based on the page number &amp; book section\n    let r-height = current-layout.height / total-section\n    let offset = section* r-height\n    let r = rect(fill: black,width: 0.3cm, height: r-height)\n    let side = right\n    if calc.odd(current-page){side = right} else {side = left}\n    place(side, r, dy: offset)\n  },\n  header: [...]\n)\n</code></pre>\n<p>I basically want to prevent the placing of this rectangle on pages where there’s a heading of level 1 and wanted to know if it was possible. Maybe something like :</p>\n<pre data-code-wrap=\"typst\"><code class=\"lang-typst\">#let l1-heading = query(selector(heading.where(level: 1)).on-page(current-page)).len()\n#if l1-heading &gt; 0 {place(side, r, dy: offset)}\n</code></pre>\n<p>Thank you in advance for your help</p>",
      "raw": "Hello everyone, \n\nFor a personal project, i want to set a rectangle on the side of a pages in a book based on the section the current page is and based on the oddity of the current page. My code look a little bit like this : \n\n```typst\n#set page(\n  paper: \"a6\",\n  margin: CONFIG.MARGIN,\n  numbering: \"1\",\n  number-align: left,\n  background: context{\n    let current-page = here().page() // Get number of page\n    // get chapter (or section) based on number of heading\n    let section = query(selector(heading.where(level : 1)).before(here())).len()\n\n    // place rectangle based on the page number & book section\n    let r-height = current-layout.height / total-section\n    let offset = section* r-height\n    let r = rect(fill: black,width: 0.3cm, height: r-height)\n    let side = right\n    if calc.odd(current-page){side = right} else {side = left}\n    place(side, r, dy: offset)\n  },\n  header: [...]\n)\n```\n\nI basically want to prevent the placing of this rectangle on pages where there's a heading of level 1 and wanted to know if it was possible. Maybe something like : \n```typst\n#let l1-heading = query(selector(heading.where(level: 1)).on-page(current-page)).len()\n#if l1-heading > 0 {place(side, r, dy: offset)}\n```\n\nThank you in advance for your help",
      "reply_to_post_number": null,
      "reply_count": 0,
      "quote_count": 0,
      "like_count": 0,
      "reads": 27,
      "score": 90.4,
      "accepted_answer": false,
      "trust_level": 1,
      "user_id": 987
    },
    {
      "id": 12815,
      "post_number": 2,
      "username": "Eric",
      "name": "Eric Biedert",
      "created_at": "2025-05-20T15:15:00.351Z",
      "updated_at": "2025-05-20T15:21:57.459Z",
      "cooked": "<p>You can query all headings and go through them one by one, checking if its location is on the current page:</p>\n<pre data-code-wrap=\"typc\"><code class=\"lang-typc\">let has-heading = query(heading.where(level: 1))\n  .any(it =&gt; it.location().page() == current-page)\n</code></pre>",
      "raw": "You can query all headings and go through them one by one, checking if its location is on the current page:\n```typc\nlet has-heading = query(heading.where(level: 1))\n  .any(it => it.location().page() == current-page)\n```",
      "reply_to_post_number": null,
      "reply_count": 0,
      "quote_count": 0,
      "like_count": 2,
      "reads": 25,
      "score": 35.0,
      "accepted_answer": true,
      "trust_level": 2,
      "user_id": 88
    },
    {
      "id": 12816,
      "post_number": 3,
      "username": "vmartel08",
      "name": "Vincent Martel",
      "created_at": "2025-05-20T15:15:44.521Z",
      "updated_at": "2025-05-20T15:15:44.521Z",
      "cooked": "<p>Hi <a class=\"mention\" href=\"/u/alex\">@Alex</a>, trying to point you in the right direction, would this match what you are looking for? This seems pretty similar.</p>\n<aside class=\"quote quote-modified\" data-post=\"1\" data-topic=\"4105\">\n  <div class=\"title\">\n    <div class=\"quote-controls\"></div>\n    <img loading=\"lazy\" alt=\"\" width=\"24\" height=\"24\" src=\"https://forum.typst.app/letter_avatar_proxy/v4/letter/n/611D14/48.png\" class=\"avatar\">\n    <a href=\"https://forum.typst.app/t/how-to-display-chapter-x-above-level-1-heading-name/4105\">How to display \"Chapter X\" above level 1 heading name?</a> <a class=\"badge-category__wrapper \" href=\"/c/questions/5\"><span data-category-id=\"5\" style=\"--category-badge-color: #F7C000; --category-badge-text-color: #fdfdfd;\" data-drop-close=\"true\" class=\"badge-category \" title=\"Your questions about using Typst and the web app go in this category.\"><span class=\"badge-category__name\">Questions</span></span></a>\n  </div>\n  <blockquote>\n    When I type a new depth 1 heading e.g. = Discussion , I want to create something that looks like this: \n[image] \nHere is the code I currently have: \n// Pagebreak on new chap start\n#show heading.where(level: 1): it =&gt; {\n  set text(28pt)\n  pagebreak(weak: true) + it\n}\n\nwhich results in simply: \n[image] \nI’m not sure how to extract the chapter number (e.g. 7, in this case) from it\n  </blockquote>\n</aside>\n",
      "raw": "Hi @Alex, trying to point you in the right direction, would this match what you are looking for? This seems pretty similar.\n\nhttps://forum.typst.app/t/how-to-display-chapter-x-above-level-1-heading-name/4105?u=vmartel08",
      "reply_to_post_number": null,
      "reply_count": 0,
      "quote_count": 0,
      "like_count": 1,
      "reads": 25,
      "score": 35.0,
      "accepted_answer": false,
      "trust_level": 3,
      "user_id": 936
    }
  ],
  "scraped_at": "2025-06-10T09:47:35.072956"
}