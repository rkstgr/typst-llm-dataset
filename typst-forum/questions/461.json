{
  "topic_metadata": {
    "id": 461,
    "title": "How do I make a reference that inserts name of section, and page number?",
    "slug": "how-do-i-make-a-reference-that-inserts-name-of-section-and-page-number",
    "posts_count": 5,
    "created_at": "2024-09-18T19:17:15.635Z",
    "last_posted_at": "2024-09-19T09:30:40.833Z",
    "views": 822,
    "like_count": 6,
    "reply_count": 3,
    "has_accepted_answer": true,
    "accepted_answer_post_number": 2,
    "accepted_answer_username": "Andrew",
    "tags": [],
    "category_id": 5,
    "participant_count": 3,
    "word_count": 328
  },
  "posts": [
    {
      "id": 1813,
      "post_number": 1,
      "username": "Goossa",
      "name": "",
      "created_at": "2024-09-18T19:17:15.771Z",
      "updated_at": "2024-09-23T07:12:38.983Z",
      "cooked": "<p>I’m using typst to reference manuscripts that are added at the end of the document. I’ve got pages with a heading and a label, and also the page number is set manually to match.</p>\n<p>I would like a way to reference the label of that Manuscript heading, in which typst prints out “Manuscript IV (p. 56)” or something like that.<br>\nThe heading would look like</p>\n<pre data-code-wrap=\"typ\"><code class=\"lang-typ\">= Manuscript IV\n&lt;paper4&gt;\n</code></pre>",
      "raw": "I'm using typst to reference manuscripts that are added at the end of the document. I've got pages with a heading and a label, and also the page number is set manually to match.\n\nI would like a way to reference the label of that Manuscript heading, in which typst prints out \"Manuscript IV (p. 56)\" or something like that.\nThe heading would look like\n```typ\n= Manuscript IV\n<paper4>\n```",
      "reply_to_post_number": null,
      "reply_count": 0,
      "quote_count": 0,
      "like_count": 1,
      "reads": 90,
      "score": 3702.8,
      "accepted_answer": false,
      "trust_level": 1,
      "user_id": 371
    },
    {
      "id": 1817,
      "post_number": 2,
      "username": "Andrew",
      "name": "",
      "created_at": "2024-09-18T19:45:41.974Z",
      "updated_at": "2024-09-18T19:59:56.605Z",
      "cooked": "<p>Here is a possible solution:</p>\n<pre data-code-wrap=\"typ\"><code class=\"lang-typ\">#show ref: it =&gt; if it.element.func() != heading { it } else {\n  let l = it.target // label\n  let h = it.element // heading\n  link(l, [#h.body (p. #h.location().page())])\n}\n\nA reference to @paper4\n\n#lorem(100)\n\n// #pagebreak() // This will change \"(p. 1)\" to \"(p. 2)\".\n\n= Manuscript IV\n&lt;paper4&gt;\n\n#lorem(20)\n</code></pre>\n<div align=\"center\">\n<p><img src=\"https://forum.typst.app/uploads/default/original/1X/7cc11ad31de9307aaf1d845502f633e49c1fdde2.png\" alt=\"image\" data-base62-sha1=\"hNCVKp9vYcojKQfOURe8FIe8mps\" width=\"567\" height=\"251\"></p>\n</div>\n<p>If you have the heading on the 2nd page:<img src=\"https://forum.typst.app/uploads/default/original/1X/8656d9e15c36eb0117817b63193f8706b0c63de2.png\" alt=\"image\" data-base62-sha1=\"jaq3DsE3d0qWONoW7vMVcjKy1AS\" width=\"206\" height=\"33\"></p>",
      "raw": "Here is a possible solution:\n\n```typ\n#show ref: it => if it.element.func() != heading { it } else {\n  let l = it.target // label\n  let h = it.element // heading\n  link(l, [#h.body (p. #h.location().page())])\n}\n\nA reference to @paper4\n\n#lorem(100)\n\n// #pagebreak() // This will change \"(p. 1)\" to \"(p. 2)\".\n\n= Manuscript IV\n<paper4>\n\n#lorem(20)\n```\n\n<div align=center>\n\n![image|567x251](upload://hNCVKp9vYcojKQfOURe8FIe8mps.png)\n</div>\n\nIf you have the heading on the 2nd page:![image|206x33](upload://jaq3DsE3d0qWONoW7vMVcjKy1AS.png)",
      "reply_to_post_number": null,
      "reply_count": 1,
      "quote_count": 0,
      "like_count": 4,
      "reads": 87,
      "score": 182.2,
      "accepted_answer": true,
      "trust_level": 3,
      "user_id": 51
    },
    {
      "id": 1835,
      "post_number": 3,
      "username": "Goossa",
      "name": "",
      "created_at": "2024-09-18T22:29:33.648Z",
      "updated_at": "2024-09-18T22:29:33.648Z",
      "cooked": "<p>Is it possible to do <code>#show ref.where(it=&gt;it.element.func() == heading)</code> or something like that?</p>",
      "raw": "Is it possible to do `#show ref.where(it=>it.element.func() == heading)` or something like that?",
      "reply_to_post_number": 2,
      "reply_count": 2,
      "quote_count": 0,
      "like_count": 0,
      "reads": 75,
      "score": 44.8,
      "accepted_answer": false,
      "trust_level": 1,
      "user_id": 371
    },
    {
      "id": 1836,
      "post_number": 4,
      "username": "Andrew",
      "name": "",
      "created_at": "2024-09-18T23:03:08.098Z",
      "updated_at": "2024-09-19T09:38:08.128Z",
      "cooked": "<p>Yeah, I don’t think so. I did want to use <code>.where()</code> clause but <code>ref()</code> has only <code>target</code> and <code>supplement</code> fields: <a href=\"https://typst.app/docs/reference/model/ref/#parameters\" class=\"inline-onebox\">Reference Function – Typst Documentation</a>, although it didn’t give an error when <code>.where(element)</code> is used. Unfortunately, <code>element</code> is of type <code>content</code> (or sometimes <code>none</code>, I think), so using it inside of <code>.where()</code> is basically useless. And there is no feature that adds lambda function inside <code>.where()</code> clause. Perhaps you can <a href=\"https://github.com/typst/typst/issues/new/choose\" rel=\"noopener nofollow ugc\">open an issue</a> in the repository explaining the desired feature. It <em>would</em> be cool if you can filter <code>ref</code> occurrences (via <code>.where()</code>) by element type of <code>ref.element</code> field.</p>",
      "raw": "Yeah, I don't think so. I did want to use `.where()` clause but `ref()` has only `target` and `supplement` fields: https://typst.app/docs/reference/model/ref/#parameters, although it didn't give an error when `.where(element)` is used. Unfortunately, `element` is of type `content` (or sometimes `none`, I think), so using it inside of `.where()` is basically useless. And there is no feature that adds lambda function inside `.where()` clause. Perhaps you can [open an issue](https://github.com/typst/typst/issues/new/choose) in the repository explaining the desired feature. It *would* be cool if you can filter `ref` occurrences (via `.where()`) by element type of `ref.element` field.",
      "reply_to_post_number": 3,
      "reply_count": 0,
      "quote_count": 0,
      "like_count": 1,
      "reads": 75,
      "score": 44.8,
      "accepted_answer": false,
      "trust_level": 3,
      "user_id": 51
    },
    {
      "id": 1892,
      "post_number": 5,
      "username": "SillyFreak",
      "name": "SillyFreak",
      "created_at": "2024-09-19T09:30:40.833Z",
      "updated_at": "2024-09-23T07:12:29.042Z",
      "cooked": "<aside class=\"quote no-group\" data-username=\"Goossa\" data-post=\"3\" data-topic=\"461\" data-full=\"true\">\n<div class=\"title\">\n<div class=\"quote-controls\"></div>\n<img loading=\"lazy\" alt=\"\" width=\"24\" height=\"24\" src=\"https://forum.typst.app/user_avatar/forum.typst.app/goossa/48/368_2.png\" class=\"avatar\"> Goossa:</div>\n<blockquote>\n<p>Is it possible to do <code>#show ref.where(it=&gt;it.element.func() == heading)</code> or something like that?</p>\n</blockquote>\n</aside>\n<p>It’s not possible, for a few reasons outlined in this Github issue (and linked Discord thread):</p>\n<aside class=\"onebox githubissue\" data-onebox-src=\"https://github.com/typst/typst/issues/4950\">\n  <header class=\"source\">\n\n      <a href=\"https://github.com/typst/typst/issues/4950\" target=\"_blank\" rel=\"noopener\">github.com/typst/typst</a>\n  </header>\n\n  <article class=\"onebox-body\">\n    <div class=\"github-row\">\n  <div class=\"github-icon-container\" title=\"Issue\" data-github-private-repo=\"false\">\n\t  <svg width=\"60\" height=\"60\" class=\"github-icon\" viewBox=\"0 0 14 16\" aria-hidden=\"true\"><path fill-rule=\"evenodd\" d=\"M7 2.3c3.14 0 5.7 2.56 5.7 5.7s-2.56 5.7-5.7 5.7A5.71 5.71 0 0 1 1.3 8c0-3.14 2.56-5.7 5.7-5.7zM7 1C3.14 1 0 4.14 0 8s3.14 7 7 7 7-3.14 7-7-3.14-7-7-7zm1 3H6v5h2V4zm0 6H6v2h2v-2z\"></path></svg>\n  </div>\n\n  <div class=\"github-info-container\">\n    <h4>\n      <a href=\"https://github.com/typst/typst/issues/4950\" target=\"_blank\" rel=\"noopener\">Allow function as parameter to where()</a>\n    </h4>\n\n    <div class=\"github-info\">\n      <div class=\"date\">\n        opened <span class=\"discourse-local-date\" data-format=\"ll\" data-date=\"2024-09-13\" data-time=\"09:06:08\" data-timezone=\"UTC\">09:06AM - 13 Sep 24 UTC</span>\n      </div>\n\n        <div class=\"date\">\n          closed <span class=\"discourse-local-date\" data-format=\"ll\" data-date=\"2024-09-22\" data-time=\"11:55:12\" data-timezone=\"UTC\">11:55AM - 22 Sep 24 UTC</span>\n        </div>\n\n      <div class=\"user\">\n        <a href=\"https://github.com/noahjutz\" target=\"_blank\" rel=\"noopener\">\n          <img alt=\"noahjutz\" src=\"https://forum.typst.app/uploads/default/original/1X/3f38b6029a7a4d74aa907f56c4b8dd81ff9de36d.png\" class=\"onebox-avatar-inline\" width=\"20\" height=\"20\" data-dominant-color=\"E7C9E2\">\n          noahjutz\n        </a>\n      </div>\n    </div>\n\n    <div class=\"labels\">\n        <span style=\"display:inline-block;margin-top:2px;background-color: #B8B8B8;padding: 2px;border-radius: 4px;color: #fff;margin-left: 3px;\">\n          feature request\n        </span>\n        <span style=\"display:inline-block;margin-top:2px;background-color: #B8B8B8;padding: 2px;border-radius: 4px;color: #fff;margin-left: 3px;\">\n          introspection\n        </span>\n    </div>\n  </div>\n</div>\n\n  <div class=\"github-row\">\n    <p class=\"github-body-container\">### Description\n\nThe signature of the where function is currently\n\n```\nself.w<span class=\"show-more-container\"><a href=\"\" rel=\"noopener\" class=\"show-more\">…</a></span><span class=\"excerpt hidden\">here(..any) -&gt; selector\n```\n\nI want it to be\n\n```\nself.where(..any or function) -&gt; selector\n```\n\n### Use Case\n\nCurrently, selecting with a range of parameters is difficult.\n\n```\ntable.cell.where(x: 0)\ntable.cell.where(x: 2)\ntable.cell.where(x: 4)\n// ...\n```\n\nit would be much easier like this:\n\n```\ntable.cell.where(cell =&gt; calc.rem(cell.x, 2) == 0)\n```</span></p>\n  </div>\n\n  </article>\n\n  <div class=\"onebox-metadata\">\n    \n    \n  </div>\n\n  <div style=\"clear: both\"></div>\n</aside>\n",
      "raw": "[quote=\"Goossa, post:3, topic:461, full:true\"]\nIs it possible to do `#show ref.where(it=>it.element.func() == heading)` or something like that?\n[/quote]\n\nIt's not possible, for a few reasons outlined in this Github issue (and linked Discord thread):\n\nhttps://github.com/typst/typst/issues/4950",
      "reply_to_post_number": 3,
      "reply_count": 0,
      "quote_count": 1,
      "like_count": 0,
      "reads": 62,
      "score": 292.2,
      "accepted_answer": false,
      "trust_level": 3,
      "user_id": 32
    }
  ],
  "scraped_at": "2025-06-10T09:58:40.925463"
}