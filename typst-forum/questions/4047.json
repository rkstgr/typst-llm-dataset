{
  "topic_metadata": {
    "id": 4047,
    "title": "How to automatically add * before headings?",
    "slug": "how-to-automatically-add-before-headings",
    "posts_count": 10,
    "created_at": "2025-05-12T10:59:25.159Z",
    "last_posted_at": "2025-05-16T14:39:28.646Z",
    "views": 106,
    "like_count": 1,
    "reply_count": 6,
    "has_accepted_answer": true,
    "accepted_answer_post_number": 7,
    "accepted_answer_username": "HuangMI",
    "tags": [
      "layout"
    ],
    "category_id": 5,
    "participant_count": 3,
    "word_count": 686
  },
  "posts": [
    {
      "id": 12332,
      "post_number": 1,
      "username": "HuangMI",
      "name": "HuangMI",
      "created_at": "2025-05-12T10:59:25.322Z",
      "updated_at": "2025-05-13T00:49:06.723Z",
      "cooked": "<pre data-code-wrap=\"typ\"><code class=\"lang-typ\">#set heading(numbering: \"1.1\")\n#show heading: set heading()\n= 有理数\n== 正数和负数\n== 正数和负数\n</code></pre>\n<p><img src=\"https://forum.typst.app/uploads/default/original/2X/3/3224dbfa16102adb1a8126bb8d647b021a92e0d7.png\" alt=\"image\" data-base62-sha1=\"79AQl0JXAYCBk6PPWMYAQXyuRWD\" width=\"315\" height=\"232\"></p>",
      "raw": "```typ\n#set heading(numbering: \"1.1\")\n#show heading: set heading()\n= 有理数\n== 正数和负数\n== 正数和负数\n```\n![image|315x232](upload://79AQl0JXAYCBk6PPWMYAQXyuRWD.png)",
      "reply_to_post_number": null,
      "reply_count": 0,
      "quote_count": 0,
      "like_count": 0,
      "reads": 31,
      "score": 66.2,
      "accepted_answer": false,
      "trust_level": 1,
      "user_id": 1479
    },
    {
      "id": 12333,
      "post_number": 2,
      "username": "janekfleper",
      "name": "Janek Fleper",
      "created_at": "2025-05-12T12:00:10.038Z",
      "updated_at": "2025-05-12T13:22:32.148Z",
      "cooked": "<p>There are two options here, I will leave it up to you to select the one that best suits your requirements.</p>\n<p>You can use a show rule for the headings to insert the asterisk between the numbering and body of each heading. You can adjust the spacing around the asterisk with spaces inside the string or with the horizontal spacing function <code>h()</code>.<br>\nEdit: Manually recreating the counter value with <code>numbering()</code> and the heading location is unnecessary, see the reply by <a class=\"mention\" href=\"/u/andrew\">@Andrew</a>. You can just use <code>counter(heading).display()</code> to get the correct output for the current heading.</p>\n<pre data-code-wrap=\"typ\"><code class=\"lang-typ\">#show heading: it =&gt; block(counter(heading).display() + \"*\" + it.body)\n</code></pre>\n<p>The second option is to include the asterisk in the numbering. Compared to the first option the asterisk will then be automatically included wherever the heading numbering shows up, e.g. also in references to headings or in the outline.</p>\n<pre data-code-wrap=\"typ\"><code class=\"lang-typ\">#let asterisk-numbering(..n) = numbering(\"1.1\", ..n) + \"*\"\n#set heading(numbering: asterisk-numbering)\n</code></pre>",
      "raw": "There are two options here, I will leave it up to you to select the one that best suits your requirements.\n\nYou can use a show rule for the headings to insert the asterisk between the numbering and body of each heading. You can adjust the spacing around the asterisk with spaces inside the string or with the horizontal spacing function `h()`.\nEdit: Manually recreating the counter value with `numbering()` and the heading location is unnecessary, see the reply by @Andrew. You can just use `counter(heading).display()` to get the correct output for the current heading.\n\n```typ\n#show heading: it => block(counter(heading).display() + \"*\" + it.body)\n```\n\nThe second option is to include the asterisk in the numbering. Compared to the first option the asterisk will then be automatically included wherever the heading numbering shows up, e.g. also in references to headings or in the outline.\n\n```typ\n#let asterisk-numbering(..n) = numbering(\"1.1\", ..n) + \"*\"\n#set heading(numbering: asterisk-numbering)\n```",
      "reply_to_post_number": null,
      "reply_count": 1,
      "quote_count": 0,
      "like_count": 0,
      "reads": 31,
      "score": 36.2,
      "accepted_answer": false,
      "trust_level": 3,
      "user_id": 69
    },
    {
      "id": 12335,
      "post_number": 3,
      "username": "Andrew",
      "name": "",
      "created_at": "2025-05-12T12:27:54.072Z",
      "updated_at": "2025-05-12T12:27:54.072Z",
      "cooked": "<p><a href=\"https://forum.typst.app/t/how-to-post-in-the-questions-category/11\" class=\"inline-onebox\">How to post in the Questions category</a> :</p>\n<aside class=\"quote no-group\">\n<blockquote>\n<p>If your question pertains to a bit of Typst markup you have problems with, put it in the question body! You can syntax-highlight Typst code by wrapping it in ` ```typ … ````. It will then look like this:</p>\n<pre data-code-wrap=\"typ\"><code class=\"lang-typ\">#set font(size: 12pt)\n\nHello from *Typst* at $ pi.var + 1 $ o'clock!\n</code></pre>\n<p>If you need to highlight a code or math mode snippet instead, the language tags <code>typc</code> and <code>typm</code> do that, respectively.</p>\n</blockquote>\n</aside>",
      "raw": "https://forum.typst.app/t/how-to-post-in-the-questions-category/11 :\n[quote]\nIf your question pertains to a bit of Typst markup you have problems with, put it in the question body! You can syntax-highlight Typst code by wrapping it in ` ```typ ... ````. It will then look like this:\n\n```typ\n#set font(size: 12pt)\n\nHello from *Typst* at $ pi.var + 1 $ o'clock!\n```\n\nIf you need to highlight a code or math mode snippet instead, the language tags `typc` and `typm` do that, respectively.\n[/quote]",
      "reply_to_post_number": null,
      "reply_count": 0,
      "quote_count": 0,
      "like_count": 0,
      "reads": 28,
      "score": 30.6,
      "accepted_answer": false,
      "trust_level": 3,
      "user_id": 51
    },
    {
      "id": 12336,
      "post_number": 4,
      "username": "Andrew",
      "name": "",
      "created_at": "2025-05-12T12:30:30.940Z",
      "updated_at": "2025-05-12T12:30:30.940Z",
      "cooked": "<p>Why overcomplicate?</p>\n<pre data-code-wrap=\"typ\"><code class=\"lang-typ\">#set heading(numbering: \"1.1\")\n#show heading: it =&gt; block[#counter(heading).display()#h(0.3em)\\*#it.body]\n</code></pre>\n<p>This is, if not all headings features are needed. Actual heading show rule is very big.</p>",
      "raw": "Why overcomplicate?\n\n```typ\n#set heading(numbering: \"1.1\")\n#show heading: it => block[#counter(heading).display()#h(0.3em)\\*#it.body]\n```\n\nThis is, if not all headings features are needed. Actual heading show rule is very big.",
      "reply_to_post_number": 2,
      "reply_count": 1,
      "quote_count": 0,
      "like_count": 1,
      "reads": 27,
      "score": 30.4,
      "accepted_answer": false,
      "trust_level": 3,
      "user_id": 51
    },
    {
      "id": 12479,
      "post_number": 5,
      "username": "HuangMI",
      "name": "HuangMI",
      "created_at": "2025-05-15T04:58:03.751Z",
      "updated_at": "2025-05-15T04:58:03.751Z",
      "cooked": "<aside class=\"quote no-group\" data-username=\"Andrew\" data-post=\"4\" data-topic=\"4047\">\n<div class=\"title\">\n<div class=\"quote-controls\"></div>\n<img loading=\"lazy\" alt=\"\" width=\"24\" height=\"24\" src=\"https://forum.typst.app/user_avatar/forum.typst.app/andrew/48/62_2.png\" class=\"avatar\"> Andrew:</div>\n<blockquote>\n<p>This is, if not all headings features are needed. Actual heading show rule is very big.</p>\n</blockquote>\n</aside>\n<p>I don’t understand this very well</p>",
      "raw": "[quote=\"Andrew, post:4, topic:4047\"]\nThis is, if not all headings features are needed. Actual heading show rule is very big.\n[/quote]\n\nI don't understand this very well",
      "reply_to_post_number": 4,
      "reply_count": 1,
      "quote_count": 1,
      "like_count": 0,
      "reads": 20,
      "score": 19.0,
      "accepted_answer": false,
      "trust_level": 1,
      "user_id": 1479
    },
    {
      "id": 12491,
      "post_number": 6,
      "username": "Andrew",
      "name": "",
      "created_at": "2025-05-15T10:27:00.615Z",
      "updated_at": "2025-05-15T10:32:25.400Z",
      "cooked": "<p>See <a href=\"https://github.com/typst/typst/issues/5095#issuecomment-2812970888\" class=\"inline-onebox\">Add default typst implementation code where possible · Issue #5095 · typst/typst · GitHub</a> for full heading re-implementation in Typst. I guess, basically, it doesn’t respond to overridden <code>numbering</code> and ignore <code>hanging-indent</code> (and <code>text.dir</code>). And no HTML support.</p>",
      "raw": "See https://github.com/typst/typst/issues/5095#issuecomment-2812970888 for full heading re-implementation in Typst. I guess, basically, it doesn't respond to overridden `numbering` and ignore `hanging-indent` (and `text.dir`). And no HTML support.",
      "reply_to_post_number": 5,
      "reply_count": 0,
      "quote_count": 0,
      "like_count": 0,
      "reads": 20,
      "score": 44.0,
      "accepted_answer": false,
      "trust_level": 3,
      "user_id": 51
    },
    {
      "id": 12565,
      "post_number": 7,
      "username": "HuangMI",
      "name": "HuangMI",
      "created_at": "2025-05-16T02:29:44.532Z",
      "updated_at": "2025-05-16T02:38:43.336Z",
      "cooked": "<pre data-code-wrap=\"typ\"><code class=\"lang-typ\">// #set heading(numbering: \"1.1\")\n#show heading: it =&gt; {\n  if it.body.has(\"text\") and it.body.text.first() != \"*\" {\n    heading(\n      \"*\" + it.body, \n      level: it.level,\n      numbering: \"1.1\", \n    )\n  } else {\n    it\n  }\n}\n= 有理数\n== 正数和负数\n== 正数和负数\n</code></pre>\n<p>If I don’t comment out this line <code>#set heading(numbering: \"1.1\")</code> , the result won’t be as expected. However, I don’t understand how it works internally—I can only look at the Rust source code to figure it out. Why isn’t this heading outline functionality provided as part of the standard library? I’m not sure what Typst’s reasoning is for this design.</p>",
      "raw": "```typ\n// #set heading(numbering: \"1.1\")\n#show heading: it => {\n  if it.body.has(\"text\") and it.body.text.first() != \"*\" {\n    heading(\n      \"*\" + it.body, \n      level: it.level,\n      numbering: \"1.1\", \n    )\n  } else {\n    it\n  }\n}\n= 有理数\n== 正数和负数\n== 正数和负数\n```\n\nIf I don't comment out this line `#set heading(numbering: \"1.1\")` , the result won't be as expected. However, I don’t understand how it works internally—I can only look at the Rust source code to figure it out. Why isn’t this heading outline functionality provided as part of the standard library? I’m not sure what Typst’s reasoning is for this design.",
      "reply_to_post_number": null,
      "reply_count": 3,
      "quote_count": 0,
      "like_count": 0,
      "reads": 19,
      "score": 68.8,
      "accepted_answer": true,
      "trust_level": 1,
      "user_id": 1479
    },
    {
      "id": 12581,
      "post_number": 8,
      "username": "HuangMI",
      "name": "HuangMI",
      "created_at": "2025-05-16T11:17:38.166Z",
      "updated_at": "2025-05-16T11:19:27.042Z",
      "cooked": "<p><a class=\"mention\" href=\"/u/andrew\">@Andrew</a> <a class=\"mention\" href=\"/u/janekfleper\">@janekfleper</a></p>",
      "raw": "@Andrew @janekfleper",
      "reply_to_post_number": 7,
      "reply_count": 0,
      "quote_count": 0,
      "like_count": 0,
      "reads": 16,
      "score": 3.2,
      "accepted_answer": false,
      "trust_level": 1,
      "user_id": 1479
    },
    {
      "id": 12584,
      "post_number": 9,
      "username": "janekfleper",
      "name": "Janek Fleper",
      "created_at": "2025-05-16T11:59:37.919Z",
      "updated_at": "2025-05-16T11:59:37.919Z",
      "cooked": "<p>You are creating every heading twice with your current show rule. If you hover over <code>it.body</code> in the if statement, you can see that it shows every section twice. Once with the initial body and once with <code>\"*\"  + body</code>. With the set rule for the heading numbering, you are then incrementing the heading counter twice for each heading. Without the set rule only the inner heading has a numbering and the heading counter is only incremented once. The outer heading will have numbering set to <code>none</code> which does not increment the counter.</p>",
      "raw": "You are creating every heading twice with your current show rule. If you hover over `it.body` in the if statement, you can see that it shows every section twice. Once with the initial body and once with `\"*\"  + body`. With the set rule for the heading numbering, you are then incrementing the heading counter twice for each heading. Without the set rule only the inner heading has a numbering and the heading counter is only incremented once. The outer heading will have numbering set to `none` which does not increment the counter.",
      "reply_to_post_number": 7,
      "reply_count": 0,
      "quote_count": 0,
      "like_count": 0,
      "reads": 14,
      "score": 2.8,
      "accepted_answer": false,
      "trust_level": 3,
      "user_id": 69
    },
    {
      "id": 12593,
      "post_number": 10,
      "username": "Andrew",
      "name": "",
      "created_at": "2025-05-16T14:39:28.646Z",
      "updated_at": "2025-05-16T20:45:06.343Z",
      "cooked": "<p>Not sure how this can be a solution if you are saying that it doesn’t really work. Here is a proper solution:</p>\n<pre data-code-wrap=\"typ\"><code class=\"lang-typ\">#set heading(numbering: \"1.1\")\n#show heading: it =&gt; {\n  if it.body.func() != text and it.body.children.first() == [\\*] { return it }\n  let number = if it.numbering != none [#counter(heading).display()#h(0.3em)]\n  block[#number\\*#it.body]\n}\n\n= 有理数\n== \\*正数和负数\n== 正数和负数\n</code></pre>\n<p><img src=\"https://forum.typst.app/uploads/default/original/2X/7/75f4c030576b696ac14b1c9a655615534937ea37.png\" alt=\"image\" data-base62-sha1=\"gPueSRFEZ4Mx2gCIPMPDZwu80ED\" width=\"136\" height=\"101\"></p>\n<p>It works with and without the set rule. But you should only use <code>=</code> syntax. Otherwise, the solution will be slightly longer.</p>\n<p>I would just not add an asterisk in the heading in the first place. Then <a href=\"https://forum.typst.app/t/how-to-automatically-add-before-headings/4047/4\" class=\"inline-onebox\">How to automatically add * before headings? - #4 by Andrew</a> just works.</p>",
      "raw": "Not sure how this can be a solution if you are saying that it doesn't really work. Here is a proper solution:\n\n```typ\n#set heading(numbering: \"1.1\")\n#show heading: it => {\n  if it.body.func() != text and it.body.children.first() == [\\*] { return it }\n  let number = if it.numbering != none [#counter(heading).display()#h(0.3em)]\n  block[#number\\*#it.body]\n}\n\n= 有理数\n== \\*正数和负数\n== 正数和负数\n```\n\n![image|136x101](upload://gPueSRFEZ4Mx2gCIPMPDZwu80ED.png)\n\nIt works with and without the set rule. But you should only use `=` syntax. Otherwise, the solution will be slightly longer.\n\nI would just not add an asterisk in the heading in the first place. Then https://forum.typst.app/t/how-to-automatically-add-before-headings/4047/4?u=andrew just works.",
      "reply_to_post_number": 7,
      "reply_count": 0,
      "quote_count": 0,
      "like_count": 0,
      "reads": 13,
      "score": 7.6,
      "accepted_answer": false,
      "trust_level": 3,
      "user_id": 51
    }
  ],
  "scraped_at": "2025-06-10T09:47:57.248636"
}