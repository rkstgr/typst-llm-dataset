{
  "topic_metadata": {
    "id": 3735,
    "title": "How to add color box to a non-citation reference?",
    "slug": "how-to-add-color-box-to-a-non-citation-reference",
    "posts_count": 5,
    "created_at": "2025-04-20T16:01:08.441Z",
    "last_posted_at": "2025-04-20T21:10:55.081Z",
    "views": 93,
    "like_count": 5,
    "reply_count": 3,
    "has_accepted_answer": true,
    "accepted_answer_post_number": 2,
    "accepted_answer_username": "Andrew",
    "tags": [
      "scripting",
      "layout"
    ],
    "category_id": 5,
    "participant_count": 2,
    "word_count": 425
  },
  "posts": [
    {
      "id": 11364,
      "post_number": 1,
      "username": "Btjk16",
      "name": "Btjk16",
      "created_at": "2025-04-20T16:01:08.653Z",
      "updated_at": "2025-04-20T21:09:24.274Z",
      "cooked": "<p>Hello everyone. Newbie here, coming from LaTeX.</p>\n<p>I am currently working on a template, but I am looking to implement color boxes around hyperlinks (cross-references, citations, urls and so on). What I’ve seen is just a discussion on GitHub, but is limited to cross-references and links, however, there are some issues.</p>\n<p>When using the numbering for headings and equations shown below, those are rendered with the dot and the parentheses, respectively. Such aspect does not happen with figures and tables, but as mentioned before, with citations are not possible.</p>\n<details>\n<summary>\nHeadings</summary>\n<pre><code class=\"lang-auto\">set heading(numbering: \"1.\")\nset math.equation(numbering: \"(1)\")\n</code></pre>\n</details>\n<p>I am looking for a (LaTeX) hyperref-like behaviour that may be able to work with all hyperlinks and render correctly. The code that I am using is the same that was shared in the discussion, just that I remove the colored text. I’ve tried to convert <code>supp</code> and <code>num</code> to string, so I could strip dots and parentheses, but the second case is from a context type and couldn’t find how to do it. I would appreciate help with all that.</p>\n<details>\n<summary>\nCode for hyperlinks</summary>\n<pre data-code-wrap=\"typst\"><code class=\"lang-typst\">#let separate-supplement-style(supp, num) = {\n  box(supp + \" \" + num, stroke: 1pt + green, outset: (bottom:1.5pt, x:.5pt, y:.5pt))\n}\n\n#show ref: it =&gt; {\n  let (element, target, supplement: supp) = it.fields()\n  if element == none {\n    return it\n  }\n  let non_cite_ref = element.fields()\n  let supp = if supp == auto { non_cite_ref.supplement } else { supp }\n  let num = context {\n    let head-count = counter(heading).at(target)\n    numbering(non_cite_ref.numbering, ..head-count)\n  }\n  link(target, separate-supplement-style(supp, num))\n}\n</code></pre>\n</details>\n<aside class=\"onebox allowlistedgeneric\" data-onebox-src=\"https://github.com/typst/typst/discussions/2585\">\n  <header class=\"source\">\n      <img src=\"https://forum.typst.app/uploads/default/original/2X/b/bad3e5f9ad67c1ddf145107ce7032ac1d7b22563.svg\" class=\"site-icon\" data-dominant-color=\"\" width=\"32\" height=\"32\">\n\n      <a href=\"https://github.com/typst/typst/discussions/2585\" target=\"_blank\" rel=\"noopener nofollow ugc\">GitHub</a>\n  </header>\n\n  <article class=\"onebox-body\">\n    <div class=\"aspect-image\" style=\"--aspect-ratio:690/344;\"><img src=\"https://forum.typst.app/uploads/default/optimized/2X/8/88dfcb1a67bd80a3679d57e697268d8f775b4ae1_2_690x345.png\" class=\"thumbnail\" data-dominant-color=\"F0EFEE\" width=\"690\" height=\"345\"></div>\n\n<h3><a href=\"https://github.com/typst/typst/discussions/2585\" target=\"_blank\" rel=\"noopener nofollow ugc\">Control the colors and line of the references as in hyperref · typst/typst ·...</a></h3>\n\n  <p>It would be great to be able to control the colors of the references/citations as you can control them in hyperref. This is very useful for creating documentation or educational content, for exampl...</p>\n\n\n  </article>\n\n  <div class=\"onebox-metadata\">\n    \n    \n  </div>\n\n  <div style=\"clear: both\"></div>\n</aside>\n",
      "raw": "Hello everyone. Newbie here, coming from LaTeX.\n\nI am currently working on a template, but I am looking to implement color boxes around hyperlinks (cross-references, citations, urls and so on). What I've seen is just a discussion on GitHub, but is limited to cross-references and links, however, there are some issues.\n\nWhen using the numbering for headings and equations shown below, those are rendered with the dot and the parentheses, respectively. Such aspect does not happen with figures and tables, but as mentioned before, with citations are not possible.\n\n[details=\"Headings\"]\n```\nset heading(numbering: \"1.\")\nset math.equation(numbering: \"(1)\")\n```\n[/details]\n\n\n\nI am looking for a (LaTeX) hyperref-like behaviour that may be able to work with all hyperlinks and render correctly. The code that I am using is the same that was shared in the discussion, just that I remove the colored text. I've tried to convert `supp` and `num` to string, so I could strip dots and parentheses, but the second case is from a context type and couldn't find how to do it. I would appreciate help with all that.\n\n[details=\"Code for hyperlinks\"]\n```typst\n#let separate-supplement-style(supp, num) = {\n  box(supp + \" \" + num, stroke: 1pt + green, outset: (bottom:1.5pt, x:.5pt, y:.5pt))\n}\n\n#show ref: it => {\n  let (element, target, supplement: supp) = it.fields()\n  if element == none {\n    return it\n  }\n  let non_cite_ref = element.fields()\n  let supp = if supp == auto { non_cite_ref.supplement } else { supp }\n  let num = context {\n    let head-count = counter(heading).at(target)\n    numbering(non_cite_ref.numbering, ..head-count)\n  }\n  link(target, separate-supplement-style(supp, num))\n}\n```\n[/details]\n\n\nhttps://github.com/typst/typst/discussions/2585",
      "reply_to_post_number": null,
      "reply_count": 0,
      "quote_count": 0,
      "like_count": 0,
      "reads": 24,
      "score": 284.8,
      "accepted_answer": false,
      "trust_level": 1,
      "user_id": 1480
    },
    {
      "id": 11367,
      "post_number": 2,
      "username": "Andrew",
      "name": "",
      "created_at": "2025-04-20T17:58:56.371Z",
      "updated_at": "2025-04-20T17:59:35.020Z",
      "cooked": "<p>Hello. If you want to reference correct numbering for all elements, then you can just do:</p>\n<pre data-code-wrap=\"typ\"><code class=\"lang-typ\">#show ref: it =&gt; {\n  // Skip bibliography citations.\n  if it.element == none { return it }\n  box(stroke: 1pt + green, outset: (bottom: 1.5pt, rest: .5pt), it)\n}\n\n#let bib = ```yaml\ncite:\n  type: article\n  author: Author\n  title: Title\n```.text\n\n#set heading(numbering: \"1.\")\n#set math.equation(numbering: \"(1)\")\n\n= Heading &lt;heading&gt;\n#figure([], caption: []) &lt;figure&gt;\n#figure(table(), caption: []) &lt;table&gt;\n$ x $ &lt;equation&gt;\n\n@heading\n\n@figure\n\n@table\n\n@equation\n\n@cite\n\n#bibliography(bytes(bib))\n</code></pre>\n<p><div class=\"lightbox-wrapper\"><a class=\"lightbox\" href=\"https://forum.typst.app/uploads/default/original/2X/d/dd56fcc9602471be42c118581b15e64d2e0a16a2.png\" data-download-href=\"https://forum.typst.app/uploads/default/dd56fcc9602471be42c118581b15e64d2e0a16a2\" title=\"image\"><img src=\"https://forum.typst.app/uploads/default/optimized/2X/d/dd56fcc9602471be42c118581b15e64d2e0a16a2_2_690x351.png\" alt=\"image\" data-base62-sha1=\"vA3TdUGrBDdj7JnZ7r3NrKpCXjY\" width=\"690\" height=\"351\" srcset=\"https://forum.typst.app/uploads/default/optimized/2X/d/dd56fcc9602471be42c118581b15e64d2e0a16a2_2_690x351.png, https://forum.typst.app/uploads/default/original/2X/d/dd56fcc9602471be42c118581b15e64d2e0a16a2.png 1.5x, https://forum.typst.app/uploads/default/original/2X/d/dd56fcc9602471be42c118581b15e64d2e0a16a2.png 2x\" data-dominant-color=\"0F100F\"><div class=\"meta\"><svg class=\"fa d-icon d-icon-far-image svg-icon\" aria-hidden=\"true\"><use href=\"#far-image\"></use></svg><span class=\"filename\">image</span><span class=\"informations\">809×412 20.6 KB</span><svg class=\"fa d-icon d-icon-discourse-expand svg-icon\" aria-hidden=\"true\"><use href=\"#discourse-expand\"></use></svg></div></a></div></p>\n<p>Your code uses heading counter for all elements which is semantically incorrect.</p>",
      "raw": "Hello. If you want to reference correct numbering for all elements, then you can just do:\n\n```typ\n#show ref: it => {\n  // Skip bibliography citations.\n  if it.element == none { return it }\n  box(stroke: 1pt + green, outset: (bottom: 1.5pt, rest: .5pt), it)\n}\n\n#let bib = ```yaml\ncite:\n  type: article\n  author: Author\n  title: Title\n```.text\n\n#set heading(numbering: \"1.\")\n#set math.equation(numbering: \"(1)\")\n\n= Heading <heading>\n#figure([], caption: []) <figure>\n#figure(table(), caption: []) <table>\n$ x $ <equation>\n\n@heading\n\n@figure\n\n@table\n\n@equation\n\n@cite\n\n#bibliography(bytes(bib))\n```\n\n![image|690x351](upload://vA3TdUGrBDdj7JnZ7r3NrKpCXjY.png)\n\nYour code uses heading counter for all elements which is semantically incorrect.",
      "reply_to_post_number": null,
      "reply_count": 1,
      "quote_count": 0,
      "like_count": 3,
      "reads": 20,
      "score": 69.0,
      "accepted_answer": true,
      "trust_level": 3,
      "user_id": 51
    },
    {
      "id": 11368,
      "post_number": 3,
      "username": "Btjk16",
      "name": "Btjk16",
      "created_at": "2025-04-20T19:33:02.862Z",
      "updated_at": "2025-04-20T19:33:02.862Z",
      "cooked": "<p>Thank you very much, the code you provided is much better and cleaner.</p>",
      "raw": "Thank you very much, the code you provided is much better and cleaner.",
      "reply_to_post_number": 2,
      "reply_count": 1,
      "quote_count": 0,
      "like_count": 1,
      "reads": 18,
      "score": 23.6,
      "accepted_answer": false,
      "trust_level": 1,
      "user_id": 1480
    },
    {
      "id": 11369,
      "post_number": 4,
      "username": "Andrew",
      "name": "",
      "created_at": "2025-04-20T20:06:44.944Z",
      "updated_at": "2025-04-20T20:06:44.944Z",
      "cooked": "<p>I think title should be “How to add color box to a non-citation reference?”</p>\n<p>Solution doesn’t color hyperlink, it colors a box, and box is for non-citation references specifically, not for hyperlinks.</p>",
      "raw": "I think title should be \"How to add color box to a non-citation reference?\"\n\nSolution doesn't color hyperlink, it colors a box, and box is for non-citation references specifically, not for hyperlinks.",
      "reply_to_post_number": 3,
      "reply_count": 1,
      "quote_count": 0,
      "like_count": 0,
      "reads": 18,
      "score": 8.6,
      "accepted_answer": false,
      "trust_level": 3,
      "user_id": 51
    },
    {
      "id": 11370,
      "post_number": 5,
      "username": "Btjk16",
      "name": "Btjk16",
      "created_at": "2025-04-20T21:10:55.081Z",
      "updated_at": "2025-04-20T21:10:55.081Z",
      "cooked": "<p>Done. I changed the title to match the solution. Thanks.</p>",
      "raw": "Done. I changed the title to match the solution. Thanks.",
      "reply_to_post_number": 4,
      "reply_count": 0,
      "quote_count": 0,
      "like_count": 1,
      "reads": 17,
      "score": 18.4,
      "accepted_answer": false,
      "trust_level": 1,
      "user_id": 1480
    }
  ],
  "scraped_at": "2025-06-10T09:48:55.436268"
}