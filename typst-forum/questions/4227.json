{
  "topic_metadata": {
    "id": 4227,
    "title": "Can I format a heading without a newline?",
    "slug": "can-i-format-a-heading-without-a-newline",
    "posts_count": 7,
    "created_at": "2025-05-22T13:52:15.742Z",
    "last_posted_at": "2025-05-22T17:05:35.864Z",
    "views": 54,
    "like_count": 4,
    "reply_count": 4,
    "has_accepted_answer": true,
    "accepted_answer_post_number": 2,
    "accepted_answer_username": "sijo",
    "tags": [
      "layout"
    ],
    "category_id": 5,
    "participant_count": 3,
    "word_count": 453
  },
  "posts": [
    {
      "id": 12944,
      "post_number": 1,
      "username": "kescobo",
      "name": "Kevin Bonham",
      "created_at": "2025-05-22T13:52:15.845Z",
      "updated_at": "2025-05-22T19:10:02.969Z",
      "cooked": "<p>I’d like to create a heading format so that eg</p>\n<pre data-code-wrap=\"typst\"><code class=\"lang-typst\">== My internal header\n\n#lorem(50)\n</code></pre>\n<p>Gets formatted to look the way</p>\n<pre data-code-wrap=\"typst\"><code class=\"lang-typst\">#text(14pt, weight: \"bold\")[My internal header:] #lorem(50)\n</code></pre>\n<p>would look. Is that possible? If I need to remove the blank line between the header and the paragraph text, that’s fine too, though I don’t know if that makes a difference.</p>",
      "raw": "I'd like to create a heading format so that eg\n\n```typst\n== My internal header\n\n#lorem(50)\n```\n\nGets formatted to look the way\n\n```typst\n#text(14pt, weight: \"bold\")[My internal header:] #lorem(50)\n```\n\nwould look. Is that possible? If I need to remove the blank line between the header and the paragraph text, that's fine too, though I don't know if that makes a difference.",
      "reply_to_post_number": null,
      "reply_count": 0,
      "quote_count": 0,
      "like_count": 0,
      "reads": 20,
      "score": 74.0,
      "accepted_answer": false,
      "trust_level": 1,
      "user_id": 508
    },
    {
      "id": 12949,
      "post_number": 2,
      "username": "sijo",
      "name": "",
      "created_at": "2025-05-22T14:37:37.298Z",
      "updated_at": "2025-05-22T17:00:30.053Z",
      "cooked": "<p>You can use something like this:</p>\n<pre data-code-wrap=\"typ\"><code class=\"lang-typ\">#show heading.where(level: 2): it =&gt; {\n  set text(14pt)\n  box(it) + \":\"\n}\n\n== My internal header\n#lorem(50)\n</code></pre>\n<p>You could replace <code>box(it)</code> with <code>it.body</code> but this wouldn’t compose very well with other show-it rules since it removes the heading element.</p>\n<p>Note that you will need to start the section content right after the title in markup (no empty line).</p>",
      "raw": "You can use something like this:\n\n```typ\n#show heading.where(level: 2): it => {\n  set text(14pt)\n  box(it) + \":\"\n}\n\n== My internal header\n#lorem(50)\n```\n\nYou could replace `box(it)` with `it.body` but this wouldn't compose very well with other show-it rules since it removes the heading element.\n\nNote that you will need to start the section content right after the title in markup (no empty line).",
      "reply_to_post_number": null,
      "reply_count": 2,
      "quote_count": 0,
      "like_count": 2,
      "reads": 19,
      "score": 43.8,
      "accepted_answer": true,
      "trust_level": 3,
      "user_id": 332
    },
    {
      "id": 12960,
      "post_number": 3,
      "username": "kescobo",
      "name": "Kevin Bonham",
      "created_at": "2025-05-22T16:31:49.095Z",
      "updated_at": "2025-05-22T16:31:49.095Z",
      "cooked": "<aside class=\"quote no-group\" data-username=\"sijo\" data-post=\"2\" data-topic=\"4227\">\n<div class=\"title\">\n<div class=\"quote-controls\"></div>\n<img loading=\"lazy\" alt=\"\" width=\"24\" height=\"24\" src=\"https://forum.typst.app/letter_avatar_proxy/v4/letter/s/0A3649/48.png\" class=\"avatar\"> sijo:</div>\n<blockquote>\n<p>this doesn’t compose very well with other show-it rules since it removes the heading element.</p>\n</blockquote>\n</aside>\n<p>Good to note, but that’s ok for my current use-case. Thanks!</p>",
      "raw": "[quote=\"sijo, post:2, topic:4227\"]\nthis doesn’t compose very well with other show-it rules since it removes the heading element.\n[/quote]\n\nGood to note, but that's ok for my current use-case. Thanks!",
      "reply_to_post_number": 2,
      "reply_count": 1,
      "quote_count": 1,
      "like_count": 0,
      "reads": 18,
      "score": 8.6,
      "accepted_answer": false,
      "trust_level": 1,
      "user_id": 508
    },
    {
      "id": 12961,
      "post_number": 4,
      "username": "Andrew",
      "name": "",
      "created_at": "2025-05-22T16:42:07.116Z",
      "updated_at": "2025-05-22T16:43:33.829Z",
      "cooked": "<p>Hello. Here is a robust yet hacky solution:</p>\n<pre data-code-wrap=\"typ\"><code class=\"lang-typ\">#show heading.where(level: 2): it =&gt; {\n  set text(14pt)\n  box(it) + \":\"\n}\n\n#show: doc =&gt; {\n  let i = 0\n  let elements = doc.children\n  while i &lt; elements.len() {\n    if elements.at(i).func() == heading and elements.at(i).depth == 2 {\n      elements.at(i)\n      let j = i + 1\n      while (\n        j &lt; elements.len() and elements.at(j).func() in (parbreak, [ ].func())\n      ) {\n        j += 1\n      }\n      if j &gt;= elements.len() { break }\n      \" \"\n      i = j\n    }\n    elements.at(i)\n    i += 1\n  }\n}\n\n== Heading\n// space\n#lorem(50)\n\n== Heading\n#lorem(50)\n\n== Heading\n\n#lorem(50)\n\n#heading(depth: 2)[Heading]#lorem(50)\n\n== Heading\n</code></pre>\n<p><img src=\"https://forum.typst.app/uploads/default/original/2X/4/464406c1f8a8d9c2913ecba9393846ddab3f0963.png\" alt=\"image\" data-base62-sha1=\"a1BasVrayWgmit7zZtxOkHMYrC3\" width=\"593\" height=\"374\"></p>\n<p>You can start writing a paragraph however you want, but global show rules can break something else. Though only real testing can say for sure. If there is a top-level styling added, then the <code>styled</code> element will have to be parsed a bit differently, though still should be possible.</p>",
      "raw": "Hello. Here is a robust yet hacky solution:\n\n```typ\n#show heading.where(level: 2): it => {\n  set text(14pt)\n  box(it) + \":\"\n}\n\n#show: doc => {\n  let i = 0\n  let elements = doc.children\n  while i < elements.len() {\n    if elements.at(i).func() == heading and elements.at(i).depth == 2 {\n      elements.at(i)\n      let j = i + 1\n      while (\n        j < elements.len() and elements.at(j).func() in (parbreak, [ ].func())\n      ) {\n        j += 1\n      }\n      if j >= elements.len() { break }\n      \" \"\n      i = j\n    }\n    elements.at(i)\n    i += 1\n  }\n}\n\n== Heading\n// space\n#lorem(50)\n\n== Heading\n#lorem(50)\n\n== Heading\n\n#lorem(50)\n\n#heading(depth: 2)[Heading]#lorem(50)\n\n== Heading\n```\n\n![image|593x374](upload://a1BasVrayWgmit7zZtxOkHMYrC3.png)\n\nYou can start writing a paragraph however you want, but global show rules can break something else. Though only real testing can say for sure. If there is a top-level styling added, then the `styled` element will have to be parsed a bit differently, though still should be possible.",
      "reply_to_post_number": null,
      "reply_count": 1,
      "quote_count": 0,
      "like_count": 2,
      "reads": 17,
      "score": 38.4,
      "accepted_answer": false,
      "trust_level": 3,
      "user_id": 51
    },
    {
      "id": 12962,
      "post_number": 5,
      "username": "kescobo",
      "name": "Kevin Bonham",
      "created_at": "2025-05-22T16:51:28.181Z",
      "updated_at": "2025-05-22T16:51:28.181Z",
      "cooked": "<p>Woah, neat! I barely understand what’s going on, but the results speak for themselves <img src=\"https://forum.typst.app/images/emoji/apple/smile.png?v=12\" title=\":smile:\" class=\"emoji\" alt=\":smile:\" loading=\"lazy\" width=\"20\" height=\"20\"></p>",
      "raw": "Woah, neat! I barely understand what's going on, but the results speak for themselves :smile:",
      "reply_to_post_number": 4,
      "reply_count": 1,
      "quote_count": 0,
      "like_count": 0,
      "reads": 13,
      "score": 7.6,
      "accepted_answer": false,
      "trust_level": 1,
      "user_id": 508
    },
    {
      "id": 12963,
      "post_number": 6,
      "username": "sijo",
      "name": "",
      "created_at": "2025-05-22T17:00:14.690Z",
      "updated_at": "2025-05-22T17:01:21.736Z",
      "cooked": "<aside class=\"quote no-group quote-modified\" data-username=\"kescobo\" data-post=\"3\" data-topic=\"4227\" data-full=\"true\">\n<div class=\"title\">\n<div class=\"quote-controls\"></div>\n<img loading=\"lazy\" alt=\"\" width=\"24\" height=\"24\" src=\"https://forum.typst.app/letter_avatar_proxy/v4/letter/k/19798D/48.png\" class=\"avatar\"> kescobo:</div>\n<blockquote>\n<aside class=\"quote no-group quote-modified\" data-username=\"sijo\" data-post=\"2\" data-topic=\"4227\">\n<div class=\"title\">\n<div class=\"quote-controls\"></div>\n<img loading=\"lazy\" alt=\"\" width=\"24\" height=\"24\" src=\"https://forum.typst.app/letter_avatar_proxy/v4/letter/s/0A3649/48.png\" class=\"avatar\"> sijo:</div>\n<blockquote>\n<p>this doesn’t compose very well with other show-it rules since it removes the heading element.</p>\n</blockquote>\n</aside>\n<p>Good to note, but that’s ok for my current use-case. Thanks!</p>\n</blockquote>\n</aside>\n<p>To be clear, the given code (with <code>box(it)</code>) doesn’t have that problem because it preserves the <code>it</code> value instead of replacing it with <code>it.body</code>.</p>",
      "raw": "[quote=\"kescobo, post:3, topic:4227, full:true\"]\n[quote=\"sijo, post:2, topic:4227\"]\nthis doesn’t compose very well with other show-it rules since it removes the heading element.\n[/quote]\n\nGood to note, but that’s ok for my current use-case. Thanks!\n[/quote]\n\nTo be clear, the given code (with `box(it)`) doesn't have that problem because it preserves the `it` value instead of replacing it with `it.body`.",
      "reply_to_post_number": 3,
      "reply_count": 0,
      "quote_count": 2,
      "like_count": 0,
      "reads": 12,
      "score": 2.4,
      "accepted_answer": false,
      "trust_level": 3,
      "user_id": 332
    },
    {
      "id": 12965,
      "post_number": 7,
      "username": "Andrew",
      "name": "",
      "created_at": "2025-05-22T17:05:35.864Z",
      "updated_at": "2025-05-22T17:05:35.864Z",
      "cooked": "<p>The algorithm goes over all elements in the <code>sequence</code> element and filters out <code>parbreak</code> and <code>space</code> elements that go after the <code>depth: 2</code> headings. And adds a single space after all the removed stuff if there is still something after the heading.</p>",
      "raw": "The algorithm goes over all elements in the `sequence` element and filters out `parbreak` and `space` elements that go after the `depth: 2` headings. And adds a single space after all the removed stuff if there is still something after the heading.",
      "reply_to_post_number": 5,
      "reply_count": 0,
      "quote_count": 0,
      "like_count": 0,
      "reads": 12,
      "score": 2.4,
      "accepted_answer": false,
      "trust_level": 3,
      "user_id": 51
    }
  ],
  "scraped_at": "2025-06-10T09:47:26.055124"
}