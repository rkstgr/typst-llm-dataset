{
  "topic_metadata": {
    "id": 1175,
    "title": "How to properly change background color of a block 'raw' element?",
    "slug": "how-to-properly-change-background-color-of-a-block-raw-element",
    "posts_count": 7,
    "created_at": "2024-10-18T03:52:09.263Z",
    "last_posted_at": "2024-10-23T12:05:17.669Z",
    "views": 758,
    "like_count": 6,
    "reply_count": 5,
    "has_accepted_answer": true,
    "accepted_answer_post_number": 5,
    "accepted_answer_username": "sijo",
    "tags": [
      "scripting"
    ],
    "category_id": 5,
    "participant_count": 4,
    "word_count": 584
  },
  "posts": [
    {
      "id": 4141,
      "post_number": 1,
      "username": "jsx97",
      "name": "jsx97",
      "created_at": "2024-10-18T03:52:09.349Z",
      "updated_at": "2024-10-23T12:04:30.667Z",
      "cooked": "<pre data-code-wrap=\"typ\"><code class=\"lang-typ\">#show raw.where(block: true): block.with(fill: luma(240), inset: 1em, radius: 0.5em, width: 100%)\n#show raw.where(block: false): box.with(fill: luma(240), inset: (x: 3pt), outset: (y: 3pt), radius: 2pt)\n\n```rust\nfn main() {\n    println!(\"Hello, world!\");\n}\n```\n\n#[\n  #show raw.where(block: true): set block(fill: rgb(\"#ffff00\"), inset: 1em, radius: 0.5em, width: 100%)\n  ```rust\n  fn main() {\n      println!(\"Hello, world!\");\n  }\n  ```\n]\n\nLorem ipsum ```rust fn main()``` dolor sit amet.\n</code></pre>\n<p>I want the block raw elements to have gray background, and this works fine. But then I try to make one of them to have yellow background instead of gray, and this seems to add another block instead of changing the color of the existing one. How to fix it?</p>\n<p>Current output:</p>\n<blockquote>\n<p><div class=\"lightbox-wrapper\"><a class=\"lightbox\" href=\"https://forum.typst.app/uploads/default/original/1X/cc1e1e5b11a0aa3f804b2840e0fd48dc7a7da3f8.png\" data-download-href=\"https://forum.typst.app/uploads/default/cc1e1e5b11a0aa3f804b2840e0fd48dc7a7da3f8\" title=\"image\"><img src=\"https://forum.typst.app/uploads/default/optimized/1X/cc1e1e5b11a0aa3f804b2840e0fd48dc7a7da3f8_2_690x206.png\" alt=\"image\" data-base62-sha1=\"t7HVPoAvTuSsAxmYSZjfaZYjO2I\" width=\"690\" height=\"206\" srcset=\"https://forum.typst.app/uploads/default/optimized/1X/cc1e1e5b11a0aa3f804b2840e0fd48dc7a7da3f8_2_690x206.png, https://forum.typst.app/uploads/default/optimized/1X/cc1e1e5b11a0aa3f804b2840e0fd48dc7a7da3f8_2_1035x309.png 1.5x, https://forum.typst.app/uploads/default/optimized/1X/cc1e1e5b11a0aa3f804b2840e0fd48dc7a7da3f8_2_1380x412.png 2x\" data-dominant-color=\"F6F6B9\"><div class=\"meta\"><svg class=\"fa d-icon d-icon-far-image svg-icon\" aria-hidden=\"true\"><use href=\"#far-image\"></use></svg><span class=\"filename\">image</span><span class=\"informations\">1626×486 49.7 KB</span><svg class=\"fa d-icon d-icon-discourse-expand svg-icon\" aria-hidden=\"true\"><use href=\"#discourse-expand\"></use></svg></div></a></div></p>\n</blockquote>\n<p>What I’m trying to achieve:</p>\n<blockquote>\n<p><div class=\"lightbox-wrapper\"><a class=\"lightbox\" href=\"https://forum.typst.app/uploads/default/original/1X/4d7cf2fcca34145889758b3215e6c5916da6c6dc.png\" data-download-href=\"https://forum.typst.app/uploads/default/4d7cf2fcca34145889758b3215e6c5916da6c6dc\" title=\"image\"><img src=\"https://forum.typst.app/uploads/default/optimized/1X/4d7cf2fcca34145889758b3215e6c5916da6c6dc_2_690x176.png\" alt=\"image\" data-base62-sha1=\"b3usZoSoVqQ3LATiQQ52N2QC4rO\" width=\"690\" height=\"176\" srcset=\"https://forum.typst.app/uploads/default/optimized/1X/4d7cf2fcca34145889758b3215e6c5916da6c6dc_2_690x176.png, https://forum.typst.app/uploads/default/optimized/1X/4d7cf2fcca34145889758b3215e6c5916da6c6dc_2_1035x264.png 1.5x, https://forum.typst.app/uploads/default/optimized/1X/4d7cf2fcca34145889758b3215e6c5916da6c6dc_2_1380x352.png 2x\" data-dominant-color=\"F7F7B1\"><div class=\"meta\"><svg class=\"fa d-icon d-icon-far-image svg-icon\" aria-hidden=\"true\"><use href=\"#far-image\"></use></svg><span class=\"filename\">image</span><span class=\"informations\">1628×416 45.8 KB</span><svg class=\"fa d-icon d-icon-discourse-expand svg-icon\" aria-hidden=\"true\"><use href=\"#discourse-expand\"></use></svg></div></a></div></p>\n</blockquote>",
      "raw": "````typ\n#show raw.where(block: true): block.with(fill: luma(240), inset: 1em, radius: 0.5em, width: 100%)\n#show raw.where(block: false): box.with(fill: luma(240), inset: (x: 3pt), outset: (y: 3pt), radius: 2pt)\n\n```rust\nfn main() {\n    println!(\"Hello, world!\");\n}\n```\n\n#[\n  #show raw.where(block: true): set block(fill: rgb(\"#ffff00\"), inset: 1em, radius: 0.5em, width: 100%)\n  ```rust\n  fn main() {\n      println!(\"Hello, world!\");\n  }\n  ```\n]\n\nLorem ipsum ```rust fn main()``` dolor sit amet.\n````\n\nI want the block raw elements to have gray background, and this works fine. But then I try to make one of them to have yellow background instead of gray, and this seems to add another block instead of changing the color of the existing one. How to fix it?\n\nCurrent output:\n\n>![image|690x206](upload://t7HVPoAvTuSsAxmYSZjfaZYjO2I.png)\n\nWhat I'm trying to achieve:\n\n> ![image|690x176](upload://b3usZoSoVqQ3LATiQQ52N2QC4rO.png)",
      "reply_to_post_number": null,
      "reply_count": 0,
      "quote_count": 0,
      "like_count": 0,
      "reads": 43,
      "score": 4238.6,
      "accepted_answer": false,
      "trust_level": 1,
      "user_id": 477
    },
    {
      "id": 4147,
      "post_number": 2,
      "username": "quachpas",
      "name": "Pascal Quach",
      "created_at": "2024-10-18T06:13:47.234Z",
      "updated_at": "2024-10-18T06:13:47.234Z",
      "cooked": "<p>Hello, your first show rule uses a function <code>block.with</code>, and your second show rule is a <code>show-set</code>. They add up, hence the double background.<br>\nIf you modify the first show rule to be <code>set block(...)</code>, then its fine.</p>",
      "raw": "Hello, your first show rule uses a function `block.with`, and your second show rule is a `show-set`. They add up, hence the double background.\nIf you modify the first show rule to be `set block(...)`, then its fine.",
      "reply_to_post_number": null,
      "reply_count": 1,
      "quote_count": 0,
      "like_count": 1,
      "reads": 41,
      "score": 58.2,
      "accepted_answer": false,
      "trust_level": 3,
      "user_id": 258
    },
    {
      "id": 4162,
      "post_number": 3,
      "username": "jsx97",
      "name": "jsx97",
      "created_at": "2024-10-18T10:39:23.347Z",
      "updated_at": "2024-10-18T16:57:50.192Z",
      "cooked": "<p>Thanks, this solved the issue.</p>\n<pre data-code-wrap=\"typ\"><code class=\"lang-typ\">//before:\n//#show raw.where(block: true): block.with(fill: luma(240), inset: 1em, radius: 0.5em, width: 100%)\n\n#show raw.where(block: true): set block(fill: luma(240), inset: 1em, radius: 0.5em, width: 100%)\n\n\n```rust\nfn main() {\n    println!(\"Hello, world!\");\n}\n```\n\n#[\n  #show raw.where(block: true): set block(fill: rgb(\"#ffff00\"), inset: 1em, radius: 0.5em, width: 100%)\n  ```rust\n  fn main() {\n      println!(\"Hello, world!\");\n  }\n  ```\n]\n</code></pre>\n<p>But the <code>block.with</code> part is from the example in the docs, <a href=\"https://typst.app/docs/reference/text/raw/\">https://typst.app/docs/reference/text/raw/</a>:</p>\n<pre data-code-wrap=\"typ\"><code class=\"lang-typ\">#show raw.where(block: true): block.with(\n  fill: luma(240),\n  inset: 10pt,\n  radius: 4pt,\n)\n</code></pre>\n<p>And hence now there are two other questions arised:</p>\n<ul>\n<li>How exactly <code>.with</code> works? (Sorry, I did’t find the respective page in docs.)</li>\n<li>Why the example in the docs (which I’ve shown above) uses <code>block.with</code> instead of <code>set block</code>?</li>\n</ul>",
      "raw": "Thanks, this solved the issue.\n\n````typ\n//before:\n//#show raw.where(block: true): block.with(fill: luma(240), inset: 1em, radius: 0.5em, width: 100%)\n\n#show raw.where(block: true): set block(fill: luma(240), inset: 1em, radius: 0.5em, width: 100%)\n\n\n```rust\nfn main() {\n    println!(\"Hello, world!\");\n}\n```\n\n#[\n  #show raw.where(block: true): set block(fill: rgb(\"#ffff00\"), inset: 1em, radius: 0.5em, width: 100%)\n  ```rust\n  fn main() {\n      println!(\"Hello, world!\");\n  }\n  ```\n]\n````\n\nBut the `block.with` part is from the example in the docs, <https://typst.app/docs/reference/text/raw/>:\n\n```typ\n#show raw.where(block: true): block.with(\n  fill: luma(240),\n  inset: 10pt,\n  radius: 4pt,\n)\n```\n\nAnd hence now there are two other questions arised:\n\n- How exactly `.with` works? (Sorry, I did't find the respective page in docs.)\n- Why the example in the docs (which I've shown above) uses `block.with` instead of `set block`?",
      "reply_to_post_number": 2,
      "reply_count": 2,
      "quote_count": 0,
      "like_count": 0,
      "reads": 39,
      "score": 57.8,
      "accepted_answer": false,
      "trust_level": 1,
      "user_id": 477
    },
    {
      "id": 4165,
      "post_number": 4,
      "username": "quachpas",
      "name": "Pascal Quach",
      "created_at": "2024-10-18T11:52:55.576Z",
      "updated_at": "2024-10-18T11:52:55.576Z",
      "cooked": "<p>Glad it’s working!</p>\n<p>You can find the docs for <code>function.with</code> at <a href=\"https://typst.app/docs/reference/foundations/function/#definitions-with\" class=\"inline-onebox\">Function Type – Typst Documentation</a>. If you type “with” in the search box it is the first result.<br>\n<div class=\"lightbox-wrapper\"><a class=\"lightbox\" href=\"https://forum.typst.app/uploads/default/original/1X/a2d4fcce4f0ec13f33cc61cfa4bbc8d087e55e98.png\" data-download-href=\"https://forum.typst.app/uploads/default/a2d4fcce4f0ec13f33cc61cfa4bbc8d087e55e98\" title=\"image\"><img src=\"https://forum.typst.app/uploads/default/optimized/1X/a2d4fcce4f0ec13f33cc61cfa4bbc8d087e55e98_2_512x500.png\" alt=\"image\" data-base62-sha1=\"netFMnAlpxOHNfryVQe5kag4z3O\" width=\"512\" height=\"500\" srcset=\"https://forum.typst.app/uploads/default/optimized/1X/a2d4fcce4f0ec13f33cc61cfa4bbc8d087e55e98_2_512x500.png, https://forum.typst.app/uploads/default/original/1X/a2d4fcce4f0ec13f33cc61cfa4bbc8d087e55e98.png 1.5x, https://forum.typst.app/uploads/default/original/1X/a2d4fcce4f0ec13f33cc61cfa4bbc8d087e55e98.png 2x\" data-dominant-color=\"F2F3F5\"><div class=\"meta\"><svg class=\"fa d-icon d-icon-far-image svg-icon\" aria-hidden=\"true\"><use href=\"#far-image\"></use></svg><span class=\"filename\">image</span><span class=\"informations\">584×570 32.5 KB</span><svg class=\"fa d-icon d-icon-discourse-expand svg-icon\" aria-hidden=\"true\"><use href=\"#discourse-expand\"></use></svg></div></a></div></p>\n<p>The reason why the second works is because <code>raw</code> is already a block element. I am unsure why the docs write it as <code>block.with</code>, but it has the same output for sure.</p>",
      "raw": "Glad it's working!\n\nYou can find the docs for `function.with` at https://typst.app/docs/reference/foundations/function/#definitions-with. If you type \"with\" in the search box it is the first result.\n![image|512x500](upload://netFMnAlpxOHNfryVQe5kag4z3O.png)\n\nThe reason why the second works is because `raw` is already a block element. I am unsure why the docs write it as `block.with`, but it has the same output for sure.",
      "reply_to_post_number": 3,
      "reply_count": 1,
      "quote_count": 0,
      "like_count": 1,
      "reads": 31,
      "score": 51.2,
      "accepted_answer": false,
      "trust_level": 3,
      "user_id": 258
    },
    {
      "id": 4166,
      "post_number": 5,
      "username": "sijo",
      "name": "",
      "created_at": "2024-10-18T11:57:38.198Z",
      "updated_at": "2024-10-18T11:57:38.198Z",
      "cooked": "<p><code>f.with(a: 1)</code> takes a function <code>f</code> and returns a new function with argument <code>a</code> already set to 1.</p>\n<p>There are several types of rules that do different things, see <a href=\"https://typst.app/docs/reference/styling/\">here</a>.</p>\n<p>In particular:</p>\n<ul>\n<li>\n<p><code>#show A: set B(...)</code> is a “show-set” rule, it changes the default B settings for A elements. For example <code>#show raw: set block(fill: luma(240))</code> sets the default fill for blocks in a raw element.</p>\n</li>\n<li>\n<p><code>#show A: f</code> is a “show” rule: it transforms elements A by passing them to the given function. For example <code>#show raw: block.with(fill: luma(240))</code> is the same as <code>#show raw: it =&gt; block(fill: luma(240), it)</code>. It wraps the raw element in a new block.</p>\n</li>\n</ul>\n<p>Of course sometimes both methods can be used to get the same visual result.</p>",
      "raw": "`f.with(a: 1)` takes a function `f` and returns a new function with argument `a` already set to 1.\n\nThere are several types of rules that do different things, see [here](https://typst.app/docs/reference/styling/).\n\nIn particular:\n\n* `#show A: set B(...)` is a \"show-set\" rule, it changes the default B settings for A elements. For example `#show raw: set block(fill: luma(240))` sets the default fill for blocks in a raw element.\n\n* `#show A: f` is a \"show\" rule: it transforms elements A by passing them to the given function. For example `#show raw: block.with(fill: luma(240))` is the same as `#show raw: it => block(fill: luma(240), it)`. It wraps the raw element in a new block.\n\nOf course sometimes both methods can be used to get the same visual result.",
      "reply_to_post_number": 3,
      "reply_count": 1,
      "quote_count": 0,
      "like_count": 3,
      "reads": 30,
      "score": 86.0,
      "accepted_answer": true,
      "trust_level": 3,
      "user_id": 332
    },
    {
      "id": 4172,
      "post_number": 6,
      "username": "jsx97",
      "name": "jsx97",
      "created_at": "2024-10-18T12:40:34.060Z",
      "updated_at": "2024-10-18T12:40:48.931Z",
      "cooked": "<p><a class=\"mention\" href=\"/u/sijo\">@sijo</a> Thanks a lot! Now I understand.</p>",
      "raw": "@sijo Thanks a lot! Now I understand.",
      "reply_to_post_number": 5,
      "reply_count": 1,
      "quote_count": 0,
      "like_count": 0,
      "reads": 30,
      "score": 11.0,
      "accepted_answer": false,
      "trust_level": 1,
      "user_id": 477
    },
    {
      "id": 4530,
      "post_number": 7,
      "username": "SillyFreak",
      "name": "SillyFreak",
      "created_at": "2024-10-23T12:05:17.669Z",
      "updated_at": "2024-10-23T12:05:17.669Z",
      "cooked": "<p>Hi <a class=\"mention\" href=\"/u/jsx97\">@jsx97</a>, don’t forget to tick one of the responses if you got a satisfying answer. The answer you choose should usually be the response that you found most correct/helpful/comprehensive for the question you asked. Thanks!</p>",
      "raw": "Hi @jsx97, don’t forget to tick one of the responses if you got a satisfying answer. The answer you choose should usually be the response that you found most correct/helpful/comprehensive for the question you asked. Thanks!",
      "reply_to_post_number": 6,
      "reply_count": 0,
      "quote_count": 0,
      "like_count": 1,
      "reads": 21,
      "score": 19.2,
      "accepted_answer": false,
      "trust_level": 3,
      "user_id": 32
    }
  ],
  "scraped_at": "2025-06-10T09:56:35.564050"
}