{
  "topic_metadata": {
    "id": 3255,
    "title": "Is there a way to suppress errors in case of a missing reference?",
    "slug": "is-there-a-way-to-suppress-errors-in-case-of-a-missing-reference",
    "posts_count": 5,
    "created_at": "2025-03-14T09:29:39.280Z",
    "last_posted_at": "2025-03-22T08:03:32.183Z",
    "views": 119,
    "like_count": 3,
    "reply_count": 2,
    "has_accepted_answer": true,
    "accepted_answer_post_number": 2,
    "accepted_answer_username": "janekfleper",
    "tags": [
      "citation"
    ],
    "category_id": 5,
    "participant_count": 4,
    "word_count": 428
  },
  "posts": [
    {
      "id": 9793,
      "post_number": 1,
      "username": "Mathieu",
      "name": "Mathieu",
      "created_at": "2025-03-14T09:29:39.388Z",
      "updated_at": "2025-03-14T09:30:41.618Z",
      "cooked": "<p>When citing a reference whose label is missing, Typst throws an error:</p>\n<pre><code class=\"lang-auto\">As noted previously @foo-2025, ...\n</code></pre>\n<p>yields:</p>\n<pre><code class=\"lang-auto\">error: label &lt;foo-2025&gt; does not exist in the document\n</code></pre>\n<p>which forces us to stop writing and go hunt down the relevant bibliographic details.</p>\n<p>In LaTeX, missing references are simply displayed in loud, visible markup such as:</p>\n<blockquote>\n<p>\"As noted previously [<strong>foo-2025</strong>], … \".</p>\n</blockquote>\n<p>Is there a way to have Typst emit simple warnings for missing references without throwing us out of the flow of writing?</p>",
      "raw": "When citing a reference whose label is missing, Typst throws an error:\n\n```\nAs noted previously @foo-2025, ...\n```\nyields:\n```\nerror: label <foo-2025> does not exist in the document\n```\nwhich forces us to stop writing and go hunt down the relevant bibliographic details.\n\nIn LaTeX, missing references are simply displayed in loud, visible markup such as:\n\n> \"As noted previously [**foo-2025**], ... \".\n\nIs there a way to have Typst emit simple warnings for missing references without throwing us out of the flow of writing?",
      "reply_to_post_number": null,
      "reply_count": 0,
      "quote_count": 0,
      "like_count": 0,
      "reads": 30,
      "score": 256.0,
      "accepted_answer": false,
      "trust_level": 1,
      "user_id": 1200
    },
    {
      "id": 9794,
      "post_number": 2,
      "username": "janekfleper",
      "name": "Janek Fleper",
      "created_at": "2025-03-14T10:08:54.826Z",
      "updated_at": "2025-03-14T11:09:16.469Z",
      "cooked": "<p>There is an <a href=\"https://github.com/typst/typst/issues/4035\" rel=\"noopener nofollow ugc\">issue</a> on GitHub about downgrading missing references to warnings. I think this is the place where you can find the most information regarding your question. Since the issue is still open and the discussion is ongoing, I’m afraid <s>there is no way to currently suppress the errors</s> there is no official solution yet. See the answer by <a class=\"mention\" href=\"/u/quachpas\">@quachpas</a> below for a workaround.</p>",
      "raw": "There is an [issue](https://github.com/typst/typst/issues/4035) on GitHub about downgrading missing references to warnings. I think this is the place where you can find the most information regarding your question. Since the issue is still open and the discussion is ongoing, I'm afraid ~~there is no way to currently suppress the errors~~ there is no official solution yet. See the answer by @quachpas below for a workaround.",
      "reply_to_post_number": null,
      "reply_count": 1,
      "quote_count": 0,
      "like_count": 0,
      "reads": 29,
      "score": 15.8,
      "accepted_answer": true,
      "trust_level": 3,
      "user_id": 69
    },
    {
      "id": 9797,
      "post_number": 3,
      "username": "quachpas",
      "name": "Pascal Quach",
      "created_at": "2025-03-14T10:44:13.162Z",
      "updated_at": "2025-03-14T10:44:13.162Z",
      "cooked": "<aside class=\"quote no-group\" data-username=\"janekfleper\" data-post=\"2\" data-topic=\"3255\">\n<div class=\"title\">\n<div class=\"quote-controls\"></div>\n<img loading=\"lazy\" alt=\"\" width=\"24\" height=\"24\" src=\"https://forum.typst.app/letter_avatar_proxy/v4/letter/j/8F38B1/48.png\" class=\"avatar\"> janekfleper:</div>\n<blockquote>\n<p>I’m afraid there is no way to currently suppress the errors.</p>\n</blockquote>\n</aside>\n<p>It’s a little verbose, but you can just replace labels that don’t exist.</p>\n<pre data-code-wrap=\"typ\"><code class=\"lang-typ\">#show ref: it =&gt; {\n  if query(it.target).len() == 0 {\n    \"[\" + str(it.target) + \"]\"\n  } else {\n    it\n  }\n}\n\n#figure[] &lt;label&gt;\n\n@label\n\n@ref\n</code></pre>\n<p><img src=\"https://forum.typst.app/uploads/default/original/2X/d/d3f787dad59d00a46a53169b0288a512feb7b523.png\" alt=\"image\" data-base62-sha1=\"uf94R0KsScGY5raemHjBU41Qlur\" width=\"79\" height=\"76\"></p>",
      "raw": "[quote=\"janekfleper, post:2, topic:3255\"]\nI’m afraid there is no way to currently suppress the errors.\n[/quote]\n\nIt's a little verbose, but you can just replace labels that don't exist.\n\n```typ\n#show ref: it => {\n  if query(it.target).len() == 0 {\n    \"[\" + str(it.target) + \"]\"\n  } else {\n    it\n  }\n}\n\n#figure[] <label>\n\n@label\n\n@ref\n```\n![image|79x76](upload://uf94R0KsScGY5raemHjBU41Qlur.png)",
      "reply_to_post_number": null,
      "reply_count": 1,
      "quote_count": 1,
      "like_count": 1,
      "reads": 28,
      "score": 35.6,
      "accepted_answer": false,
      "trust_level": 3,
      "user_id": 258
    },
    {
      "id": 10066,
      "post_number": 4,
      "username": "PetitPois",
      "name": "",
      "created_at": "2025-03-21T08:23:35.456Z",
      "updated_at": "2025-03-21T08:23:35.456Z",
      "cooked": "<p>Unfortunately, the solution of <a class=\"mention\" href=\"/u/quachpas\">@quachpas</a> <strong>breaks citations to the bibliography</strong> (because the query inevitably fails to find the citation label in the typst document). If one could test whether a link can be found in the <code>.bib</code> file or not, then the solution of <a class=\"mention\" href=\"/u/quachpas\">@quachpas</a> could be improved.</p>\n<p>Does someone know a way to do this?</p>",
      "raw": "Unfortunately, the solution of @quachpas **breaks citations to the bibliography** (because the query inevitably fails to find the citation label in the typst document). If one could test whether a link can be found in the `.bib` file or not, then the solution of @quachpas could be improved. \n\nDoes someone know a way to do this?",
      "reply_to_post_number": 3,
      "reply_count": 1,
      "quote_count": 0,
      "like_count": 0,
      "reads": 18,
      "score": 13.6,
      "accepted_answer": false,
      "trust_level": 0,
      "user_id": 1375
    },
    {
      "id": 10107,
      "post_number": 5,
      "username": "quachpas",
      "name": "Pascal Quach",
      "created_at": "2025-03-22T08:03:32.183Z",
      "updated_at": "2025-03-22T08:03:51.927Z",
      "cooked": "<p>Due to the way cite references work, there is no way to distinguish between a bibliographic reference or a nonexisting ref. See below, <code>lorem</code> being a reference to a bibliographic item.</p>\n<pre data-code-wrap=\"typ\"><code class=\"lang-typ\">ref(\ntarget: &lt;lorem&gt;,\nsupplement: auto,\nform: \"normal\",\ncitation: cite(key: &lt;lorem&gt;, supplement: none),\nelement: none,\n)\nref(\ntarget: &lt;ref&gt;,\nsupplement: auto,\nform: \"normal\",\ncitation: cite(key: &lt;ref&gt;, supplement: none),\nelement: none,\n)\n</code></pre>\n<p>Instead, you can adapt your show rule to read the bibliography file and compare the keys to the label target. That’s doable with simple parsing (as long as your file is formatted with the <code>@</code> and the <code>key</code> on the same line).</p>\n<pre data-code-wrap=\"typ\"><code class=\"lang-typ\">#bibliography(\"test.bib\")\n#show ref: it =&gt; {\n  let bibfile = read(\"test.bib\")\n  let entries = bibfile.split(\"@\")\n  entries.remove(0) // \"\"\n  let keys = for entry in entries {\n    (entry.slice(entry.position(\"{\")+1, entry.position(\",\")),)\n  }\n  if str(it.target) not in keys and query(it.target).len() == 0 {\n    \"[\" + str(it.target) + \"]\"\n  } else {\n    it\n  }\n}\n</code></pre>\n<p><img src=\"https://forum.typst.app/uploads/default/original/2X/3/30d9e2083507cdc5042c894f91aaca1198cd1280.png\" alt=\"image\" data-base62-sha1=\"6Y9JivQWlz43lFtN9VIqo6rTi48\" width=\"195\" height=\"244\"></p>",
      "raw": "Due to the way cite references work, there is no way to distinguish between a bibliographic reference or a nonexisting ref. See below, `lorem` being a reference to a bibliographic item.\n\n```typ\nref(\ntarget: <lorem>,\nsupplement: auto,\nform: \"normal\",\ncitation: cite(key: <lorem>, supplement: none),\nelement: none,\n)\nref(\ntarget: <ref>,\nsupplement: auto,\nform: \"normal\",\ncitation: cite(key: <ref>, supplement: none),\nelement: none,\n)\n```\nInstead, you can adapt your show rule to read the bibliography file and compare the keys to the label target. That's doable with simple parsing (as long as your file is formatted with the `@` and the `key` on the same line).\n\n```typ\n#bibliography(\"test.bib\")\n#show ref: it => {\n  let bibfile = read(\"test.bib\")\n  let entries = bibfile.split(\"@\")\n  entries.remove(0) // \"\"\n  let keys = for entry in entries {\n    (entry.slice(entry.position(\"{\")+1, entry.position(\",\")),)\n  }\n  if str(it.target) not in keys and query(it.target).len() == 0 {\n    \"[\" + str(it.target) + \"]\"\n  } else {\n    it\n  }\n}\n```\n![image|195x244](upload://6Y9JivQWlz43lFtN9VIqo6rTi48.png)",
      "reply_to_post_number": 4,
      "reply_count": 0,
      "quote_count": 0,
      "like_count": 2,
      "reads": 18,
      "score": 33.6,
      "accepted_answer": false,
      "trust_level": 3,
      "user_id": 258
    }
  ],
  "scraped_at": "2025-06-10T09:50:22.388579"
}