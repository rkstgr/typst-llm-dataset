{
  "topic_metadata": {
    "id": 3489,
    "title": "How to style an element if it contains or if it starts with another element?",
    "slug": "how-to-style-an-element-if-it-contains-or-if-it-starts-with-another-element",
    "posts_count": 10,
    "created_at": "2025-04-02T08:04:10.767Z",
    "last_posted_at": "2025-04-02T15:25:14.168Z",
    "views": 78,
    "like_count": 7,
    "reply_count": 7,
    "has_accepted_answer": true,
    "accepted_answer_post_number": 2,
    "accepted_answer_username": "Andrew",
    "tags": [
      "layout",
      "styling"
    ],
    "category_id": 5,
    "participant_count": 3,
    "word_count": 1261
  },
  "posts": [
    {
      "id": 10520,
      "post_number": 1,
      "username": "a_w",
      "name": "Alex",
      "created_at": "2025-04-02T08:04:11.024Z",
      "updated_at": "2025-04-02T08:04:11.024Z",
      "cooked": "<p>I tried searching for various combinations of ‚Äústyle element based on content‚Äù or ‚Äústyle container based on child‚Äù or style ‚Äúbased on containing elements‚Äù but didn‚Äôt find a solution for the following two fold question:</p>\n<p>I want to style a container <code>#outside</code> (or parts of it) in two cases</p>\n<ul>\n<li>Case A: When it contains <code>#inside</code></li>\n<li>Case B: When it starts with <code>#inside</code></li>\n</ul>\n<pre data-code-wrap=\"typ\"><code class=\"lang-typ\">#let inside(body) = {\n  set text(blue)\n  body\n}\n\n#let outside(body) = {\n  if body.has(\"child\") {\n    set text(blue) if body.children.at(0).child == \"??\" // This was an attempt\n  }\n  \"Yo, \" + body\n}\n\n*How can I make this blue if it contains `#inside`?*\\\n#outside[listen up here‚Ä≤s a story #inside[I'm blue] Da ba dee da ba di.] \\\n#text(fill: blue, \"Yo, listen up here‚Ä≤s a story I'm blue Da ba dee da ba di.\") (Expected)\n\n*How can I make the \"Yo, \" blue only if `#outside` starts with `#inside`?*\\\n#outside[#inside[I'm blue] Da ba dee da ba di.] \\\n#text(fill: blue, \"Yo, I'm blue\") Da ba dee da ba di. (Expected) \\\n#text(fill: blue, \"Yo, I'm also blue\") Da ba dee da ba di. (Expected)\n</code></pre>\n<p><div class=\"lightbox-wrapper\"><a class=\"lightbox\" href=\"https://forum.typst.app/uploads/default/original/2X/8/862a7e3e3b5e1bbd380cd1e49993ccbebbb6475f.png\" data-download-href=\"https://forum.typst.app/uploads/default/862a7e3e3b5e1bbd380cd1e49993ccbebbb6475f\" title=\"how-blue\"><img src=\"https://forum.typst.app/uploads/default/optimized/2X/8/862a7e3e3b5e1bbd380cd1e49993ccbebbb6475f_2_690x248.png\" alt=\"how-blue\" data-base62-sha1=\"j8T1ncTBYlVuJ0JUWPQTyLKuqN9\" width=\"690\" height=\"248\" srcset=\"https://forum.typst.app/uploads/default/optimized/2X/8/862a7e3e3b5e1bbd380cd1e49993ccbebbb6475f_2_690x248.png, https://forum.typst.app/uploads/default/original/2X/8/862a7e3e3b5e1bbd380cd1e49993ccbebbb6475f.png 1.5x, https://forum.typst.app/uploads/default/original/2X/8/862a7e3e3b5e1bbd380cd1e49993ccbebbb6475f.png 2x\" data-dominant-color=\"EDEFF0\"><div class=\"meta\"><svg class=\"fa d-icon d-icon-far-image svg-icon\" aria-hidden=\"true\"><use href=\"#far-image\"></use></svg><span class=\"filename\">how-blue</span><span class=\"informations\">926√ó334 101 KB</span><svg class=\"fa d-icon d-icon-discourse-expand svg-icon\" aria-hidden=\"true\"><use href=\"#discourse-expand\"></use></svg></div></a></div></p>\n<p>I realize ‚Äúelement‚Äù may not be the best (or most specific) word both ‚Äúelements‚Äù are user-defined functions.</p>\n<p>What is the best way to achieve this? <img src=\"https://forum.typst.app/images/emoji/apple/blush.png?v=12\" title=\":blush:\" class=\"emoji\" alt=\":blush:\" loading=\"lazy\" width=\"20\" height=\"20\"></p>",
      "raw": "I tried searching for various combinations of \"style element based on content\" or \"style container based on child\" or style \"based on containing elements\" but didn't find a solution for the following two fold question:\n\nI want to style a container `#outside` (or parts of it) in two cases\n- Case A: When it contains `#inside`\n- Case B: When it starts with `#inside`\n\n```typ\n#let inside(body) = {\n  set text(blue)\n  body\n}\n\n#let outside(body) = {\n  if body.has(\"child\") {\n    set text(blue) if body.children.at(0).child == \"??\" // This was an attempt\n  }\n  \"Yo, \" + body\n}\n\n*How can I make this blue if it contains `#inside`?*\\\n#outside[listen up here‚Ä≤s a story #inside[I'm blue] Da ba dee da ba di.] \\\n#text(fill: blue, \"Yo, listen up here‚Ä≤s a story I'm blue Da ba dee da ba di.\") (Expected)\n\n*How can I make the \"Yo, \" blue only if `#outside` starts with `#inside`?*\\\n#outside[#inside[I'm blue] Da ba dee da ba di.] \\\n#text(fill: blue, \"Yo, I'm blue\") Da ba dee da ba di. (Expected) \\\n#text(fill: blue, \"Yo, I'm also blue\") Da ba dee da ba di. (Expected)\n```\n\n![how-blue|690x248](upload://j8T1ncTBYlVuJ0JUWPQTyLKuqN9.png)\n\nI realize \"element\" may not be the best (or most specific) word both \"elements\" are user-defined functions.\n\nWhat is the best way to achieve this? üòä",
      "reply_to_post_number": null,
      "reply_count": 0,
      "quote_count": 0,
      "like_count": 1,
      "reads": 24,
      "score": 129.8,
      "accepted_answer": false,
      "trust_level": 2,
      "user_id": 566
    },
    {
      "id": 10528,
      "post_number": 2,
      "username": "Andrew",
      "name": "",
      "created_at": "2025-04-02T10:24:04.286Z",
      "updated_at": "2025-04-02T10:24:04.286Z",
      "cooked": "<p>I think this isn‚Äôt currently achievable easily, because of this:</p>\n<aside class=\"onebox githubissue\" data-onebox-src=\"https://github.com/typst/typst/issues/147\">\n  <header class=\"source\">\n\n      <a href=\"https://github.com/typst/typst/issues/147\" target=\"_blank\" rel=\"noopener nofollow ugc\">github.com/typst/typst</a>\n  </header>\n\n  <article class=\"onebox-body\">\n    <div class=\"github-row\">\n  <div class=\"github-icon-container\" title=\"Issue\" data-github-private-repo=\"false\">\n\t  <svg width=\"60\" height=\"60\" class=\"github-icon\" viewBox=\"0 0 14 16\" aria-hidden=\"true\"><path fill-rule=\"evenodd\" d=\"M7 2.3c3.14 0 5.7 2.56 5.7 5.7s-2.56 5.7-5.7 5.7A5.71 5.71 0 0 1 1.3 8c0-3.14 2.56-5.7 5.7-5.7zM7 1C3.14 1 0 4.14 0 8s3.14 7 7 7 7-3.14 7-7-3.14-7-7-7zm1 3H6v5h2V4zm0 6H6v2h2v-2z\"></path></svg>\n  </div>\n\n  <div class=\"github-info-container\">\n    <h4>\n      <a href=\"https://github.com/typst/typst/issues/147\" target=\"_blank\" rel=\"noopener nofollow ugc\">Support for user-defined elements</a>\n    </h4>\n\n    <div class=\"github-info\">\n      <div class=\"date\">\n        opened <span class=\"discourse-local-date\" data-format=\"ll\" data-date=\"2023-03-22\" data-time=\"13:49:16\" data-timezone=\"UTC\">01:49PM - 22 Mar 23 UTC</span>\n      </div>\n\n\n      <div class=\"user\">\n        <a href=\"https://github.com/AndyBarcia\" target=\"_blank\" rel=\"noopener nofollow ugc\">\n          <img alt=\"AndyBarcia\" src=\"https://forum.typst.app/uploads/default/original/2X/1/111fd79e8ca5732ee3ca0f737953c93cde5c5efa.jpeg\" class=\"onebox-avatar-inline\" width=\"20\" height=\"20\" data-dominant-color=\"402B43\">\n          AndyBarcia\n        </a>\n      </div>\n    </div>\n\n    <div class=\"labels\">\n        <span style=\"display:inline-block;margin-top:2px;background-color: #B8B8B8;padding: 2px;border-radius: 4px;color: #fff;margin-left: 3px;\">\n          feature request\n        </span>\n        <span style=\"display:inline-block;margin-top:2px;background-color: #B8B8B8;padding: 2px;border-radius: 4px;color: #fff;margin-left: 3px;\">\n          scripting\n        </span>\n        <span style=\"display:inline-block;margin-top:2px;background-color: #B8B8B8;padding: 2px;border-radius: 4px;color: #fff;margin-left: 3px;\">\n          styling\n        </span>\n    </div>\n  </div>\n</div>\n\n  <div class=\"github-row\">\n    <p class=\"github-body-container\">Hi, I've only been using Typst for some hours, so I don't know if I'm just not u<span class=\"show-more-container\"><a href=\"\" rel=\"noopener\" class=\"show-more\">‚Ä¶</a></span><span class=\"excerpt hidden\">nderstanding the problem correctly. But I've noticed that this code:\n\n```\n#let test(color: red, content) = box(fill: color)[#content]\n#set test(color: blue)\n#test[Test Content]\n```\n\nFails to compile with this error:\n\n```\nerror: only element functions can be used in set rules\n   ‚îå‚îÄ main.typ:37:5\n   ‚îÇ\n37 ‚îÇ #set test(color: blue)\n   ‚îÇ      ^^^^\n```\n\nAfter reading the source code, I've reached the conclusion that set rules can only be used with native functions, or as they are called in the documentation, \"elements\". \n\nI was wondering if this was a permanent design decisions, or if in the future set rules could be applied to any optional argument of any function. And if it is a design decision, I'm thinking that the documentation should more explicitly mention the distinction between user-defined functions and native functions or \"elements\"; and that set and show rules can only be used with native functions, and nothing else.</span></p>\n  </div>\n\n  </article>\n\n  <div class=\"onebox-metadata\">\n    \n    \n  </div>\n\n  <div style=\"clear: both\"></div>\n</aside>\n\n<aside class=\"onebox githubissue\" data-onebox-src=\"https://github.com/typst/typst/issues/1926\">\n  <header class=\"source\">\n\n      <a href=\"https://github.com/typst/typst/issues/1926\" target=\"_blank\" rel=\"noopener nofollow ugc\">github.com/typst/typst</a>\n  </header>\n\n  <article class=\"onebox-body\">\n    <div class=\"github-row\">\n  <div class=\"github-icon-container\" title=\"Issue\" data-github-private-repo=\"false\">\n\t  <svg width=\"60\" height=\"60\" class=\"github-icon\" viewBox=\"0 0 14 16\" aria-hidden=\"true\"><path fill-rule=\"evenodd\" d=\"M7 2.3c3.14 0 5.7 2.56 5.7 5.7s-2.56 5.7-5.7 5.7A5.71 5.71 0 0 1 1.3 8c0-3.14 2.56-5.7 5.7-5.7zM7 1C3.14 1 0 4.14 0 8s3.14 7 7 7 7-3.14 7-7-3.14-7-7-7zm1 3H6v5h2V4zm0 6H6v2h2v-2z\"></path></svg>\n  </div>\n\n  <div class=\"github-info-container\">\n    <h4>\n      <a href=\"https://github.com/typst/typst/issues/1926\" target=\"_blank\" rel=\"noopener nofollow ugc\">Ancestry/inside selector</a>\n    </h4>\n\n    <div class=\"github-info\">\n      <div class=\"date\">\n        opened <span class=\"discourse-local-date\" data-format=\"ll\" data-date=\"2023-08-14\" data-time=\"00:27:22\" data-timezone=\"UTC\">12:27AM - 14 Aug 23 UTC</span>\n      </div>\n\n\n      <div class=\"user\">\n        <a href=\"https://github.com/MechMK1\" target=\"_blank\" rel=\"noopener nofollow ugc\">\n          <img alt=\"MechMK1\" src=\"https://forum.typst.app/uploads/default/original/2X/6/65e4c548d94ced524b81c669ee5216a9ce442c6a.png\" class=\"onebox-avatar-inline\" width=\"20\" height=\"20\" data-dominant-color=\"5F1F95\">\n          MechMK1\n        </a>\n      </div>\n    </div>\n\n    <div class=\"labels\">\n        <span style=\"display:inline-block;margin-top:2px;background-color: #B8B8B8;padding: 2px;border-radius: 4px;color: #fff;margin-left: 3px;\">\n          feature request\n        </span>\n        <span style=\"display:inline-block;margin-top:2px;background-color: #B8B8B8;padding: 2px;border-radius: 4px;color: #fff;margin-left: 3px;\">\n          styling\n        </span>\n    </div>\n  </div>\n</div>\n\n  <div class=\"github-row\">\n    <p class=\"github-body-container\">### Description\n\nCurrently, it is only possible to determine whether an element <span class=\"show-more-container\"><a href=\"\" rel=\"noopener\" class=\"show-more\">‚Ä¶</a></span><span class=\"excerpt hidden\">occurs after or before a specific element. However, it is not easily possible to determine whether an element is \"inside\" a specific element.\n\nFor example, take the following document:\n\n```\n= Chapter 1 &lt;C1&gt;\nThis &lt;Label&gt; is inside Chapter 1\n\n== Section 1\nThis &lt;OtherLabel&gt; is inside Chapter 1 and Section 1, but not Section 2\n\n== Section 2\nAnd &lt;YetAnotherLabel&gt; is inside Chapter 1 and Section 2, but not Section 1\n```\n\nIt becomes very difficult to determine whether an element is inside a chapter. This is *especially* true when combined with calls to `state()`, where one might be interested in seeing if a state update was made in a specific chapter or not.\n\n### Use Case\n\nThe primary use-case would be to determine whether or not an element is specifically inside another element. Take the following document as an example:\n\n```\n#let s = state(\"state\", 0)\n\n#let valueForChapter(chapter) = {\n  locate(loc =&gt; {\n    let tmp = query(selector(&lt;StateUpdate&gt;).after(chapter), loc)\n    if tmp == () {\n      // The chapter has no value associated. We'll return 0\n      0\n    }\n    else {\n      s.at(tmp.first().location())      \n    }\n  }) \n}\n\nExpected: 10 / Actual: #valueForChapter(&lt;H1&gt;)\n\nExpected: 0 / Actual: #valueForChapter(&lt;H2&gt;)\n\nExpected: 20 / Actual: #valueForChapter(&lt;H3&gt;)\n\n= H1 &lt;H1&gt;\nThe value of H1 is 10\n#s.update(10)\n&lt;StateUpdate&gt;\n\n= H2 &lt;H2&gt;\nThis chapter does not have a value associated.\n\n= H3 &lt;H3&gt;\nThe value of H3 is 20\n#s.update(20)\n&lt;StateUpdate&gt;\n```\n\nWith a `.inside()` method, it would become trivial to determine if H2 has a value associated to it or not. Without this method, one would need to use something like `selector(&lt;StateUpdate&gt;).after(&lt;H2&gt;).before(&lt;H3&gt;)`, which in turn becomes problematic inside loops.</span></p>\n  </div>\n\n  </article>\n\n  <div class=\"onebox-metadata\">\n    \n    \n  </div>\n\n  <div style=\"clear: both\"></div>\n</aside>\n\n<p>But <a href=\"https://github.com/PgBiel/elembic\" class=\"inline-onebox\" rel=\"noopener nofollow ugc\">GitHub - PgBiel/elembic: Framework for custom elements and types in Typst</a> might be able to help in achieving this in the meantime.</p>",
      "raw": "I think this isn't currently achievable easily, because of this:\n\nhttps://github.com/typst/typst/issues/147\n\nhttps://github.com/typst/typst/issues/1926\n\nBut https://github.com/PgBiel/elembic might be able to help in achieving this in the meantime.",
      "reply_to_post_number": null,
      "reply_count": 0,
      "quote_count": 0,
      "like_count": 1,
      "reads": 23,
      "score": 19.6,
      "accepted_answer": true,
      "trust_level": 3,
      "user_id": 51
    },
    {
      "id": 10537,
      "post_number": 3,
      "username": "a_w",
      "name": "Alex",
      "created_at": "2025-04-02T13:50:44.361Z",
      "updated_at": "2025-04-02T13:55:25.702Z",
      "cooked": "<p>Thank you, that‚Äôs bad news for the case, but somewhat good news for me, as I didn‚Äôt overlook something super obvious (as many times before).</p>\n<p>So even the <code>#outside[#inside[</code> case is not detectable because, other than the content, there is nothing to check against. Am I seeing this right?</p>\n<p>I‚Äôve just tried:</p>\n<pre data-code-wrap=\"typ\"><code class=\"lang-typ\">#outside[#inside[I'm blue]&lt;blue&gt; Da ba dee da ba di.]\n</code></pre>\n<p>as a workaround, but the sequence doesn‚Äôt seem to contain the label either.</p>",
      "raw": "Thank you, that's bad news for the case, but somewhat good news for me, as I didn't overlook something super obvious (as many times before).\n\nSo even the `#outside[#inside[` case is not detectable because, other than the content, there is nothing to check against. Am I seeing this right?\n\nI've just tried:\n```typ\n#outside[#inside[I'm blue]<blue> Da ba dee da ba di.]\n```\nas a workaround, but the sequence doesn't seem to contain the label either.",
      "reply_to_post_number": null,
      "reply_count": 2,
      "quote_count": 0,
      "like_count": 0,
      "reads": 23,
      "score": 14.6,
      "accepted_answer": false,
      "trust_level": 2,
      "user_id": 566
    },
    {
      "id": 10539,
      "post_number": 4,
      "username": "bluss",
      "name": "Ulrik",
      "created_at": "2025-04-02T14:15:44.280Z",
      "updated_at": "2025-04-02T14:16:47.853Z",
      "cooked": "<p>Here‚Äôs a hacky solution for the first question.</p>\n<p>Basic explanation: Every <code>outside</code> creates a new counter. <code>inside</code> adds to the current outside counter. The <code>outside</code> styling can detect the final value of its own counter and style itself accordingly.</p>\n<details>\n<pre data-code-wrap=\"typ\"><code class=\"lang-typ\">#show \"green\": set text(green)\n\n#let oc = counter(\"outside\")\n\n#let inside(body) = context {\n  // Why do we need -1 here? Don't know yet.\n  let ic = counter(\"inside/\" + str(oc.get().first() - 1))\n  ic.step()\n  set text(blue)\n  body\n}\n\n// There are 2 oc counters for each `outside`.\n// So that `inside` increments outside/x while inside `outside`\n// and adds to outside/x+1 otherwise.\n#let outside(body) = context {\n  oc.step()\n  let ic = counter(\"inside/\" + str(oc.get().first()))\n  let isblue = ic.final().first() &gt; 0\n  set text(blue) if isblue\n  \"Yo, \" + body\n  oc.step()\n}\n\n*How can I make this blue if it contains `#inside`?*\\\n#outside[listen up here‚Ä≤s a story #inside[I'm blue] Da ba dee da ba di.] \\\n#outside[listen up here‚Ä≤s a story I'm green Da ba dee da ba di.] \\\n#outside[listen up here‚Ä≤s a story #inside[I'm blue] Da ba dee da ba di.] \\\n#outside[listen up here‚Ä≤s a story #inside[I'm blue] Da ba dee da ba di.] \\\n#outside[listen up here‚Ä≤s a story #inside[I'm blue] Da ba dee da ba di.] \\\n#outside[listen up here‚Ä≤s a story I'm green Da ba dee da ba di.] \\\n\n#outside[Another empty sentence, should be black.]\n\n#inside[Freely running around inside]\n\n#outside[Empty outside.]\n\n\n#text(fill: blue, \"Yo, listen up here‚Ä≤s a story I'm blue Da ba dee da ba di.\") (Expected)\n\n*How can I make the \"Yo, \" blue only if `#outside` starts with `#inside`?*\\\n#outside[#inside[I'm blue] Da ba dee da ba di.] \\\n#text(fill: blue, \"Yo, I'm blue\") Da ba dee da ba di. (Expected) \\\n#text(fill: blue, \"Yo, I'm also blue\") Da ba dee da ba di. (Expected)\n</code></pre>\n</details>\n<p><img src=\"https://forum.typst.app/uploads/default/original/2X/5/50809f332111603f1eea93e3983f398e9bee392e.png\" alt=\"bild\" data-base62-sha1=\"bu9LEZQWiO3338AhZjq11neRCuW\" width=\"545\" height=\"416\"></p>\n<p>I have a question about my own code‚Ä¶ after this:</p>\n<pre data-code-wrap=\"typ\"><code class=\"lang-typ\">#let outside(body) = context {\n  oc.step()\n  let ic = counter(\"inside/\" + str(oc.get().first()))\n</code></pre>\n<p>The first time this is used, <code>ic</code> gets the counter called ‚Äúinside/0‚Äù, why doesn‚Äôt it get number 1? <code>oc</code> has been stepped just on the line before‚Ä¶</p>",
      "raw": "Here's a hacky solution for the first question.\n\nBasic explanation: Every `outside` creates a new counter. `inside` adds to the current outside counter. The `outside` styling can detect the final value of its own counter and style itself accordingly.\n\n<details>\n\n```typ\n#show \"green\": set text(green)\n\n#let oc = counter(\"outside\")\n\n#let inside(body) = context {\n  // Why do we need -1 here? Don't know yet.\n  let ic = counter(\"inside/\" + str(oc.get().first() - 1))\n  ic.step()\n  set text(blue)\n  body\n}\n\n// There are 2 oc counters for each `outside`.\n// So that `inside` increments outside/x while inside `outside`\n// and adds to outside/x+1 otherwise.\n#let outside(body) = context {\n  oc.step()\n  let ic = counter(\"inside/\" + str(oc.get().first()))\n  let isblue = ic.final().first() > 0\n  set text(blue) if isblue\n  \"Yo, \" + body\n  oc.step()\n}\n\n*How can I make this blue if it contains `#inside`?*\\\n#outside[listen up here‚Ä≤s a story #inside[I'm blue] Da ba dee da ba di.] \\\n#outside[listen up here‚Ä≤s a story I'm green Da ba dee da ba di.] \\\n#outside[listen up here‚Ä≤s a story #inside[I'm blue] Da ba dee da ba di.] \\\n#outside[listen up here‚Ä≤s a story #inside[I'm blue] Da ba dee da ba di.] \\\n#outside[listen up here‚Ä≤s a story #inside[I'm blue] Da ba dee da ba di.] \\\n#outside[listen up here‚Ä≤s a story I'm green Da ba dee da ba di.] \\\n\n#outside[Another empty sentence, should be black.]\n\n#inside[Freely running around inside]\n\n#outside[Empty outside.]\n\n\n#text(fill: blue, \"Yo, listen up here‚Ä≤s a story I'm blue Da ba dee da ba di.\") (Expected)\n\n*How can I make the \"Yo, \" blue only if `#outside` starts with `#inside`?*\\\n#outside[#inside[I'm blue] Da ba dee da ba di.] \\\n#text(fill: blue, \"Yo, I'm blue\") Da ba dee da ba di. (Expected) \\\n#text(fill: blue, \"Yo, I'm also blue\") Da ba dee da ba di. (Expected)\n```\n\n</details>\n\n![bild|545x416](upload://bu9LEZQWiO3338AhZjq11neRCuW.png)\n\n\nI have a question about my own code... after this:\n\n```typ\n#let outside(body) = context {\n  oc.step()\n  let ic = counter(\"inside/\" + str(oc.get().first()))\n```\n\nThe first time this is used, `ic` gets the counter called \"inside/0\", why doesn't it get number 1? `oc` has been stepped just on the line before..",
      "reply_to_post_number": 3,
      "reply_count": 2,
      "quote_count": 0,
      "like_count": 1,
      "reads": 22,
      "score": 29.4,
      "accepted_answer": false,
      "trust_level": 3,
      "user_id": 1272
    },
    {
      "id": 10545,
      "post_number": 5,
      "username": "Andrew",
      "name": "",
      "created_at": "2025-04-02T14:56:24.150Z",
      "updated_at": "2025-04-02T14:56:24.150Z",
      "cooked": "<aside class=\"quote no-group\" data-username=\"a_w\" data-post=\"3\" data-topic=\"3489\">\n<div class=\"title\">\n<div class=\"quote-controls\"></div>\n<img loading=\"lazy\" alt=\"\" width=\"24\" height=\"24\" src=\"https://forum.typst.app/user_avatar/forum.typst.app/a_w/48/1206_2.png\" class=\"avatar\"> a_w:</div>\n<blockquote>\n<p>So even the <code>#outside[#inside[</code> case is not detectable because, other than the content, there is nothing to check against. Am I seeing this right?</p>\n</blockquote>\n</aside>\n<p>Exactly.</p>\n<aside class=\"quote no-group\" data-username=\"a_w\" data-post=\"3\" data-topic=\"3489\">\n<div class=\"title\">\n<div class=\"quote-controls\"></div>\n<img loading=\"lazy\" alt=\"\" width=\"24\" height=\"24\" src=\"https://forum.typst.app/user_avatar/forum.typst.app/a_w/48/1206_2.png\" class=\"avatar\"> a_w:</div>\n<blockquote>\n<p>I‚Äôve just tried:</p>\n<pre data-code-wrap=\"typ\"><code class=\"lang-typ\">#outside[#inside[I'm blue]&lt;blue&gt; Da ba dee da ba di.]\n</code></pre>\n<p>as a workaround, but the sequence doesn‚Äôt seem to contain the label either.</p>\n</blockquote>\n</aside>\n<pre data-code-wrap=\"typ\"><code class=\"lang-typ\">#show &lt;blue&gt;: it =&gt; \"Blue is attached to \" + raw(repr(it), lang: \"typc\")\n\n#outside[#inside[I'm blue]&lt;blue&gt; Da ba dee da ba di.]\n</code></pre>\n<p><img src=\"https://forum.typst.app/uploads/default/original/2X/b/b4f347f862b75dd35c17de79f5ad098c354d0106.png\" alt=\"image\" data-base62-sha1=\"pOLaFzIiJxg0Tqyx6hBoK8Fm5zo\" width=\"688\" height=\"56\"></p>",
      "raw": "[quote=\"a_w, post:3, topic:3489\"]\nSo even the `#outside[#inside[` case is not detectable because, other than the content, there is nothing to check against. Am I seeing this right?\n[/quote]\n\nExactly.\n\n[quote=\"a_w, post:3, topic:3489\"]\nI've just tried:\n\n```typ\n#outside[#inside[I'm blue]<blue> Da ba dee da ba di.]\n```\n\nas a workaround, but the sequence doesn‚Äôt seem to contain the label either.\n[/quote]\n\n\n```typ\n#show <blue>: it => \"Blue is attached to \" + raw(repr(it), lang: \"typc\")\n\n#outside[#inside[I'm blue]<blue> Da ba dee da ba di.]\n```\n\n![image|688x56](upload://pOLaFzIiJxg0Tqyx6hBoK8Fm5zo.png)",
      "reply_to_post_number": 3,
      "reply_count": 0,
      "quote_count": 1,
      "like_count": 1,
      "reads": 21,
      "score": 19.2,
      "accepted_answer": false,
      "trust_level": 3,
      "user_id": 51
    },
    {
      "id": 10546,
      "post_number": 6,
      "username": "Andrew",
      "name": "",
      "created_at": "2025-04-02T15:02:21.030Z",
      "updated_at": "2025-04-02T15:02:21.030Z",
      "cooked": "<aside class=\"quote no-group\" data-username=\"bluss\" data-post=\"4\" data-topic=\"3489\">\n<div class=\"title\">\n<div class=\"quote-controls\"></div>\n<img loading=\"lazy\" alt=\"\" width=\"24\" height=\"24\" src=\"https://forum.typst.app/letter_avatar_proxy/v4/letter/b/441A5E/48.png\" class=\"avatar\"> bluss:</div>\n<blockquote>\n<p>I have a question about my own code‚Ä¶ after this:</p>\n<pre data-code-wrap=\"typ\"><code class=\"lang-typ\">#let outside(body) = context {\n  oc.step()\n  let ic = counter(\"inside/\" + str(oc.get().first()))\n</code></pre>\n<p>The first time this is used, <code>ic</code> gets the counter called ‚Äúinside/0‚Äù, why doesn‚Äôt it get number 1? <code>oc</code> has been stepped just on the line before‚Ä¶</p>\n</blockquote>\n</aside>\n<p>The <code>.get()</code> call is called within a <code>context</code>, and the context starts with counter set to 0. For <code>.get()</code> to see a <code>.step()</code>, they need to be separated by <code>context</code>:</p>\n<pre data-code-wrap=\"typ\"><code class=\"lang-typ\">#let outside(body) = {\n  oc.step()\n  context {\n      let ic = counter(\"inside/\" + str(oc.get().first()))\n</code></pre>\n<p>P.S. The forum is English-oriented, so writing (or leaving) Ë©≥Á¥∞ in a message is confusing unless you‚Äôre Êó•Êú¨Ë™û‰∏äÊâã.</p>",
      "raw": "[quote=\"bluss, post:4, topic:3489\"]\nI have a question about my own code‚Ä¶ after this:\n\n```typ\n#let outside(body) = context {\n  oc.step()\n  let ic = counter(\"inside/\" + str(oc.get().first()))\n```\n\nThe first time this is used, `ic` gets the counter called ‚Äúinside/0‚Äù, why doesn‚Äôt it get number 1? `oc` has been stepped just on the line before‚Ä¶\n[/quote]\n\nThe `.get()` call is called within a `context`, and the context starts with counter set to 0. For `.get()` to see a `.step()`, they need to be separated by `context`:\n\n```typ\n#let outside(body) = {\n  oc.step()\n  context {\n      let ic = counter(\"inside/\" + str(oc.get().first()))\n```\n\nP.S. The forum is English-oriented, so writing (or leaving) Ë©≥Á¥∞ in a message is confusing unless you're Êó•Êú¨Ë™û‰∏äÊâã.",
      "reply_to_post_number": 4,
      "reply_count": 2,
      "quote_count": 1,
      "like_count": 1,
      "reads": 21,
      "score": 29.2,
      "accepted_answer": false,
      "trust_level": 3,
      "user_id": 51
    },
    {
      "id": 10547,
      "post_number": 7,
      "username": "bluss",
      "name": "Ulrik",
      "created_at": "2025-04-02T15:06:47.492Z",
      "updated_at": "2025-04-02T15:06:47.492Z",
      "cooked": "<p>Ah, thanks for the reminder, makes sense!</p>\n<aside class=\"quote no-group\" data-username=\"Andrew\" data-post=\"6\" data-topic=\"3489\">\n<div class=\"title\">\n<div class=\"quote-controls\"></div>\n<img loading=\"lazy\" alt=\"\" width=\"24\" height=\"24\" src=\"https://forum.typst.app/user_avatar/forum.typst.app/andrew/48/62_2.png\" class=\"avatar\"> Andrew:</div>\n<blockquote>\n<p>P.S. The forum is English-oriented, so writing (or leaving) Ë©≥Á¥∞ in a message is confusing unless you‚Äôre Êó•Êú¨Ë™û‰∏äÊâã.</p>\n</blockquote>\n</aside>\n<p>This part I don‚Äôt understand, I don‚Äôt think that can be related to anything I‚Äôve written on the forum.</p>",
      "raw": "Ah, thanks for the reminder, makes sense!\n\n[quote=\"Andrew, post:6, topic:3489\"]\nP.S. The forum is English-oriented, so writing (or leaving) Ë©≥Á¥∞ in a message is confusing unless you‚Äôre Êó•Êú¨Ë™û‰∏äÊâã.\n[/quote]\n\nThis part I don't understand, I don't think that can be related to anything I've written on the forum.",
      "reply_to_post_number": 6,
      "reply_count": 0,
      "quote_count": 1,
      "like_count": 0,
      "reads": 21,
      "score": 4.2,
      "accepted_answer": false,
      "trust_level": 3,
      "user_id": 1272
    },
    {
      "id": 10549,
      "post_number": 8,
      "username": "bluss",
      "name": "Ulrik",
      "created_at": "2025-04-02T15:11:29.406Z",
      "updated_at": "2025-04-02T15:12:12.530Z",
      "cooked": "<aside class=\"quote no-group\" data-username=\"Andrew\" data-post=\"6\" data-topic=\"3489\">\n<div class=\"title\">\n<div class=\"quote-controls\"></div>\n<img loading=\"lazy\" alt=\"\" width=\"24\" height=\"24\" src=\"https://forum.typst.app/user_avatar/forum.typst.app/andrew/48/62_2.png\" class=\"avatar\"> Andrew:</div>\n<blockquote>\n<p>P.S. The forum is English-oriented, so writing (or leaving) Ë©≥Á¥∞ in a message is confusing unless you‚Äôre Êó•Êú¨Ë™û‰∏äÊâã.</p>\n</blockquote>\n</aside>\n<p>I have google translated your message, and I think I understand now.</p>\n<p>I used a HTML <code>&lt;details&gt;</code> tag in my message. It‚Äôs localized by your web browser. I see it in Swedish, hence your Japanese (I think) was very confusing to me. So yeah, we see different things. And yeah, it‚Äôs not me who decides how it‚Äôs displayed.</p>\n<p><img src=\"https://forum.typst.app/uploads/default/original/2X/7/72b01926640d9f23c38bd7d5549ae23b1941cae1.png\" alt=\"bild\" data-base62-sha1=\"gmzIF7tewHtmYvWfMFm4Dg820b7\" width=\"239\" height=\"159\"></p>",
      "raw": "[quote=\"Andrew, post:6, topic:3489\"]\nP.S. The forum is English-oriented, so writing (or leaving) Ë©≥Á¥∞ in a message is confusing unless you‚Äôre Êó•Êú¨Ë™û‰∏äÊâã.\n[/quote]\n\nI have google translated your message, and I think I understand now.\n\nI used a HTML `<details>` tag in my message. It's localized by your web browser. I see it in Swedish, hence your Japanese (I think) was very confusing to me. So yeah, we see different things. And yeah, it's not me who decides how it's displayed.\n\n\n![bild|239x159](upload://gmzIF7tewHtmYvWfMFm4Dg820b7.png)",
      "reply_to_post_number": 6,
      "reply_count": 1,
      "quote_count": 1,
      "like_count": 1,
      "reads": 20,
      "score": 24.0,
      "accepted_answer": false,
      "trust_level": 3,
      "user_id": 1272
    },
    {
      "id": 10550,
      "post_number": 9,
      "username": "Andrew",
      "name": "",
      "created_at": "2025-04-02T15:19:04.269Z",
      "updated_at": "2025-04-02T15:21:23.378Z",
      "cooked": "<aside class=\"quote no-group\" data-username=\"bluss\" data-post=\"8\" data-topic=\"3489\">\n<div class=\"title\">\n<div class=\"quote-controls\"></div>\n<img loading=\"lazy\" alt=\"\" width=\"24\" height=\"24\" src=\"https://forum.typst.app/letter_avatar_proxy/v4/letter/b/441A5E/48.png\" class=\"avatar\"> bluss:</div>\n<blockquote>\n<p>I used a HTML <code>&lt;details&gt;</code> tag in my message. It‚Äôs localized by your web browser. I see it in Swedish, hence your Japanese (I think) was very confusing to me.</p>\n</blockquote>\n</aside>\n<p>See, reading the message in English and then see one small part in localized language is confusing either way (if it‚Äôs not English).</p>\n<p>In any case, ‚Äúdetails‚Äù is not descriptive, so you should provide the summary of what you hide.</p>\n<pre data-code-wrap=\"md\"><code class=\"lang-md\">&lt;details&gt;&lt;summary&gt;the summary&lt;/summary&gt;\n\n```typ\nstuff\n```\n\n&lt;/details&gt;\n</code></pre>\n<p>or</p>\n<pre data-code-wrap=\"md\"><code class=\"lang-md\">[details=\"Summary\"]\nThis text will be hidden\n[/details]\n</code></pre>\n<p>Which is an option in the dropdown menu in the editor (to not write it manually).</p>",
      "raw": "[quote=\"bluss, post:8, topic:3489\"]\nI used a HTML `<details>` tag in my message. It‚Äôs localized by your web browser. I see it in Swedish, hence your Japanese (I think) was very confusing to me.\n[/quote]\n\nSee, reading the message in English and then see one small part in localized language is confusing either way (if it's not English).\n\nIn any case, \"details\" is not descriptive, so you should provide the summary of what you hide.\n\n````md\n<details><summary>the summary</summary>\n\n```typ\nstuff\n```\n\n</details>\n````\n\nor\n\n```md\n[details=\"Summary\"]\nThis text will be hidden\n[/details]\n```\n\nWhich is an option in the dropdown menu in the editor (to not write it manually).",
      "reply_to_post_number": 8,
      "reply_count": 0,
      "quote_count": 1,
      "like_count": 0,
      "reads": 21,
      "score": 4.2,
      "accepted_answer": false,
      "trust_level": 3,
      "user_id": 51
    },
    {
      "id": 10551,
      "post_number": 10,
      "username": "a_w",
      "name": "Alex",
      "created_at": "2025-04-02T15:25:14.168Z",
      "updated_at": "2025-04-02T15:27:34.550Z",
      "cooked": "<p>Nice, very creative approach! <img src=\"https://forum.typst.app/images/emoji/apple/clap/2.png?v=12\" title=\":clap:t2:\" class=\"emoji\" alt=\":clap:t2:\" loading=\"lazy\" width=\"20\" height=\"20\"></p>\n<p>There is currently a pull request on the way for <code>.within</code> so hopefully both of these cases will have non-hacky solution soon.</p>",
      "raw": "Nice, very creative approach! üëèüèª\n\nThere is currently a pull request on the way for `.within` so hopefully both of these cases will have non-hacky solution soon.",
      "reply_to_post_number": 4,
      "reply_count": 0,
      "quote_count": 0,
      "like_count": 1,
      "reads": 20,
      "score": 19.0,
      "accepted_answer": false,
      "trust_level": 2,
      "user_id": 566
    }
  ],
  "scraped_at": "2025-06-10T09:49:48.167118"
}