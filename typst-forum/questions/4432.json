{
  "topic_metadata": {
    "id": 4432,
    "title": "How do i get the line length of the last line in a paragraph?",
    "slug": "how-do-i-get-the-line-length-of-the-last-line-in-a-paragraph",
    "posts_count": 18,
    "created_at": "2025-06-02T11:18:23.370Z",
    "last_posted_at": "2025-06-06T15:02:37.528Z",
    "views": 129,
    "like_count": 3,
    "reply_count": 16,
    "has_accepted_answer": true,
    "accepted_answer_post_number": 2,
    "accepted_answer_username": "sijo",
    "tags": [
      "scripting"
    ],
    "category_id": 5,
    "participant_count": 4,
    "word_count": 989
  },
  "posts": [
    {
      "id": 13575,
      "post_number": 1,
      "username": "Junot",
      "name": "Junot",
      "created_at": "2025-06-02T11:18:23.455Z",
      "updated_at": "2025-06-03T11:41:54.255Z",
      "cooked": "<p>I’m looking to make a function that draws a line, beginning from the last word in a paragraph until the end of the page (minus margin ofcourse). I tried looping over the width of the paragraph while subtracting the page width but that’s not ideal because if I’m not wrong Typst puts all the words next to eachother while measuring width. Another idea is placing an invisible marker at the end of the paragraph and measuring from there but I don’t know how to implement that.</p>\n<p>Does anyone have an idea or a reference to the right docs? Thanks!</p>",
      "raw": "I'm looking to make a function that draws a line, beginning from the last word in a paragraph until the end of the page (minus margin ofcourse). I tried looping over the width of the paragraph while subtracting the page width but that's not ideal because if I'm not wrong Typst puts all the words next to eachother while measuring width. Another idea is placing an invisible marker at the end of the paragraph and measuring from there but I don't know how to implement that.\n\nDoes anyone have an idea or a reference to the right docs? Thanks!",
      "reply_to_post_number": null,
      "reply_count": 0,
      "quote_count": 0,
      "like_count": 0,
      "reads": 30,
      "score": 30.0,
      "accepted_answer": false,
      "trust_level": 1,
      "user_id": 1636
    },
    {
      "id": 13578,
      "post_number": 2,
      "username": "sijo",
      "name": "",
      "created_at": "2025-06-02T12:19:55.480Z",
      "updated_at": "2025-06-02T12:20:24.483Z",
      "cooked": "<p>For a line to margin, you can make a box that occupies the remaining space using <code>box(width: 1fr, ...)</code>. Here are several ways to get a line using this box:</p>\n<pre data-code-wrap=\"typ\"><code class=\"lang-typ\">#set page(margin: 3cm)\n\n#lorem(100)\n#box(width: 1fr, line(length: 100%))\n\n#lorem(100)\n#box(width: 1fr, stroke: (top: 1pt))\n\n// Quality of result will depend on PDF reader and font\n#lorem(100)\n#box(width: 1fr, repeat[─])\n</code></pre>",
      "raw": "For a line to margin, you can make a box that occupies the remaining space using `box(width: 1fr, ...)`. Here are several ways to get a line using this box:\n\n```\n#set page(margin: 3cm)\n\n#lorem(100)\n#box(width: 1fr, line(length: 100%))\n\n#lorem(100)\n#box(width: 1fr, stroke: (top: 1pt))\n\n// Quality of result will depend on PDF reader and font\n#lorem(100)\n#box(width: 1fr, repeat[─])\n```",
      "reply_to_post_number": null,
      "reply_count": 2,
      "quote_count": 0,
      "like_count": 1,
      "reads": 30,
      "score": 30.0,
      "accepted_answer": true,
      "trust_level": 3,
      "user_id": 332
    },
    {
      "id": 13632,
      "post_number": 3,
      "username": "Junot",
      "name": "Junot",
      "created_at": "2025-06-03T11:25:13.706Z",
      "updated_at": "2025-06-03T11:25:13.706Z",
      "cooked": "<p>Thanks, i didn’t realize it was this simple :)</p>",
      "raw": "Thanks, i didn't realize it was this simple :)",
      "reply_to_post_number": 2,
      "reply_count": 0,
      "quote_count": 0,
      "like_count": 0,
      "reads": 28,
      "score": 4.8,
      "accepted_answer": false,
      "trust_level": 1,
      "user_id": 1636
    },
    {
      "id": 13633,
      "post_number": 4,
      "username": "Junot",
      "name": "Junot",
      "created_at": "2025-06-03T11:31:07.076Z",
      "updated_at": "2025-06-03T11:31:07.076Z",
      "cooked": "<p>Adjacent, to this, do you maybe know how to apply this to headings? When i try to set a show rule for headings it just draws the line underneath the heading title.</p>",
      "raw": "Adjacent, to this, do you maybe know how to apply this to headings? When i try to set a show rule for headings it just draws the line underneath the heading title.",
      "reply_to_post_number": 2,
      "reply_count": 1,
      "quote_count": 0,
      "like_count": 0,
      "reads": 28,
      "score": 9.8,
      "accepted_answer": false,
      "trust_level": 1,
      "user_id": 1636
    },
    {
      "id": 13635,
      "post_number": 5,
      "username": "sijo",
      "name": "",
      "created_at": "2025-06-03T12:02:54.514Z",
      "updated_at": "2025-06-03T12:02:54.514Z",
      "cooked": "<p>By default, a heading is in a block element, and if you add a box after a block it will come below. You can solve this by wrapping the heading in a box:</p>\n<pre data-code-wrap=\"typ\"><code class=\"lang-typ\">#show heading: it =&gt; box(it) + box(width: 1fr, line(length: 100%))\n</code></pre>",
      "raw": "By default, a heading is in a block element, and if you add a box after a block it will come below. You can solve this by wrapping the heading in a box:\n\n```\n#show heading: it => box(it) + box(width: 1fr, line(length: 100%))\n```",
      "reply_to_post_number": 4,
      "reply_count": 1,
      "quote_count": 0,
      "like_count": 0,
      "reads": 27,
      "score": 14.8,
      "accepted_answer": false,
      "trust_level": 3,
      "user_id": 332
    },
    {
      "id": 13637,
      "post_number": 6,
      "username": "Junot",
      "name": "Junot",
      "created_at": "2025-06-03T12:32:53.287Z",
      "updated_at": "2025-06-03T12:32:53.287Z",
      "cooked": "<p>I tried that but it seems that the heading then gets handled like a table or grid with two columns, so the line doesn’t span after the last word (given that the heading is more than 1 line long) but in the next “column”. I don’t now how to achieve the line like in regular text (like you provided).</p>",
      "raw": "I tried that but it seems that the heading then gets handled like a table or grid with two columns, so the line doesn't span after the last word (given that the heading is more than 1 line long) but in the next \"column\". I don't now how to achieve the line like in regular text (like you provided).",
      "reply_to_post_number": 5,
      "reply_count": 1,
      "quote_count": 0,
      "like_count": 0,
      "reads": 26,
      "score": 9.6,
      "accepted_answer": false,
      "trust_level": 1,
      "user_id": 1636
    },
    {
      "id": 13647,
      "post_number": 7,
      "username": "sijo",
      "name": "",
      "created_at": "2025-06-03T17:17:45.219Z",
      "updated_at": "2025-06-03T18:12:53.132Z",
      "cooked": "<p>Ah right, then you need something like</p>\n<pre data-code-wrap=\"typ\"><code class=\"lang-typ\">#show heading: it =&gt; block({\n  if it.numbering != none {\n    counter(heading).display(it.numbering) + \" \"\n  } \n  it.body\n  box(width: 1fr, line(length: 100%))\n})\n</code></pre>\n<p>The problem is that this doesn’t return a heading, so it could prevent some rules on headings (higher up in the document) from being applied. So make sure to put this rule at the top. Or make it return a new heading, but then you’d need a trick to avoid recursion and spurious counter increments.</p>",
      "raw": "Ah right, then you need something like\n\n```\n#show heading: it => block({\n  if it.numbering != none {\n    counter(heading).display(it.numbering) + \" \"\n  } \n  it.body\n  box(width: 1fr, line(length: 100%))\n})\n```\n\nThe problem is that this doesn't return a heading, so it could prevent some rules on headings (higher up in the document) from being applied. So make sure to put this rule at the top. Or make it return a new heading, but then you'd need a trick to avoid recursion and spurious counter increments.",
      "reply_to_post_number": 6,
      "reply_count": 3,
      "quote_count": 0,
      "like_count": 1,
      "reads": 25,
      "score": 34.4,
      "accepted_answer": false,
      "trust_level": 3,
      "user_id": 332
    },
    {
      "id": 13687,
      "post_number": 8,
      "username": "Junot",
      "name": "Junot",
      "created_at": "2025-06-04T12:40:54.930Z",
      "updated_at": "2025-06-04T12:40:54.930Z",
      "cooked": "<p>Thanks, adding to that I put the counter and remaining “heading” in a grid to keep the text after the numbering when the heading goes onto the next line.<br>\nHowever the text’s spacing is a little bit weird and I don’t see why that is, it now spans the text over the entire page sometimes with huge gaps. Do you maybe now the reason? I added a picture to clarify.<br>\n<div class=\"lightbox-wrapper\"><a class=\"lightbox\" href=\"https://forum.typst.app/uploads/default/original/2X/3/31d77e7898493c1560f1bd343d33a4f8a4088a60.png\" data-download-href=\"https://forum.typst.app/uploads/default/31d77e7898493c1560f1bd343d33a4f8a4088a60\" title=\"Screenshot_2025-06-04_14-40-34\"><img src=\"https://forum.typst.app/uploads/default/optimized/2X/3/31d77e7898493c1560f1bd343d33a4f8a4088a60_2_690x306.png\" alt=\"Screenshot_2025-06-04_14-40-34\" data-base62-sha1=\"76V5zubcDJqmklXokfaqu9fpvP2\" width=\"690\" height=\"306\" srcset=\"https://forum.typst.app/uploads/default/optimized/2X/3/31d77e7898493c1560f1bd343d33a4f8a4088a60_2_690x306.png, https://forum.typst.app/uploads/default/optimized/2X/3/31d77e7898493c1560f1bd343d33a4f8a4088a60_2_1035x459.png 1.5x, https://forum.typst.app/uploads/default/optimized/2X/3/31d77e7898493c1560f1bd343d33a4f8a4088a60_2_1380x612.png 2x\" data-dominant-color=\"F6F6F6\"><div class=\"meta\"><svg class=\"fa d-icon d-icon-far-image svg-icon\" aria-hidden=\"true\"><use href=\"#far-image\"></use></svg><span class=\"filename\">Screenshot_2025-06-04_14-40-34</span><span class=\"informations\">1407×626 74.5 KB</span><svg class=\"fa d-icon d-icon-discourse-expand svg-icon\" aria-hidden=\"true\"><use href=\"#discourse-expand\"></use></svg></div></a></div></p>",
      "raw": "Thanks, adding to that I put the counter and remaining \"heading\" in a grid to keep the text after the numbering when the heading goes onto the next line.\nHowever the text's spacing is a little bit weird and I don't see why that is, it now spans the text over the entire page sometimes with huge gaps. Do you maybe now the reason? I added a picture to clarify.\n![Screenshot_2025-06-04_14-40-34|690x306](upload://76V5zubcDJqmklXokfaqu9fpvP2.png)",
      "reply_to_post_number": 7,
      "reply_count": 1,
      "quote_count": 0,
      "like_count": 0,
      "reads": 23,
      "score": 14.0,
      "accepted_answer": false,
      "trust_level": 1,
      "user_id": 1636
    },
    {
      "id": 13692,
      "post_number": 9,
      "username": "flokl",
      "name": "",
      "created_at": "2025-06-04T14:24:15.751Z",
      "updated_at": "2025-06-04T14:24:15.751Z",
      "cooked": "<p>This seems to be due to text justification. If you use <code>it.body</code> Typst interprets it as a paragraph (see <a href=\"https://typst.app/docs/reference/model/par/\">documentation</a>) and it is affected by the paragraph’s text justification rule. To fix your issue, you have to disable justification inside the heading show rule and optionally enable hyphenation.</p>",
      "raw": "This seems to be due to text justification. If you use `it.body` Typst interprets it as a paragraph (see [documentation](https://typst.app/docs/reference/model/par/)) and it is affected by the paragraph's text justification rule. To fix your issue, you have to disable justification inside the heading show rule and optionally enable hyphenation.",
      "reply_to_post_number": 8,
      "reply_count": 1,
      "quote_count": 0,
      "like_count": 1,
      "reads": 22,
      "score": 23.8,
      "accepted_answer": false,
      "trust_level": 3,
      "user_id": 8
    },
    {
      "id": 13695,
      "post_number": 10,
      "username": "Junot",
      "name": "Junot",
      "created_at": "2025-06-04T16:45:29.425Z",
      "updated_at": "2025-06-04T16:45:29.425Z",
      "cooked": "<p>That indeed works, i tried this but i didn’t put it inside the show rule. Thanks!</p>",
      "raw": "That indeed works, i tried this but i didn't put it inside the show rule. Thanks!",
      "reply_to_post_number": 9,
      "reply_count": 0,
      "quote_count": 0,
      "like_count": 0,
      "reads": 21,
      "score": 3.6,
      "accepted_answer": false,
      "trust_level": 1,
      "user_id": 1636
    },
    {
      "id": 13761,
      "post_number": 11,
      "username": "Andrew",
      "name": "",
      "created_at": "2025-06-05T14:17:20.398Z",
      "updated_at": "2025-06-05T14:17:20.398Z",
      "cooked": "<p>The spacing between numbering and body should be <a href=\"https://github.com/typst/typst/blob/494e6a64225261add59c3c9b1cd923bfdfa77961/crates/typst-library/src/model/heading.rs?plain=1#L223\"><code>0.3em</code></a>.</p>",
      "raw": "The spacing between numbering and body should be [`0.3em`](https://github.com/typst/typst/blob/494e6a64225261add59c3c9b1cd923bfdfa77961/crates/typst-library/src/model/heading.rs?plain=1#L223).",
      "reply_to_post_number": 7,
      "reply_count": 0,
      "quote_count": 0,
      "like_count": 0,
      "reads": 21,
      "score": 3.6,
      "accepted_answer": false,
      "trust_level": 3,
      "user_id": 51
    },
    {
      "id": 13762,
      "post_number": 12,
      "username": "Andrew",
      "name": "",
      "created_at": "2025-06-05T14:23:01.740Z",
      "updated_at": "2025-06-05T14:23:01.740Z",
      "cooked": "<aside class=\"quote no-group\" data-username=\"sijo\" data-post=\"7\" data-topic=\"4432\">\n<div class=\"title\">\n<div class=\"quote-controls\"></div>\n<img alt=\"\" width=\"24\" height=\"24\" src=\"https://forum.typst.app/letter_avatar_proxy/v4/letter/s/0A3649/48.png\" class=\"avatar\"> sijo:</div>\n<blockquote>\n<p>The problem is that this doesn’t return a heading, so it could prevent some rules on headings (higher up in the document) from being applied.</p>\n</blockquote>\n</aside>\n<p>Which rules?</p>\n<pre data-code-wrap=\"typ\"><code class=\"lang-typ\">#show heading: set text(15pt)\n#show heading: set block(spacing: 5pt)\n\n#show heading: it =&gt; block({\n  if it.numbering != none { counter(heading).display(it.numbering) + h(0.3em) }\n  it.body\n  box(width: 1fr, line(length: 100%))\n})\n\n= Heading\n\n#set heading(numbering: \"1.\")\n\n= Heading\n</code></pre>",
      "raw": "[quote=\"sijo, post:7, topic:4432\"]\nThe problem is that this doesn’t return a heading, so it could prevent some rules on headings (higher up in the document) from being applied.\n[/quote]\n\nWhich rules?\n\n```typ\n#show heading: set text(15pt)\n#show heading: set block(spacing: 5pt)\n\n#show heading: it => block({\n  if it.numbering != none { counter(heading).display(it.numbering) + h(0.3em) }\n  it.body\n  box(width: 1fr, line(length: 100%))\n})\n\n= Heading\n\n#set heading(numbering: \"1.\")\n\n= Heading\n```",
      "reply_to_post_number": 7,
      "reply_count": 1,
      "quote_count": 1,
      "like_count": 0,
      "reads": 21,
      "score": 8.6,
      "accepted_answer": false,
      "trust_level": 3,
      "user_id": 51
    },
    {
      "id": 13769,
      "post_number": 13,
      "username": "sijo",
      "name": "",
      "created_at": "2025-06-05T15:18:36.227Z",
      "updated_at": "2025-06-05T15:18:57.454Z",
      "cooked": "<p>Show-it rules as in <code>#show heading: it =&gt; ...</code></p>\n<p>For example</p>\n<pre data-code-wrap=\"typ\"><code class=\"lang-typ\">// Doesn't work because of the next rule below\n#show heading: it =&gt; block(stroke: red, it)\n\n#show heading: it =&gt; block({\n  if it.numbering != none { counter(heading).display(it.numbering) + h(0.3em) }\n  it.body\n  box(width: 1fr, line(length: 100%))\n})\n\n= Heading\n\n#set heading(numbering: \"1.\")\n\n= Heading\n</code></pre>",
      "raw": "Show-it rules as in `#show heading: it => ...`\n\nFor example\n\n```\n// Doesn't work because of the next rule below\n#show heading: it => block(stroke: red, it)\n\n#show heading: it => block({\n  if it.numbering != none { counter(heading).display(it.numbering) + h(0.3em) }\n  it.body\n  box(width: 1fr, line(length: 100%))\n})\n\n= Heading\n\n#set heading(numbering: \"1.\")\n\n= Heading\n```",
      "reply_to_post_number": 12,
      "reply_count": 1,
      "quote_count": 0,
      "like_count": 0,
      "reads": 21,
      "score": 8.4,
      "accepted_answer": false,
      "trust_level": 3,
      "user_id": 332
    },
    {
      "id": 13797,
      "post_number": 14,
      "username": "Andrew",
      "name": "",
      "created_at": "2025-06-05T22:50:35.309Z",
      "updated_at": "2025-06-05T22:50:35.309Z",
      "cooked": "<p>Oh, yeah, other show rules won’t work when you have a destructive show rule/re-implementation of an element. But, generally speaking, you won’t have 2 show rules for the same thing in the first place. Only if you add state or metadata, that is.</p>\n<p>Destructuring show rul<strong>e</strong> go first, the rest goes after.</p>",
      "raw": "Oh, yeah, other show rules won't work when you have a destructive show rule/re-implementation of an element. But, generally speaking, you won't have 2 show rules for the same thing in the first place. Only if you add state or metadata, that is.\n\nDestructuring show rul**e** go first, the rest goes after.",
      "reply_to_post_number": 13,
      "reply_count": 1,
      "quote_count": 0,
      "like_count": 0,
      "reads": 21,
      "score": 8.4,
      "accepted_answer": false,
      "trust_level": 3,
      "user_id": 51
    },
    {
      "id": 13809,
      "post_number": 15,
      "username": "sijo",
      "name": "",
      "created_at": "2025-06-06T09:25:30.195Z",
      "updated_at": "2025-06-06T09:25:59.304Z",
      "cooked": "<aside class=\"quote no-group\" data-username=\"Andrew\" data-post=\"14\" data-topic=\"4432\">\n<div class=\"title\">\n<div class=\"quote-controls\"></div>\n<img alt=\"\" width=\"24\" height=\"24\" src=\"https://forum.typst.app/user_avatar/forum.typst.app/andrew/48/62_2.png\" class=\"avatar\"> Andrew:</div>\n<blockquote>\n<p>But, generally speaking, you won’t have 2 show rules for the same thing in the first place.</p>\n</blockquote>\n</aside>\n<p>You might have rules with different selectors that match the same element, or beside your custom rules you might also use a template that applies some show-it rules…</p>",
      "raw": "[quote=\"Andrew, post:14, topic:4432\"]\nBut, generally speaking, you won’t have 2 show rules for the same thing in the first place.\n[/quote]\n\nYou might have rules with different selectors that match the same element, or beside your custom rules you might also use a template that applies some show-it rules...",
      "reply_to_post_number": 14,
      "reply_count": 1,
      "quote_count": 1,
      "like_count": 0,
      "reads": 19,
      "score": 8.0,
      "accepted_answer": false,
      "trust_level": 3,
      "user_id": 332
    },
    {
      "id": 13814,
      "post_number": 16,
      "username": "Andrew",
      "name": "",
      "created_at": "2025-06-06T13:47:33.104Z",
      "updated_at": "2025-06-06T13:47:33.104Z",
      "cooked": "<aside class=\"quote no-group\" data-username=\"sijo\" data-post=\"15\" data-topic=\"4432\">\n<div class=\"title\">\n<div class=\"quote-controls\"></div>\n<img alt=\"\" width=\"24\" height=\"24\" src=\"https://forum.typst.app/letter_avatar_proxy/v4/letter/s/0A3649/48.png\" class=\"avatar\"> sijo:</div>\n<blockquote>\n<p>beside your custom rules you might also use a template that applies some show-it rules</p>\n</blockquote>\n</aside>\n<p>If a template function exists, then all rules would be in there, as is best practice. Sometimes it’s better to merge 2 show rules, if they exist, removing the potential loss of styling.</p>",
      "raw": "[quote=\"sijo, post:15, topic:4432\"]\nbeside your custom rules you might also use a template that applies some show-it rules\n[/quote]\n\nIf a template function exists, then all rules would be in there, as is best practice. Sometimes it's better to merge 2 show rules, if they exist, removing the potential loss of styling.",
      "reply_to_post_number": 15,
      "reply_count": 1,
      "quote_count": 1,
      "like_count": 0,
      "reads": 17,
      "score": 7.4,
      "accepted_answer": false,
      "trust_level": 3,
      "user_id": 51
    },
    {
      "id": 13820,
      "post_number": 17,
      "username": "sijo",
      "name": "",
      "created_at": "2025-06-06T14:34:24.002Z",
      "updated_at": "2025-06-06T14:37:36.579Z",
      "cooked": "<blockquote>\n<p>If a template function exists, then all rules would be in there, as is best practice.</p>\n</blockquote>\n<p>I disagree, it’s quite common to apply a template from a package and also add some personal show rules (without making a new “merged” template). There’s nothing wrong with that…</p>\n<p>And there’s yet another case when you need multiple show-it rules and must be careful: when you have a rule at the global scope, and one inside of another show rule. For example</p>\n<pre data-code-wrap=\"typ\"><code class=\"lang-typ\">#show outline: it =&gt; {\n  show heading: x =&gt; ...\n  it\n}\n</code></pre>",
      "raw": "> If a template function exists, then all rules would be in there, as is best practice.\n\nI disagree, it's quite common to apply a template from a package and also add some personal show rules (without making a new \"merged\" template). There's nothing wrong with that...\n\nAnd there's yet another case when you need multiple show-it rules and must be careful: when you have a rule at the global scope, and one inside of another show rule. For example\n\n```\n#show outline: it => {\n  show heading: x => ...\n  it\n}\n```",
      "reply_to_post_number": 16,
      "reply_count": 1,
      "quote_count": 0,
      "like_count": 0,
      "reads": 16,
      "score": 7.2,
      "accepted_answer": false,
      "trust_level": 3,
      "user_id": 332
    },
    {
      "id": 13822,
      "post_number": 18,
      "username": "Andrew",
      "name": "",
      "created_at": "2025-06-06T15:02:37.528Z",
      "updated_at": "2025-06-06T15:02:37.528Z",
      "cooked": "<aside class=\"quote no-group\" data-username=\"sijo\" data-post=\"17\" data-topic=\"4432\">\n<div class=\"title\">\n<div class=\"quote-controls\"></div>\n<img alt=\"\" width=\"24\" height=\"24\" src=\"https://forum.typst.app/letter_avatar_proxy/v4/letter/s/0A3649/48.png\" class=\"avatar\"> sijo:</div>\n<blockquote>\n<p>I disagree</p>\n</blockquote>\n</aside>\n<p>Assuming it’s all yours, no package.</p>",
      "raw": "[quote=\"sijo, post:17, topic:4432\"]\nI disagree\n[/quote]\n\nAssuming it's all yours, no package.",
      "reply_to_post_number": 17,
      "reply_count": 0,
      "quote_count": 1,
      "like_count": 0,
      "reads": 16,
      "score": 2.0,
      "accepted_answer": false,
      "trust_level": 3,
      "user_id": 51
    }
  ],
  "scraped_at": "2025-06-10T09:46:51.675364"
}