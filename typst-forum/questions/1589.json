{
  "topic_metadata": {
    "id": 1589,
    "title": "How to suppress space between affiliation superscript name and comma in custom template?",
    "slug": "how-to-suppress-space-between-affiliation-superscript-name-and-comma-in-custom-template",
    "posts_count": 10,
    "created_at": "2024-11-07T12:31:19.406Z",
    "last_posted_at": "2024-11-08T23:34:23.499Z",
    "views": 122,
    "like_count": 3,
    "reply_count": 5,
    "has_accepted_answer": true,
    "accepted_answer_post_number": 6,
    "accepted_answer_username": "flokl",
    "tags": [
      "text-formatting"
    ],
    "category_id": 5,
    "participant_count": 4,
    "word_count": 857
  },
  "posts": [
    {
      "id": 5256,
      "post_number": 1,
      "username": "danborek",
      "name": "danborek",
      "created_at": "2024-11-07T12:31:19.546Z",
      "updated_at": "2024-11-08T23:34:00.705Z",
      "cooked": "<p>I am using typst 0.11 (template need to work where I cannot update dist just now)<br>\nI have following code</p>\n<pre data-code-wrap=\"typst\"><code class=\"lang-typst\">#let titleblock(body, size: 1.2em) = [\n  #align(center)[\n    #text(size: size)[#body]\n  ]\n]\n\n#let minimal-preprint(\n  title: none,\n  authors: (),\n  affiliations: none,\n) = {\n  // Format author strings\n  let author_strings = ()\n  \n  if authors != none {\n    for a in authors {\n      // Create basic author string with name and affiliation\n      let author_string = [\n        #box[#a.name]\n        #if authors.len() &gt; 1 [#super[#a.affiliation]]\n        #if a.keys().contains(\"email\") { [\\*] }\n      ]\n      author_strings.push(author_string)\n    }\n  }\n\n  // Display title\n  if title != none {\n    titleblock(title)\n  }\n\n  // Display authors with formatting\n  if authors != none {\n    titleblock(\n      [#author_strings.join(\", \", last: \" &amp; \")],\n      size: 1em\n    )\n  }\n\n  // Display affiliations\n  if affiliations != none {\n    titleblock(\n      for a in affiliations [\n        #if authors.len() &gt; 1 [#super[#a.id]]#a.name \\\n      ],\n      size: 0.9em\n    )\n  }\n}\n\n// Example usage\n#show: doc =&gt; minimal-preprint(\n  title: [Sample Paper Title],\n  authors: (\n    (name: [John Smith], affiliation: [1] ),\n    (name: [Jane Doe], affiliation: [1]),\n    (name: [Jane Doe], affiliation: [1], email: [john@example.com])\n  ),\n  affiliations: ((id: \"1\", name: \"Example University\"),),\n)\n</code></pre>\n<p><img src=\"https://forum.typst.app/uploads/default/original/2X/4/481517e8f5e7acb1d542ec9363484495cde3f7ef.png\" alt=\"image\" data-base62-sha1=\"ahFzm7kha2Fb11ZqMWSKJIzLx83\" width=\"433\" height=\"174\"></p>\n<p>It give me too much space after superscript with affiliation (before comma), how I can fix it?</p>",
      "raw": "I am using typst 0.11 (template need to work where I cannot update dist just now)\nI have following code \n\n```typst\n#let titleblock(body, size: 1.2em) = [\n  #align(center)[\n    #text(size: size)[#body]\n  ]\n]\n\n#let minimal-preprint(\n  title: none,\n  authors: (),\n  affiliations: none,\n) = {\n  // Format author strings\n  let author_strings = ()\n  \n  if authors != none {\n    for a in authors {\n      // Create basic author string with name and affiliation\n      let author_string = [\n        #box[#a.name]\n        #if authors.len() > 1 [#super[#a.affiliation]]\n        #if a.keys().contains(\"email\") { [\\*] }\n      ]\n      author_strings.push(author_string)\n    }\n  }\n\n  // Display title\n  if title != none {\n    titleblock(title)\n  }\n\n  // Display authors with formatting\n  if authors != none {\n    titleblock(\n      [#author_strings.join(\", \", last: \" & \")],\n      size: 1em\n    )\n  }\n\n  // Display affiliations\n  if affiliations != none {\n    titleblock(\n      for a in affiliations [\n        #if authors.len() > 1 [#super[#a.id]]#a.name \\\n      ],\n      size: 0.9em\n    )\n  }\n}\n\n// Example usage\n#show: doc => minimal-preprint(\n  title: [Sample Paper Title],\n  authors: (\n    (name: [John Smith], affiliation: [1] ),\n    (name: [Jane Doe], affiliation: [1]),\n    (name: [Jane Doe], affiliation: [1], email: [john@example.com])\n  ),\n  affiliations: ((id: \"1\", name: \"Example University\"),),\n)\n```\n\n![image|433x174](upload://ahFzm7kha2Fb11ZqMWSKJIzLx83.png)\n\nIt give me too much space after superscript with affiliation (before comma), how I can fix it?",
      "reply_to_post_number": null,
      "reply_count": 0,
      "quote_count": 0,
      "like_count": 0,
      "reads": 23,
      "score": 479.4,
      "accepted_answer": false,
      "trust_level": 1,
      "user_id": 410
    },
    {
      "id": 5257,
      "post_number": 2,
      "username": "quachpas",
      "name": "Pascal Quach",
      "created_at": "2024-11-07T12:52:10.750Z",
      "updated_at": "2024-11-07T12:52:34.407Z",
      "cooked": "<p>In constructing <code>author_string</code>, you are adding spaces.</p>\n<pre data-code-wrap=\"typ\"><code class=\"lang-typ\">#let author_string = [\n        #box[#a.name]\n        #if authors.len() &gt; 1 [#super[#a.affiliation]]\n        #if a.keys().contains(\"email\") { [\\*] }\n      ]\n</code></pre>\n<p>Probably should be something like</p>\n<pre data-code-wrap=\"typ\"><code class=\"lang-typ\">      // Create basic author string with name and affiliation\n      #let author_affiliation = if a.keys().contains(\"email\") [\n        #a.affiliation\\*\n      ] else {\n        a.affiliation\n      }\n      #let author_string = [\n        #box[\n          #if authors.len() &gt; 1 {\n            a.name\n            super(author_affiliation)\n          } else {\n            a.name\n          }\n        ]\n      ]\n</code></pre>",
      "raw": "In constructing `author_string`, you are adding spaces.\n```typ\n#let author_string = [\n        #box[#a.name]\n        #if authors.len() > 1 [#super[#a.affiliation]]\n        #if a.keys().contains(\"email\") { [\\*] }\n      ]\n```\nProbably should be something like\n```typ\n      // Create basic author string with name and affiliation\n      #let author_affiliation = if a.keys().contains(\"email\") [\n        #a.affiliation\\*\n      ] else {\n        a.affiliation\n      }\n      #let author_string = [\n        #box[\n          #if authors.len() > 1 {\n            a.name\n            super(author_affiliation)\n          } else {\n            a.name\n          }\n        ]\n      ]\n```",
      "reply_to_post_number": null,
      "reply_count": 1,
      "quote_count": 0,
      "like_count": 0,
      "reads": 21,
      "score": 14.0,
      "accepted_answer": false,
      "trust_level": 3,
      "user_id": 258
    },
    {
      "id": 5259,
      "post_number": 3,
      "username": "danborek",
      "name": "danborek",
      "created_at": "2024-11-07T13:28:34.022Z",
      "updated_at": "2024-11-07T13:28:34.022Z",
      "cooked": "<p>I changed it to</p>\n<pre data-code-wrap=\"typst\"><code class=\"lang-typst\">#let titleblock(body, size: 1.2em) = [\n  #align(center)[\n    #text(size: size)[#body]\n  ]\n]\n\n#let minimal-preprint(\n  title: none,\n  authors: (),\n  affiliations: none,\n) = {\n  // Format author strings\n  let author_strings = ()\n  \n  if authors != none {\n    for a in authors {\n      // Create basic author string with name and affiliation\n      let author_affiliation = if a.keys().contains(\"email\") [\n        #a.affiliation\\*\n      ] else {\n        a.affiliation\n      }\n      let author_string = [\n        #box[\n          #if authors.len() &gt; 1 {\n            a.name\n            super(author_affiliation)\n          } else {\n            a.name\n          }\n        ]\n      ]\n      author_strings.push(author_string)\n    }\n  }\n\n  // Display title\n  if title != none {\n    titleblock(title)\n  }\n\n  // Display authors with formatting\n  if authors != none {\n    titleblock(\n      [#author_strings.join(\", \", last: \" &amp; \")],\n      size: 1em\n    )\n  }\n\n  // Display affiliations\n  if affiliations != none {\n    titleblock(\n      for a in affiliations [\n        #if authors.len() &gt; 1 [#super[#a.id]]#a.name \\\n      ],\n      size: 0.9em\n    )\n  }\n}\n\n// Example usage\n#show: doc =&gt; minimal-preprint(\n  title: [Sample Paper Title],\n  authors: (\n    (name: [John Smith], affiliation: [1] ),\n    (name: [Jane Doe], affiliation: [1]),\n    (name: [Jane Doe], affiliation: [1], email: [john@example.com])\n  ),\n  affiliations: ((id: \"1\", name: \"Example University\"),),\n)\n</code></pre>\n<p>but the result is the same</p>",
      "raw": "I changed it to \n```typst\n#let titleblock(body, size: 1.2em) = [\n  #align(center)[\n    #text(size: size)[#body]\n  ]\n]\n\n#let minimal-preprint(\n  title: none,\n  authors: (),\n  affiliations: none,\n) = {\n  // Format author strings\n  let author_strings = ()\n  \n  if authors != none {\n    for a in authors {\n      // Create basic author string with name and affiliation\n      let author_affiliation = if a.keys().contains(\"email\") [\n        #a.affiliation\\*\n      ] else {\n        a.affiliation\n      }\n      let author_string = [\n        #box[\n          #if authors.len() > 1 {\n            a.name\n            super(author_affiliation)\n          } else {\n            a.name\n          }\n        ]\n      ]\n      author_strings.push(author_string)\n    }\n  }\n\n  // Display title\n  if title != none {\n    titleblock(title)\n  }\n\n  // Display authors with formatting\n  if authors != none {\n    titleblock(\n      [#author_strings.join(\", \", last: \" & \")],\n      size: 1em\n    )\n  }\n\n  // Display affiliations\n  if affiliations != none {\n    titleblock(\n      for a in affiliations [\n        #if authors.len() > 1 [#super[#a.id]]#a.name \\\n      ],\n      size: 0.9em\n    )\n  }\n}\n\n// Example usage\n#show: doc => minimal-preprint(\n  title: [Sample Paper Title],\n  authors: (\n    (name: [John Smith], affiliation: [1] ),\n    (name: [Jane Doe], affiliation: [1]),\n    (name: [Jane Doe], affiliation: [1], email: [john@example.com])\n  ),\n  affiliations: ((id: \"1\", name: \"Example University\"),),\n)\n``` \nbut the result is the same",
      "reply_to_post_number": 2,
      "reply_count": 1,
      "quote_count": 0,
      "like_count": 0,
      "reads": 19,
      "score": 8.6,
      "accepted_answer": false,
      "trust_level": 1,
      "user_id": 410
    },
    {
      "id": 5260,
      "post_number": 4,
      "username": "quachpas",
      "name": "Pascal Quach",
      "created_at": "2024-11-07T13:29:49.293Z",
      "updated_at": "2024-11-07T13:29:49.293Z",
      "cooked": "<p>with this code my output is<br>\n<div class=\"lightbox-wrapper\"><a class=\"lightbox\" href=\"https://forum.typst.app/uploads/default/original/2X/3/39ae7447518caa5d026830024b8cacf40498b27e.png\" data-download-href=\"https://forum.typst.app/uploads/default/39ae7447518caa5d026830024b8cacf40498b27e\" title=\"image\"><img src=\"https://forum.typst.app/uploads/default/optimized/2X/3/39ae7447518caa5d026830024b8cacf40498b27e_2_690x278.png\" alt=\"image\" data-base62-sha1=\"8egYTKaldrJg8n11DLDneXefUaG\" width=\"690\" height=\"278\" srcset=\"https://forum.typst.app/uploads/default/optimized/2X/3/39ae7447518caa5d026830024b8cacf40498b27e_2_690x278.png, https://forum.typst.app/uploads/default/original/2X/3/39ae7447518caa5d026830024b8cacf40498b27e.png 1.5x, https://forum.typst.app/uploads/default/original/2X/3/39ae7447518caa5d026830024b8cacf40498b27e.png 2x\" data-dominant-color=\"F3F3F3\"><div class=\"meta\"><svg class=\"fa d-icon d-icon-far-image svg-icon\" aria-hidden=\"true\"><use href=\"#far-image\"></use></svg><span class=\"filename\">image</span><span class=\"informations\">818×330 28.8 KB</span><svg class=\"fa d-icon d-icon-discourse-expand svg-icon\" aria-hidden=\"true\"><use href=\"#discourse-expand\"></use></svg></div></a></div></p>",
      "raw": "with this code my output is \n![image|690x278](upload://8egYTKaldrJg8n11DLDneXefUaG.png)",
      "reply_to_post_number": 3,
      "reply_count": 1,
      "quote_count": 0,
      "like_count": 0,
      "reads": 18,
      "score": 8.4,
      "accepted_answer": false,
      "trust_level": 3,
      "user_id": 258
    },
    {
      "id": 5261,
      "post_number": 5,
      "username": "danborek",
      "name": "danborek",
      "created_at": "2024-11-07T13:36:44.976Z",
      "updated_at": "2024-11-07T13:39:25.340Z",
      "cooked": "<p>Yes, I would rather to have something more similar to superscript and comma  in the normal text<br>\n<img src=\"https://forum.typst.app/uploads/default/original/2X/9/94fa960c3ec1502e05de1894b8b0b43cb9201dac.png\" alt=\"image\" data-base62-sha1=\"lfVxIPNuHhtxS5y9Z4gLIpyfSMI\" width=\"358\" height=\"80\"><br>\n(with maybe bigger space after the comma as it is now in the first example, I want to suppress the space before the comma , <code>#author_strings.join(\", \", last: \" &amp; \")</code> seems to be ok</p>\n<p>I apologize for my messy example, it was confusing (I made code example by removing ORICID part , that introduced innecesary  space before superscript), the problem for me is the  space after superscript</p>",
      "raw": "Yes, I would rather to have something more similar to superscript and comma  in the normal text \n![image|358x80](upload://lfVxIPNuHhtxS5y9Z4gLIpyfSMI.png)\n(with maybe bigger space after the comma as it is now in the first example, I want to suppress the space before the comma , `#author_strings.join(\", \", last: \" & \")` seems to be ok\n\nI apologize for my messy example, it was confusing (I made code example by removing ORICID part , that introduced innecesary  space before superscript), the problem for me is the  space after superscript",
      "reply_to_post_number": 4,
      "reply_count": 0,
      "quote_count": 0,
      "like_count": 0,
      "reads": 18,
      "score": 3.4,
      "accepted_answer": false,
      "trust_level": 1,
      "user_id": 410
    },
    {
      "id": 5263,
      "post_number": 6,
      "username": "flokl",
      "name": "",
      "created_at": "2024-11-07T14:43:42.456Z",
      "updated_at": "2024-11-07T15:44:16.010Z",
      "cooked": "<p>Hi <a class=\"mention\" href=\"/u/danborek\">@danborek</a>,<br>\nI marked the lines where you have the problem:</p>\n<pre data-code-wrap=\"typst\"><code class=\"lang-typst\">      let author_string = [ // &lt;-- Here\n        #box[\n          #if authors.len() &gt; 1 {\n            a.name\n            super(author_affiliation)\n          } else {\n            a.name\n          }\n        ]\n      ] // &lt;-- And here is your problem\n</code></pre>\n<p>To demonstrate your problem I created a minimal example.</p>\n<details>\n<summary>\nExample</summary>\n<pre data-code-wrap=\"typst\"><code class=\"lang-typst\">#repr(\n[// &lt;-- Here\n  #box()[test]\n]// &lt;-- And here\n)\n</code></pre>\n<p>Which results in the following:<br>\n<img src=\"https://forum.typst.app/uploads/default/original/2X/1/116ccb61b97ceac8d5c921ed3c08f4a94de9d19d.png\" alt=\"test\" data-base62-sha1=\"2u9cTKQMTN3CetRm7TzQWu8synz\" width=\"296\" height=\"149\"><br>\nNotice the single space content <code>[ ]</code> before and after the block.</p>\n</details>\n<p>To fix it in your example you can either replace the square brackets with curly braces and remove the hash symbol of the block or simply remove the brackets and start with the block directly after the equal, like you did five lines above with the <code>if</code>.</p>\n<pre data-code-wrap=\"typst\"><code class=\"lang-typst\">let author_string = box[\n  #if authors.len() &gt; 1 {\n    a.name\n    super(author_affiliation)\n  } else {\n    a.name\n  }\n]\n</code></pre>\n<p>I would generally recommend to use curly braces while scripting and use square brackets only when they make sense.</p>\n<p>Edit: I just noticed you don’t even need the box.<br>\nEdit Edit: added the box back in to keep the name and affiliation together.</p>\n<pre data-code-wrap=\"typst\"><code class=\"lang-typst\">let author_string = if authors.len() &gt; 1 {\n  box(a.name + super(author_affiliation))\n} else {\n  a.name\n}\n</code></pre>",
      "raw": "Hi @danborek,\nI marked the lines where you have the problem:\n\n```typst\n      let author_string = [ // <-- Here\n        #box[\n          #if authors.len() > 1 {\n            a.name\n            super(author_affiliation)\n          } else {\n            a.name\n          }\n        ]\n      ] // <-- And here is your problem\n```\n\nTo demonstrate your problem I created a minimal example.\n[details=\"Example\"]\n```typst\n#repr(\n[// <-- Here\n  #box()[test]\n]// <-- And here\n)\n```\nWhich results in the following:\n![test|296x149](upload://2u9cTKQMTN3CetRm7TzQWu8synz.png)\nNotice the single space content `[ ]` before and after the block.\n[/details]\nTo fix it in your example you can either replace the square brackets with curly braces and remove the hash symbol of the block or simply remove the brackets and start with the block directly after the equal, like you did five lines above with the `if`.\n\n```typst\nlet author_string = box[\n  #if authors.len() > 1 {\n    a.name\n    super(author_affiliation)\n  } else {\n    a.name\n  }\n]\n```\nI would generally recommend to use curly braces while scripting and use square brackets only when they make sense.\n\nEdit: I just noticed you don't even need the box.\nEdit Edit: added the box back in to keep the name and affiliation together.\n```typst\nlet author_string = if authors.len() > 1 {\n  box(a.name + super(author_affiliation))\n} else {\n  a.name\n}\n```",
      "reply_to_post_number": null,
      "reply_count": 1,
      "quote_count": 0,
      "like_count": 2,
      "reads": 18,
      "score": 93.4,
      "accepted_answer": true,
      "trust_level": 3,
      "user_id": 8
    },
    {
      "id": 5265,
      "post_number": 7,
      "username": "danborek",
      "name": "danborek",
      "created_at": "2024-11-07T15:39:02.403Z",
      "updated_at": "2024-11-07T15:40:29.095Z",
      "cooked": "<p>thank you, It your pointing to <span class=\"chcklst-box fa fa-square-o fa-fw\"></span> solves my problem spaces, I want iteratively add authors</p>\n<pre><code class=\"lang-auto\">    for a in authors {\n      let author_string = {\n        a.name\n        if authors.len() &gt; 1 {super(a.affiliation)}\n        if a.keys().contains(\"email\") {[\\*]}\n}}\n\n</code></pre>\n<p>the last thing I want to ensure is that the author names or its affiliation will not be split between lines,  does {} around authore_string will have the same properties as <code>box[]</code>?</p>",
      "raw": "thank you, It your pointing to [] solves my problem spaces, I want iteratively add authors\n\n```\n    for a in authors {\n      let author_string = {\n        a.name\n        if authors.len() > 1 {super(a.affiliation)}\n        if a.keys().contains(\"email\") {[\\*]}\n}}\n\n````\nthe last thing I want to ensure is that the author names or its affiliation will not be split between lines,  does {} around authore_string will have the same properties as `box[]`?",
      "reply_to_post_number": 6,
      "reply_count": 0,
      "quote_count": 0,
      "like_count": 0,
      "reads": 15,
      "score": 2.8,
      "accepted_answer": false,
      "trust_level": 1,
      "user_id": 410
    },
    {
      "id": 5266,
      "post_number": 8,
      "username": "flokl",
      "name": "",
      "created_at": "2024-11-07T15:40:23.926Z",
      "updated_at": "2024-11-07T15:45:14.295Z",
      "cooked": "<p>Ahh true I didn’t think about that, you have to keep the box.<br>\n(I added it bsck in the example above)</p>",
      "raw": "Ahh true I didn't think about that, you have to keep the box.\n(I added it bsck in the example above)",
      "reply_to_post_number": null,
      "reply_count": 1,
      "quote_count": 0,
      "like_count": 0,
      "reads": 15,
      "score": 7.8,
      "accepted_answer": false,
      "trust_level": 3,
      "user_id": 8
    },
    {
      "id": 5267,
      "post_number": 9,
      "username": "danborek",
      "name": "danborek",
      "created_at": "2024-11-07T15:50:45.972Z",
      "updated_at": "2024-11-07T15:53:52.649Z",
      "cooked": "<p>My final  (simplified) solution is</p>\n<pre data-code-wrap=\"typst\"><code class=\"lang-typst\">let author_strings = ()\n    for a in authors {\n      let author_string = box[#{\n        a.name\n        if authors.len() &gt; 1 {super(a.affiliation)}\n        if a.keys().contains(\"email\") {[\\*]}\n    }\n   ]\n  author_strings.push(author_string)\n  }\n\n</code></pre>",
      "raw": "My final  (simplified) solution is \n```typst\nlet author_strings = ()\n    for a in authors {\n      let author_string = box[#{\n        a.name\n        if authors.len() > 1 {super(a.affiliation)}\n        if a.keys().contains(\"email\") {[\\*]}\n    }\n   ]\n  author_strings.push(author_string)\n  }\n\n````",
      "reply_to_post_number": 8,
      "reply_count": 0,
      "quote_count": 0,
      "like_count": 0,
      "reads": 15,
      "score": 2.8,
      "accepted_answer": false,
      "trust_level": 1,
      "user_id": 410
    },
    {
      "id": 5365,
      "post_number": 10,
      "username": "PgBiel",
      "name": "",
      "created_at": "2024-11-08T23:34:23.499Z",
      "updated_at": "2024-11-08T23:34:23.499Z",
      "cooked": "<p>Hey <a class=\"mention\" href=\"/u/danborek\">@danborek</a> ! I’ve updated your post title to better suit our question guidelines: <a href=\"https://forum.typst.app/t/how-to-post-in-the-questions-category/11\" class=\"inline-onebox\">How to post in the Questions category</a></p>\n<p>Please make sure your title is a question you’d ask to a friend about Typst. <img src=\"https://forum.typst.app/images/emoji/apple/wink.png?v=12\" title=\":wink:\" class=\"emoji\" alt=\":wink:\" loading=\"lazy\" width=\"20\" height=\"20\"></p>",
      "raw": "Hey @danborek ! I've updated your post title to better suit our question guidelines: https://forum.typst.app/t/how-to-post-in-the-questions-category/11\n\nPlease make sure your title is a question you'd ask to a friend about Typst. :wink:",
      "reply_to_post_number": null,
      "reply_count": 0,
      "quote_count": 0,
      "like_count": 1,
      "reads": 13,
      "score": 22.4,
      "accepted_answer": false,
      "trust_level": 2,
      "user_id": 3
    }
  ],
  "scraped_at": "2025-06-10T09:55:22.542009"
}