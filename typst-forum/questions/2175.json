{
  "topic_metadata": {
    "id": 2175,
    "title": "How to display a short version of a heading inside the header?",
    "slug": "how-to-display-a-short-version-of-a-heading-inside-the-header",
    "posts_count": 8,
    "created_at": "2024-12-21T18:58:11.093Z",
    "last_posted_at": "2024-12-22T18:06:27.694Z",
    "views": 256,
    "like_count": 3,
    "reply_count": 5,
    "has_accepted_answer": true,
    "accepted_answer_post_number": 8,
    "accepted_answer_username": "flokl",
    "tags": [
      "scripting"
    ],
    "category_id": 5,
    "participant_count": 3,
    "word_count": 578
  },
  "posts": [
    {
      "id": 6825,
      "post_number": 1,
      "username": "jlb",
      "name": "Jean-Louis",
      "created_at": "2024-12-21T18:58:11.206Z",
      "updated_at": "2024-12-23T01:05:00.127Z",
      "cooked": "<p>I have very long titles in a document and I would like to have shorter versions in the header.</p>\n<p>Example:</p>\n<pre data-code-wrap=\"typ\"><code class=\"lang-typ\">= Chapter 1: My chapter title is very long and I want a shorter title in the header\n</code></pre>\n<p>If possible, I would like to have a short and a long string for each chapter: the long string in the body of the document and the short string in the header.</p>\n<p>I don’t know how to do this with the hydra package or just typst.</p>\n<pre data-code-wrap=\"typst\"><code class=\"lang-typst\">#let chapter(long_title:\"\", short_title:\"\") = {\n\t[= #long_title]\n}\n\n#chapter(long_title:\"= Chapter 1: My chapter title is very long and I want a shorter title in the header\", short_title:\"My short title\")\n</code></pre>\n<p>How to do have short_title in the header ?</p>",
      "raw": "I have very long titles in a document and I would like to have shorter versions in the header.\n\nExample:\n```typ\n= Chapter 1: My chapter title is very long and I want a shorter title in the header\n```\nIf possible, I would like to have a short and a long string for each chapter: the long string in the body of the document and the short string in the header.\n\nI don't know how to do this with the hydra package or just typst.\n\n```typst\n#let chapter(long_title:\"\", short_title:\"\") = {\n\t[= #long_title]\n}\n\n#chapter(long_title:\"= Chapter 1: My chapter title is very long and I want a shorter title in the header\", short_title:\"My short title\")\n```\n\nHow to do have short_title in the header ?",
      "reply_to_post_number": null,
      "reply_count": 0,
      "quote_count": 0,
      "like_count": 0,
      "reads": 56,
      "score": 711.0,
      "accepted_answer": false,
      "trust_level": 1,
      "user_id": 809
    },
    {
      "id": 6831,
      "post_number": 3,
      "username": "quachpas",
      "name": "Pascal Quach",
      "created_at": "2024-12-22T11:21:04.241Z",
      "updated_at": "2024-12-22T13:52:07.089Z",
      "cooked": "<p>Hello <a class=\"mention\" href=\"/u/jlb\">@jlb</a>, this is possible using a combination of queries in the page header. You will find below a full example that also supports numbering, which is trickier in the header as it is right before the heading.</p>\n<aside class=\"quote no-group\" data-username=\"laurmaedje\" data-post=\"10\" data-topic=\"1924\">\n<div class=\"title\">\n<div class=\"quote-controls\"></div>\n<img loading=\"lazy\" alt=\"\" width=\"24\" height=\"24\" src=\"https://forum.typst.app/user_avatar/forum.typst.app/laurmaedje/48/14_2.png\" class=\"avatar\"><a href=\"https://forum.typst.app/t/how-to-reset-the-page-counter-after-every-section/1924/10\">How to reset the page counter after every section?</a></div>\n<blockquote>\n<p>The counter is resolved based on the logical order of things: The header is logically before the page content, which is followed by the footer.</p>\n</blockquote>\n</aside>\n<p>Queries are very powerful indeed, don’t hesitate to play with them. You can also inspect the content of queries directly by hovering over the variable. See</p><aside class=\"quote quote-modified\" data-post=\"1\" data-topic=\"1311\">\n  <div class=\"title\">\n    <div class=\"quote-controls\"></div>\n    <img loading=\"lazy\" alt=\"\" width=\"24\" height=\"24\" src=\"https://forum.typst.app/user_avatar/forum.typst.app/sebastianjl/48/870_2.png\" class=\"avatar\">\n    <a href=\"https://forum.typst.app/t/what-are-the-values-that-are-shown-when-hovering-over-a-variable/1311\">What are the values that are shown when hovering over a variable?</a> <a class=\"badge-category__wrapper \" href=\"/c/questions/5\"><span data-category-id=\"5\" style=\"--category-badge-color: #F7C000; --category-badge-text-color: #fdfdfd;\" data-drop-close=\"true\" class=\"badge-category \" title=\"Your questions about using Typst and the web app go in this category.\"><span class=\"badge-category__name\">Questions</span></span></a>\n  </div>\n  <blockquote>\n    Oh I never knew that. What are the many different versions that it shows? Just examples? \n <a class=\"lightbox\" href=\"https://forum.typst.app/uploads/default/original/2X/9/9cf71c52d85faeabda153394ed276467d1b609a6.png\" data-download-href=\"https://forum.typst.app/uploads/default/9cf71c52d85faeabda153394ed276467d1b609a6\" title=\"image\">[image]</a> \nOn the image you can only see two, but there are around 9 available with scrolling.\n  </blockquote>\n</aside>\n\n<pre data-code-wrap=\"typ\"><code class=\"lang-typ\">#set heading(numbering: \"1.1\")\n#show heading.where(level: 1): set heading(supplement: \"Chapter\")\n#set page(header: context {\n  let h = query(selector(heading.where(level: 1)).before(here()))\n  if h.len() == 0 {\n    h = query(selector(heading.where(level: 1)).after(here())).first()\n  } else {\n    h = h.last()\n  }\n  let s = query(selector(metadata).after(h.location())).filter(it =&gt; it.value.children.first().text  == \"h:\").first()\n  let short = s.value.children.slice(1).first()\n  align(center, {\n    h.supplement\n    \" \"\n    if h.numbering != none { numbering(h.numbering, ..counter(heading).at(s.location())) }\n    [ -- ]\n    short\n  })\n})\n#let chapter(long, short) = {\n  heading(long) \n  metadata(\"h:\" + short)\n}\n\n#chapter[This is a very long title][Short 1]\n\n#pagebreak()\n\n#chapter[Long][Short 2]\n</code></pre>\n<p><div class=\"lightbox-wrapper\"><a class=\"lightbox\" href=\"https://forum.typst.app/uploads/default/original/2X/3/38af046a003eed9221df6d8a4b6f34ca4cc24167.png\" data-download-href=\"https://forum.typst.app/uploads/default/38af046a003eed9221df6d8a4b6f34ca4cc24167\" title=\"image\"><img src=\"https://forum.typst.app/uploads/default/optimized/2X/3/38af046a003eed9221df6d8a4b6f34ca4cc24167_2_690x44.png\" alt=\"image\" data-base62-sha1=\"85rI5iXYeEw8RwIbeRb7ZoH5ZFZ\" width=\"690\" height=\"44\" srcset=\"https://forum.typst.app/uploads/default/optimized/2X/3/38af046a003eed9221df6d8a4b6f34ca4cc24167_2_690x44.png, https://forum.typst.app/uploads/default/optimized/2X/3/38af046a003eed9221df6d8a4b6f34ca4cc24167_2_1035x66.png 1.5x, https://forum.typst.app/uploads/default/optimized/2X/3/38af046a003eed9221df6d8a4b6f34ca4cc24167_2_1380x88.png 2x\" data-dominant-color=\"FCFCFC\"><div class=\"meta\"><svg class=\"fa d-icon d-icon-far-image svg-icon\" aria-hidden=\"true\"><use href=\"#far-image\"></use></svg><span class=\"filename\">image</span><span class=\"informations\">1771×115 10.2 KB</span><svg class=\"fa d-icon d-icon-discourse-expand svg-icon\" aria-hidden=\"true\"><use href=\"#discourse-expand\"></use></svg></div></a></div></p>",
      "raw": "Hello @jlb, this is possible using a combination of queries in the page header. You will find below a full example that also supports numbering, which is trickier in the header as it is right before the heading.\n[quote=\"laurmaedje, post:10, topic:1924\"]\nThe counter is resolved based on the logical order of things: The header is logically before the page content, which is followed by the footer.\n[/quote]\n\nQueries are very powerful indeed, don't hesitate to play with them. You can also inspect the content of queries directly by hovering over the variable. See\nhttps://forum.typst.app/t/what-are-the-values-that-are-shown-when-hovering-over-a-variable/1311\n\n```typ\n#set heading(numbering: \"1.1\")\n#show heading.where(level: 1): set heading(supplement: \"Chapter\")\n#set page(header: context {\n  let h = query(selector(heading.where(level: 1)).before(here()))\n  if h.len() == 0 {\n    h = query(selector(heading.where(level: 1)).after(here())).first()\n  } else {\n    h = h.last()\n  }\n  let s = query(selector(metadata).after(h.location())).filter(it => it.value.children.first().text  == \"h:\").first()\n  let short = s.value.children.slice(1).first()\n  align(center, {\n    h.supplement\n    \" \"\n    if h.numbering != none { numbering(h.numbering, ..counter(heading).at(s.location())) }\n    [ -- ]\n    short\n  })\n})\n#let chapter(long, short) = {\n  heading(long) \n  metadata(\"h:\" + short)\n}\n\n#chapter[This is a very long title][Short 1]\n\n#pagebreak()\n\n#chapter[Long][Short 2]\n```\n![image|690x44](upload://85rI5iXYeEw8RwIbeRb7ZoH5ZFZ.png)",
      "reply_to_post_number": null,
      "reply_count": 2,
      "quote_count": 0,
      "like_count": 1,
      "reads": 47,
      "score": 44.2,
      "accepted_answer": false,
      "trust_level": 3,
      "user_id": 258
    },
    {
      "id": 6835,
      "post_number": 4,
      "username": "jlb",
      "name": "Jean-Louis",
      "created_at": "2024-12-22T13:31:43.981Z",
      "updated_at": "2024-12-22T13:33:27.188Z",
      "cooked": "<p>Thanks a lot.</p>\n<p>But it doesn’t work with this markup :</p>\n<pre data-code-wrap=\"typst\"><code class=\"lang-typst\">#chapter[Long title 1][Short 1]\n#lorem(2000)\n\n#chapter[Long title 2][Short 2]\n#lorem(2000)\n\n#chapter[Long title 3][Short 3]\n#lorem(2000)\n</code></pre>",
      "raw": "Thanks a lot.\n\nBut it doesn't work with this markup : \n\n```typst\n#chapter[Long title 1][Short 1]\n#lorem(2000)\n\n#chapter[Long title 2][Short 2]\n#lorem(2000)\n\n#chapter[Long title 3][Short 3]\n#lorem(2000)\n```",
      "reply_to_post_number": 3,
      "reply_count": 1,
      "quote_count": 0,
      "like_count": 0,
      "reads": 38,
      "score": 12.4,
      "accepted_answer": false,
      "trust_level": 1,
      "user_id": 809
    },
    {
      "id": 6836,
      "post_number": 5,
      "username": "quachpas",
      "name": "Pascal Quach",
      "created_at": "2024-12-22T13:51:49.225Z",
      "updated_at": "2024-12-22T13:52:19.858Z",
      "cooked": "<aside class=\"quote no-group quote-modified\" data-username=\"quachpas\" data-post=\"3\" data-topic=\"2175\">\n<div class=\"title\">\n<div class=\"quote-controls\"></div>\n<img loading=\"lazy\" alt=\"\" width=\"24\" height=\"24\" src=\"https://forum.typst.app/letter_avatar_proxy/v4/letter/q/662200/48.png\" class=\"avatar\"> quachpas:</div>\n<blockquote>\n<pre><code class=\"lang-auto\">  let h = query(selector(heading.where(level: 1)).after(here())).first()\n</code></pre>\n</blockquote>\n</aside>\n<p>I updated the implementation to fix this <img src=\"https://forum.typst.app/images/emoji/apple/smiley.png?v=12\" title=\":smiley:\" class=\"emoji\" alt=\":smiley:\" loading=\"lazy\" width=\"20\" height=\"20\">. It was missing edge cases, thanks for the reply</p>",
      "raw": "[quote=\"quachpas, post:3, topic:2175\"]\n```\n  let h = query(selector(heading.where(level: 1)).after(here())).first()\n```\n[/quote]\n\nI updated the implementation to fix this :smiley:. It was missing edge cases, thanks for the reply",
      "reply_to_post_number": 4,
      "reply_count": 1,
      "quote_count": 1,
      "like_count": 0,
      "reads": 34,
      "score": 11.6,
      "accepted_answer": false,
      "trust_level": 3,
      "user_id": 258
    },
    {
      "id": 6838,
      "post_number": 6,
      "username": "jlb",
      "name": "Jean-Louis",
      "created_at": "2024-12-22T14:09:19.550Z",
      "updated_at": "2024-12-22T14:10:48.039Z",
      "cooked": "<p>Sorry, I have another problem with this markup :</p>\n<pre data-code-wrap=\"typst\"><code class=\"lang-typst\">#chapter[Long title 1][Short 1]\n#lorem(2000)\n\n#chapter[Long title 2][Short 2]\n#lorem(2000)\n\n#chapter[Long title 3][Short 3]\n#lorem(2000)\n</code></pre>\n<p><div class=\"lightbox-wrapper\"><a class=\"lightbox\" href=\"https://forum.typst.app/uploads/default/original/2X/7/786e48d21e30d174c3585de6b4a55e08595e80eb.png\" data-download-href=\"https://forum.typst.app/uploads/default/786e48d21e30d174c3585de6b4a55e08595e80eb\" title=\"image\"><img src=\"https://forum.typst.app/uploads/default/optimized/2X/7/786e48d21e30d174c3585de6b4a55e08595e80eb_2_690x126.png\" alt=\"image\" data-base62-sha1=\"hbnzWNiNZuRDCJKFOJHG7gzNMAb\" width=\"690\" height=\"126\" srcset=\"https://forum.typst.app/uploads/default/optimized/2X/7/786e48d21e30d174c3585de6b4a55e08595e80eb_2_690x126.png, https://forum.typst.app/uploads/default/optimized/2X/7/786e48d21e30d174c3585de6b4a55e08595e80eb_2_1035x189.png 1.5x, https://forum.typst.app/uploads/default/original/2X/7/786e48d21e30d174c3585de6b4a55e08595e80eb.png 2x\" data-dominant-color=\"F5F5F5\"><div class=\"meta\"><svg class=\"fa d-icon d-icon-far-image svg-icon\" aria-hidden=\"true\"><use href=\"#far-image\"></use></svg><span class=\"filename\">image</span><span class=\"informations\">1253×230 33 KB</span><svg class=\"fa d-icon d-icon-discourse-expand svg-icon\" aria-hidden=\"true\"><use href=\"#discourse-expand\"></use></svg></div></a></div></p>\n<p>“Chapter 1 - Short 1” header with \"“Chapter 2 - Short 2” heading</p>",
      "raw": "Sorry, I have another problem with this markup : \n\n```typst \n#chapter[Long title 1][Short 1]\n#lorem(2000)\n\n#chapter[Long title 2][Short 2]\n#lorem(2000)\n\n#chapter[Long title 3][Short 3]\n#lorem(2000)\n```\n\n![image|690x126](upload://hbnzWNiNZuRDCJKFOJHG7gzNMAb.png)\n\n\"Chapter 1 - Short 1\" header with \"\"Chapter 2 - Short 2\" heading",
      "reply_to_post_number": 5,
      "reply_count": 1,
      "quote_count": 0,
      "like_count": 0,
      "reads": 33,
      "score": 21.4,
      "accepted_answer": false,
      "trust_level": 1,
      "user_id": 809
    },
    {
      "id": 6841,
      "post_number": 7,
      "username": "quachpas",
      "name": "Pascal Quach",
      "created_at": "2024-12-22T14:24:37.246Z",
      "updated_at": "2024-12-22T14:24:37.246Z",
      "cooked": "<p>Hmmm, I think that should be achievable by checking the page number to ensure correctness. I don’t have time atm, so if someone else passes by, feel free to try.</p>",
      "raw": "Hmmm, I think that should be achievable by checking the page number to ensure correctness. I don't have time atm, so if someone else passes by, feel free to try.",
      "reply_to_post_number": 6,
      "reply_count": 0,
      "quote_count": 0,
      "like_count": 0,
      "reads": 31,
      "score": 16.0,
      "accepted_answer": false,
      "trust_level": 3,
      "user_id": 258
    },
    {
      "id": 6845,
      "post_number": 8,
      "username": "flokl",
      "name": "",
      "created_at": "2024-12-22T17:35:14.839Z",
      "updated_at": "2024-12-22T17:36:32.670Z",
      "cooked": "<p>Hi,</p>\n<p>here is a solution using hydra.</p>\n<pre data-code-wrap=\"typ\"><code class=\"lang-typ\">#import \"@preview/hydra:0.5.1\": hydra, selectors\n#import selectors: custom\n\n#let chapter(long, short) = {\n  [#metadata(short)&lt;short&gt;]\n  heading(long)\n}\n\n#set page(\n  header: context hydra(\n    skip-starting: false,\n    custom(&lt;short&gt;),\n    display: (_, elem) =&gt; {\n      elem.value\n    }\n  )\n)\n\n#chapter[Long title 1][Short 1]\n#lorem(2000)\n\n#chapter[Long title 2][Short 2]\n#lorem(2000)\n\n#chapter[Long title 3][Short 3]\n#lorem(2000)\n</code></pre>",
      "raw": "Hi,\n\nhere is a solution using hydra.\n\n```typ\n#import \"@preview/hydra:0.5.1\": hydra, selectors\n#import selectors: custom\n\n#let chapter(long, short) = {\n  [#metadata(short)<short>]\n  heading(long)\n}\n\n#set page(\n  header: context hydra(\n    skip-starting: false,\n    custom(<short>),\n    display: (_, elem) => {\n      elem.value\n    }\n  )\n)\n\n#chapter[Long title 1][Short 1]\n#lorem(2000)\n\n#chapter[Long title 2][Short 2]\n#lorem(2000)\n\n#chapter[Long title 3][Short 3]\n#lorem(2000)\n```",
      "reply_to_post_number": null,
      "reply_count": 1,
      "quote_count": 0,
      "like_count": 2,
      "reads": 32,
      "score": 66.2,
      "accepted_answer": true,
      "trust_level": 3,
      "user_id": 8
    },
    {
      "id": 6846,
      "post_number": 9,
      "username": "jlb",
      "name": "Jean-Louis",
      "created_at": "2024-12-22T18:06:27.694Z",
      "updated_at": "2024-12-22T18:06:27.694Z",
      "cooked": "<p>Yes, it works, thanks a lot.</p>",
      "raw": "Yes, it works, thanks a lot.",
      "reply_to_post_number": 8,
      "reply_count": 0,
      "quote_count": 0,
      "like_count": 0,
      "reads": 31,
      "score": 6.0,
      "accepted_answer": false,
      "trust_level": 1,
      "user_id": 809
    }
  ],
  "scraped_at": "2025-06-10T09:53:28.673124"
}