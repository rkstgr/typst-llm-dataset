{
  "topic_metadata": {
    "id": 3068,
    "title": "Do I need different code for numbering equations and figures?",
    "slug": "do-i-need-different-code-for-numbering-equations-and-figures",
    "posts_count": 5,
    "created_at": "2025-03-01T18:59:41.112Z",
    "last_posted_at": "2025-03-03T17:41:49.459Z",
    "views": 131,
    "like_count": 0,
    "reply_count": 1,
    "has_accepted_answer": true,
    "accepted_answer_post_number": 2,
    "accepted_answer_username": "Eric",
    "tags": [
      "numbering",
      "figures",
      "counter"
    ],
    "category_id": 5,
    "participant_count": 3,
    "word_count": 504
  },
  "posts": [
    {
      "id": 9275,
      "post_number": 1,
      "username": "Johannes",
      "name": "Johannes",
      "created_at": "2025-03-01T18:59:41.233Z",
      "updated_at": "2025-03-09T13:19:29.709Z",
      "cooked": "<p>Hey, I‘m trying to number my figures in such a way, that the first figure in section 1 is labeled 1.1, the second one 1.2, the first one in section 2 2.1, and so on. I have a piece of code that does exactly that for equations:</p>\n<pre data-code-wrap=\"typ\"><code class=\"lang-typ\">\n#set math.equation(numbering: it =&gt; {\n    let count = counter(heading.where(level: 1)).at(here()).first()\n    if count &gt; 0 {\n      numbering(\"(1.1)\", count - 1, it)\n    }\n    else {\n      numbering(\"(1.1)\", count, it)\n    }\n})\n\n</code></pre>\n<p>The <code>-1</code> is to adjust for my starting with section 0.</p>\n<p>when adjusting to <span class=\"hashtag-raw\">#set</span> figure(numbering … , this doesn‘t work for figures. The first number changes correctly, but the second doesn‘t reset (yielding the number 2.4 for the first figure in section 2).<br>\nWhat am I missing? Thanks!</p>",
      "raw": "Hey, I‘m trying to number my figures in such a way, that the first figure in section 1 is labeled 1.1, the second one 1.2, the first one in section 2 2.1, and so on. I have a piece of code that does exactly that for equations:\n\n```typ\n\n#set math.equation(numbering: it => {\n    let count = counter(heading.where(level: 1)).at(here()).first()\n    if count > 0 {\n      numbering(\"(1.1)\", count - 1, it)\n    }\n    else {\n      numbering(\"(1.1)\", count, it)\n    }\n})\n\n```\nThe `-1` is to adjust for my starting with section 0.\n\nwhen adjusting to #set figure(numbering … , this doesn‘t work for figures. The first number changes correctly, but the second doesn‘t reset (yielding the number 2.4 for the first figure in section 2).\nWhat am I missing? Thanks!",
      "reply_to_post_number": null,
      "reply_count": 0,
      "quote_count": 0,
      "like_count": 0,
      "reads": 28,
      "score": 335.6,
      "accepted_answer": false,
      "trust_level": 1,
      "user_id": 1129
    },
    {
      "id": 9276,
      "post_number": 2,
      "username": "Eric",
      "name": "Eric Biedert",
      "created_at": "2025-03-01T19:31:00.516Z",
      "updated_at": "2025-03-01T19:32:42.753Z",
      "cooked": "<p>You need to also reset the figure/equation counters manually with each first-level heading. You can do so with a show rule</p>\n<pre data-code-wrap=\"typ\"><code class=\"lang-typ\">#show heading.where(level: 1): it =&gt; {\n  counter(figure.where(kind: image)).update(0)\n  counter(figure.where(kind: table)).update(0)\n  counter(figure.where(kind: raw)).update(0)\n  // ..repeat with whatever figure kinds you use\n  counter(math.equation).update(0)\n  it\n}\n</code></pre>\n<p>Also, there is <code>counter(..).get()</code> which you can use instead of <code>counter(..).at(here())</code></p>",
      "raw": "You need to also reset the figure/equation counters manually with each first-level heading. You can do so with a show rule\n```typ\n#show heading.where(level: 1): it => {\n  counter(figure.where(kind: image)).update(0)\n  counter(figure.where(kind: table)).update(0)\n  counter(figure.where(kind: raw)).update(0)\n  // ..repeat with whatever figure kinds you use\n  counter(math.equation).update(0)\n  it\n}\n```\n\nAlso, there is `counter(..).get()` which you can use instead of `counter(..).at(here())`",
      "reply_to_post_number": null,
      "reply_count": 0,
      "quote_count": 0,
      "like_count": 0,
      "reads": 26,
      "score": 20.2,
      "accepted_answer": true,
      "trust_level": 2,
      "user_id": 88
    },
    {
      "id": 9278,
      "post_number": 3,
      "username": "Johannes",
      "name": "Johannes",
      "created_at": "2025-03-01T20:09:26.263Z",
      "updated_at": "2025-03-01T20:09:26.263Z",
      "cooked": "<p>Ah, I see. Thanks for pointing this out!</p>",
      "raw": "Ah, I see. Thanks for pointing this out!",
      "reply_to_post_number": null,
      "reply_count": 0,
      "quote_count": 0,
      "like_count": 0,
      "reads": 24,
      "score": 4.8,
      "accepted_answer": false,
      "trust_level": 1,
      "user_id": 1129
    },
    {
      "id": 9303,
      "post_number": 4,
      "username": "Qualzaks",
      "name": "Qualzaks",
      "created_at": "2025-03-02T20:29:06.549Z",
      "updated_at": "2025-03-09T13:18:54.409Z",
      "cooked": "<p>Hello ,<br>\nSo i just fiddle a little bit with this and</p>\n<pre data-code-wrap=\"typ\"><code class=\"lang-typ\">#set heading(numbering: \"1.1.\")\n//This will reset counter at every heading level\n#show heading: it =&gt; {\n  counter(figure.where(kind: image)).update(0)\n  //counter(figure.where(kind: table)).update(0)\n  //counter(figure.where(kind: raw)).update(0)\n  // ..repeat with whatever figure kinds you use\n  //counter(math.equation).update(0)\n  it\n}\n\n#set figure(numbering: it =&gt; { \n    let count = counter(heading).get()\n    if count.len() &gt; 1 {\n      //I know my document will not have more than 3 level of headings\n      numbering(\"1.1.A.\", count.at(0), count.at(1), it)\n      //e.g. This will put \"Figure 2.3.A\"\n    }\n    else {\n      numbering(\"1.A.\", count.at(0), it)\n      //e.g. This will put \"Figure 2.A\" as the count will be only one level (main one)\n    }\n})\n\n\n\n= Chapter name \n== Sub-chapter\n\n#align(center+top)[\n  #figure(\nimage(\"picture001.jpg\", width: 25%),\ncaption: [this example graphic],\n\n)&lt;pictureA&gt;\n]\n\nhave a look at this Reference \\@pictureA -&gt; @pictureA\n\n#align(center+top)[\n  #figure(\nimage(\"picture001.jpg\", width: 25%),\ncaption: [this example graphic],\n\n)&lt;pictureB&gt;\n]\n\n= Chapter name \n#align(center+top)[\n  #figure(\nimage(\"picture001.jpg\", width: 25%),\ncaption: [this example graphic],\n\n)&lt;picture1.1.A&gt;\n]\n\n#align(center+top)[\n  #figure(\nimage(\"picture001.jpg\", width: 25%),\ncaption: [this example graphic],\n\n)&lt;picture1.1.B&gt;\n]\n#counter(heading).update(7)\n\n== Sub-chapter\n\n\n#align(center+top)[\n  #figure(\nimage(\"picture001.jpg\", width: 25%),\ncaption: [this example graphic],\n\n)&lt;picture2.1.A&gt;\n]\n#align(center+top)[\n  #figure(\nimage(\"picture001.jpg\", width: 25%),\ncaption: [this example graphic],\n\n)&lt;picture2.1.B&gt;\n]\n</code></pre>\n<p><div class=\"lightbox-wrapper\"><a class=\"lightbox\" href=\"https://forum.typst.app/uploads/default/original/2X/6/66e68e0fefb557a26983d6fff9a037da2417a857.png\" data-download-href=\"https://forum.typst.app/uploads/default/66e68e0fefb557a26983d6fff9a037da2417a857\" title=\"Zrzut ekranu z 2025-03-02 21-21-39\"><img src=\"https://forum.typst.app/uploads/default/optimized/2X/6/66e68e0fefb557a26983d6fff9a037da2417a857_2_297x500.png\" alt=\"Zrzut ekranu z 2025-03-02 21-21-39\" data-base62-sha1=\"eGiF93zGhfJ4oQd8el72qcR0WSb\" width=\"297\" height=\"500\" srcset=\"https://forum.typst.app/uploads/default/optimized/2X/6/66e68e0fefb557a26983d6fff9a037da2417a857_2_297x500.png, https://forum.typst.app/uploads/default/optimized/2X/6/66e68e0fefb557a26983d6fff9a037da2417a857_2_445x750.png 1.5x, https://forum.typst.app/uploads/default/original/2X/6/66e68e0fefb557a26983d6fff9a037da2417a857.png 2x\" data-dominant-color=\"F7F7F3\"><div class=\"meta\"><svg class=\"fa d-icon d-icon-far-image svg-icon\" aria-hidden=\"true\"><use href=\"#far-image\"></use></svg><span class=\"filename\">Zrzut ekranu z 2025-03-02 21-21-39</span><span class=\"informations\">489×822 77.6 KB</span><svg class=\"fa d-icon d-icon-discourse-expand svg-icon\" aria-hidden=\"true\"><use href=\"#discourse-expand\"></use></svg></div></a></div></p>\n<p>Hope this helps</p>",
      "raw": "Hello ,\nSo i just fiddle a little bit with this and \n\n```typ\n#set heading(numbering: \"1.1.\")\n//This will reset counter at every heading level\n#show heading: it => {\n  counter(figure.where(kind: image)).update(0)\n  //counter(figure.where(kind: table)).update(0)\n  //counter(figure.where(kind: raw)).update(0)\n  // ..repeat with whatever figure kinds you use\n  //counter(math.equation).update(0)\n  it\n}\n\n#set figure(numbering: it => { \n    let count = counter(heading).get()\n    if count.len() > 1 {\n      //I know my document will not have more than 3 level of headings\n      numbering(\"1.1.A.\", count.at(0), count.at(1), it)\n      //e.g. This will put \"Figure 2.3.A\"\n    }\n    else {\n      numbering(\"1.A.\", count.at(0), it)\n      //e.g. This will put \"Figure 2.A\" as the count will be only one level (main one)\n    }\n})\n\n\n\n= Chapter name \n== Sub-chapter\n\n#align(center+top)[\n  #figure(\nimage(\"picture001.jpg\", width: 25%),\ncaption: [this example graphic],\n\n)<pictureA>\n]\n\nhave a look at this Reference \\@pictureA -> @pictureA\n\n#align(center+top)[\n  #figure(\nimage(\"picture001.jpg\", width: 25%),\ncaption: [this example graphic],\n\n)<pictureB>\n]\n\n= Chapter name \n#align(center+top)[\n  #figure(\nimage(\"picture001.jpg\", width: 25%),\ncaption: [this example graphic],\n\n)<picture1.1.A>\n]\n\n#align(center+top)[\n  #figure(\nimage(\"picture001.jpg\", width: 25%),\ncaption: [this example graphic],\n\n)<picture1.1.B>\n]\n#counter(heading).update(7)\n\n== Sub-chapter\n\n\n#align(center+top)[\n  #figure(\nimage(\"picture001.jpg\", width: 25%),\ncaption: [this example graphic],\n\n)<picture2.1.A>\n]\n#align(center+top)[\n  #figure(\nimage(\"picture001.jpg\", width: 25%),\ncaption: [this example graphic],\n\n)<picture2.1.B>\n]\n```\n![Zrzut ekranu z 2025-03-02 21-21-39|297x500](upload://eGiF93zGhfJ4oQd8el72qcR0WSb.png)\n\n\nHope this helps",
      "reply_to_post_number": null,
      "reply_count": 1,
      "quote_count": 0,
      "like_count": 0,
      "reads": 17,
      "score": 18.4,
      "accepted_answer": false,
      "trust_level": 0,
      "user_id": 1295
    },
    {
      "id": 9335,
      "post_number": 5,
      "username": "Johannes",
      "name": "Johannes",
      "created_at": "2025-03-03T17:41:49.459Z",
      "updated_at": "2025-03-03T17:41:49.459Z",
      "cooked": "<p>Thank you, this helps a lot, especially since I‘m pretty new to typst and still trying to get the hang of it.</p>",
      "raw": "Thank you, this helps a lot, especially since I‘m pretty new to typst and still trying to get the hang of it.",
      "reply_to_post_number": 4,
      "reply_count": 0,
      "quote_count": 0,
      "like_count": 0,
      "reads": 15,
      "score": 3.0,
      "accepted_answer": false,
      "trust_level": 1,
      "user_id": 1129
    }
  ],
  "scraped_at": "2025-06-10T09:50:52.489871"
}