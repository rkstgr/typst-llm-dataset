{
  "topic_metadata": {
    "id": 4473,
    "title": "Is `pagebreak` just a command, or also an element?",
    "slug": "is-pagebreak-just-a-command-or-also-an-element",
    "posts_count": 6,
    "created_at": "2025-06-05T07:41:28.401Z",
    "last_posted_at": "2025-06-05T19:33:54.409Z",
    "views": 57,
    "like_count": 3,
    "reply_count": 3,
    "has_accepted_answer": true,
    "accepted_answer_post_number": 2,
    "accepted_answer_username": "quachpas",
    "tags": [
      "model"
    ],
    "category_id": 5,
    "participant_count": 3,
    "word_count": 702
  },
  "posts": [
    {
      "id": 13740,
      "post_number": 1,
      "username": "quachpas",
      "name": "Pascal Quach",
      "created_at": "2025-06-05T07:41:28.480Z",
      "updated_at": "2025-06-05T10:53:55.646Z",
      "cooked": "<p>Continuing the discussion from <a href=\"https://forum.typst.app/t/how-can-i-suppress-headers-and-footers-on-blank-verso-trailing-pages/4384/8\">How can I suppress headers and footers on blank verso/trailing pages</a>:</p>\n<p>We use a show rule “trick” to make pagebreaks detectable.</p>\n<pre data-code-wrap=\"typ\"><code class=\"lang-typ\">// make pagebreaks detectable\n#show pagebreak: it =&gt; {\n  [#metadata(none) &lt;empty-page-start&gt;]\n  it\n  [#metadata(none) &lt;empty-page-end&gt;]\n}\n</code></pre>\n<aside class=\"quote no-group\" data-username=\"quachpas\" data-post=\"4\" data-topic=\"4384\">\n<div class=\"title\">\n<div class=\"quote-controls\"></div>\n<img alt=\"\" width=\"24\" height=\"24\" src=\"https://forum.typst.app/letter_avatar_proxy/v4/letter/q/662200/48.png\" class=\"avatar\"><a href=\"https://forum.typst.app/t/how-can-i-suppress-headers-and-footers-on-blank-verso-trailing-pages/4384/4\">How can I suppress headers and footers on blank verso/trailing pages</a></div>\n<blockquote>\n<p>As for the trick used here, very briefly, because a <a href=\"https://typst.app/docs/reference/layout/pagebreak\"><code>pagebreak</code></a> is also an element, then you can re-define it to also raise a “start” and an “end” flag (<a href=\"https://typst.app/docs/reference/introspection/metadata/\">metadata</a>), and return “yes, the page is empty”, if you are currently between any of these two flags.</p>\n</blockquote>\n</aside>\n<p><a class=\"mention\" href=\"/u/andrew\">@Andrew</a> was confused about this, because he thought a <code>pagebreak()</code> was just a command.</p>\n<aside class=\"quote no-group\" data-username=\"Andrew\" data-post=\"8\" data-topic=\"4384\">\n<div class=\"title\">\n<div class=\"quote-controls\"></div>\n<img alt=\"\" width=\"24\" height=\"24\" src=\"https://forum.typst.app/user_avatar/forum.typst.app/andrew/48/62_2.png\" class=\"avatar\"><a href=\"https://forum.typst.app/t/how-can-i-suppress-headers-and-footers-on-blank-verso-trailing-pages/4384/8\">How can I suppress headers and footers on blank verso/trailing pages</a></div>\n<blockquote>\n<p>I was actually also confused at this. A neat trick. So <code>pagebreak</code> is not just a command, but an element that can span a long way, even a whole page?</p>\n</blockquote>\n</aside>",
      "raw": "Continuing the discussion from [How can I suppress headers and footers on blank verso/trailing pages](https://forum.typst.app/t/how-can-i-suppress-headers-and-footers-on-blank-verso-trailing-pages/4384/8):\n\nWe use a show rule \"trick\" to make pagebreaks detectable.\n```typ\n// make pagebreaks detectable\n#show pagebreak: it => {\n  [#metadata(none) <empty-page-start>]\n  it\n  [#metadata(none) <empty-page-end>]\n}\n```\n[quote=\"quachpas, post:4, topic:4384\"]\nAs for the trick used here, very briefly, because a [`pagebreak`](https://typst.app/docs/reference/layout/pagebreak) is also an element, then you can re-define it to also raise a “start” and an “end” flag ([metadata](https://typst.app/docs/reference/introspection/metadata/)), and return “yes, the page is empty”, if you are currently between any of these two flags.\n[/quote]\n\n@Andrew was confused about this, because he thought a `pagebreak()` was just a command.\n[quote=\"Andrew, post:8, topic:4384\"]\nI was actually also confused at this. A neat trick. So `pagebreak` is not just a command, but an element that can span a long way, even a whole page?\n[/quote]",
      "reply_to_post_number": null,
      "reply_count": 0,
      "quote_count": 0,
      "like_count": 0,
      "reads": 28,
      "score": 15.2,
      "accepted_answer": false,
      "trust_level": 3,
      "user_id": 258
    },
    {
      "id": 13744,
      "post_number": 2,
      "username": "quachpas",
      "name": "Pascal Quach",
      "created_at": "2025-06-05T10:54:07.025Z",
      "updated_at": "2025-06-05T11:37:40.487Z",
      "cooked": "<p>Yes, for all intents and purposes a <code>pagebreak</code> is an element. I think you can find more elements than you can find non-elements. What I mean by <code>element</code> is the compiler definition of one. See <a href=\"https://forum.typst.app/t/how-can-i-enumerate-every-element-function-in-typst/3642\" class=\"inline-onebox\">How can I enumerate every element function in Typst?</a>. It doesn’t mean the show rule will go well (e.g., with cite).</p>\n<p>For more details, see the <a href=\"https://github.com/typst/typst/blob/494e6a64225261add59c3c9b1cd923bfdfa77961/crates/typst-library/src/layout/page.rs#L372\">page.rs code</a></p>\n<p>Below is “unexpected”, but perfectly acceptable Typst code.</p>\n<pre data-code-wrap=\"typ\"><code class=\"lang-typ\">#show math.overbrace: it =&gt; {\n  it.annotation\n}\n$overbrace(1 + 1, \"sum\")$\n</code></pre>\n<p>For bibliography show rules, it’s very difficult… This is because the bibliography is not very flexible atm. Any reference to a label is first checked against the bibliography, and turned into a citation, but with no referring element.<br>\n<div class=\"lightbox-wrapper\"><a class=\"lightbox\" href=\"https://forum.typst.app/uploads/default/original/2X/9/99bbc6aa8cf24bd38c8624cb05da153eac4c279e.png\" data-download-href=\"https://forum.typst.app/uploads/default/99bbc6aa8cf24bd38c8624cb05da153eac4c279e\" title=\"image\"><img src=\"https://forum.typst.app/uploads/default/original/2X/9/99bbc6aa8cf24bd38c8624cb05da153eac4c279e.png\" alt=\"image\" data-base62-sha1=\"lVZmoNe1SijOCCHNgmvjHbM30jY\" width=\"690\" height=\"407\" data-dominant-color=\"2D1C38\"><div class=\"meta\"><svg class=\"fa d-icon d-icon-far-image svg-icon\" aria-hidden=\"true\"><use href=\"#far-image\"></use></svg><span class=\"filename\">image</span><span class=\"informations\">701×414 36.1 KB</span><svg class=\"fa d-icon d-icon-discourse-expand svg-icon\" aria-hidden=\"true\"><use href=\"#discourse-expand\"></use></svg></div></a></div></p>\n<pre data-code-wrap=\"typ\"><code class=\"lang-typ\">#show cite: it =&gt; { // Do not do this\n  ref(it.key) // it's a trap! (infinite loop)\n}\n#show ref: it =&gt; {\n  // how to detect if the ref is to a bibliography item? \n  // it.element == none?\n  // not very satisfying!\n}\n</code></pre>",
      "raw": "\nYes, for all intents and purposes a `pagebreak` is an element. I think you can find more elements than you can find non-elements. What I mean by `element` is the compiler definition of one. See https://forum.typst.app/t/how-can-i-enumerate-every-element-function-in-typst/3642. It doesn't mean the show rule will go well (e.g., with cite).\n\nFor more details, see the [page.rs code](https://github.com/typst/typst/blob/494e6a64225261add59c3c9b1cd923bfdfa77961/crates/typst-library/src/layout/page.rs#L372)\n\nBelow is \"unexpected\", but perfectly acceptable Typst code.\n```typ\n#show math.overbrace: it => {\n  it.annotation\n}\n$overbrace(1 + 1, \"sum\")$\n```\n\nFor bibliography show rules, it's very difficult... This is because the bibliography is not very flexible atm. Any reference to a label is first checked against the bibliography, and turned into a citation, but with no referring element.\n![image|690x407](upload://lVZmoNe1SijOCCHNgmvjHbM30jY.png)\n\n```typ\n#show cite: it => { // Do not do this\n  ref(it.key) // it's a trap! (infinite loop)\n}\n#show ref: it => {\n  // how to detect if the ref is to a bibliography item? \n  // it.element == none?\n  // not very satisfying!\n}\n```",
      "reply_to_post_number": null,
      "reply_count": 1,
      "quote_count": 0,
      "like_count": 0,
      "reads": 20,
      "score": 8.6,
      "accepted_answer": true,
      "trust_level": 3,
      "user_id": 258
    },
    {
      "id": 13748,
      "post_number": 3,
      "username": "sijo",
      "name": "",
      "created_at": "2025-06-05T11:31:34.961Z",
      "updated_at": "2025-06-05T11:32:49.758Z",
      "cooked": "<aside class=\"quote no-group\" data-username=\"quachpas\" data-post=\"2\" data-topic=\"4473\">\n<div class=\"title\">\n<div class=\"quote-controls\"></div>\n<img alt=\"\" width=\"24\" height=\"24\" src=\"https://forum.typst.app/letter_avatar_proxy/v4/letter/q/662200/48.png\" class=\"avatar\"> quachpas:</div>\n<blockquote>\n<p>a <code>pagebreak</code> is treated like an element (but does not create one)</p>\n</blockquote>\n</aside>\n<p>In what sense does it not create an element? The <code>page</code> code is a bit orthogonal, the comment there is about the absence of a “page element” rather than pagebreak.</p>\n<p>For example the following code</p>\n<pre data-code-wrap=\"typ\"><code class=\"lang-typ\">#show: repr\n= A\n#pagebreak()\n= B\n</code></pre>\n<p>shows</p>\n<pre><code class=\"lang-plaintext\">sequence(\n  heading(depth: 1, body: [A]),\n  [ ],\n  pagebreak(),\n  [ ],\n  heading(depth: 1, body: [B]),\n  parbreak(),\n)\n</code></pre>\n<p>As far as I can see there is a real <code>pagebreak</code> element in the sequence.</p>\n<p>Maybe there’s a confusion between page breaks (which are explicit markers to request a new page) and pages. Compiling <code>#lorem(10000)</code> will generate multiple pages without a single page break and in this case <code>#show pagebreak: ...</code> won’t match anything.</p>\n<p>(Regarding the <code>math.overbrace</code> and <code>ref</code> things I’m a bit confused, are you sure they belong to this post?)</p>",
      "raw": "[quote=\"quachpas, post:2, topic:4473\"]\na `pagebreak` is treated like an element (but does not create one)\n[/quote]\n\nIn what sense does it not create an element? The `page` code is a bit orthogonal, the comment there is about the absence of a \"page element\" rather than pagebreak.\n\nFor example the following code\n\n```\n#show: repr\n= A\n#pagebreak()\n= B\n```\n\nshows\n\n```text\nsequence(\n  heading(depth: 1, body: [A]),\n  [ ],\n  pagebreak(),\n  [ ],\n  heading(depth: 1, body: [B]),\n  parbreak(),\n)\n```\n\nAs far as I can see there is a real `pagebreak` element in the sequence.\n\nMaybe there's a confusion between page breaks (which are explicit markers to request a new page) and pages. Compiling `#lorem(10000)` will generate multiple pages without a single page break and in this case `#show pagebreak: ...` won't match anything.\n\n(Regarding the `math.overbrace` and `ref` things I'm a bit confused, are you sure they belong to this post?)",
      "reply_to_post_number": 2,
      "reply_count": 2,
      "quote_count": 1,
      "like_count": 3,
      "reads": 20,
      "score": 88.6,
      "accepted_answer": false,
      "trust_level": 3,
      "user_id": 332
    },
    {
      "id": 13749,
      "post_number": 4,
      "username": "quachpas",
      "name": "Pascal Quach",
      "created_at": "2025-06-05T11:36:29.685Z",
      "updated_at": "2025-06-05T11:36:29.685Z",
      "cooked": "<aside class=\"quote no-group\" data-username=\"sijo\" data-post=\"3\" data-topic=\"4473\">\n<div class=\"title\">\n<div class=\"quote-controls\"></div>\n<img alt=\"\" width=\"24\" height=\"24\" src=\"https://forum.typst.app/letter_avatar_proxy/v4/letter/s/0A3649/48.png\" class=\"avatar\"> sijo:</div>\n<blockquote>\n<p>In what sense does it not create an element? The <code>page</code> code is a bit orthogonal, the comment there is about the absence of a “page element” rather than pagebreak.</p>\n</blockquote>\n</aside>\n<p>Ah you’re quite right! I read too fast. I will correct it.</p>",
      "raw": "[quote=\"sijo, post:3, topic:4473\"]\nIn what sense does it not create an element? The `page` code is a bit orthogonal, the comment there is about the absence of a “page element” rather than pagebreak.\n[/quote]\n\nAh you're quite right! I read too fast. I will correct it.",
      "reply_to_post_number": 3,
      "reply_count": 0,
      "quote_count": 1,
      "like_count": 0,
      "reads": 18,
      "score": 3.2,
      "accepted_answer": false,
      "trust_level": 3,
      "user_id": 258
    },
    {
      "id": 13760,
      "post_number": 5,
      "username": "quachpas",
      "name": "Pascal Quach",
      "created_at": "2025-06-05T14:15:53.989Z",
      "updated_at": "2025-06-05T14:15:53.989Z",
      "cooked": "<aside class=\"quote no-group\" data-username=\"sijo\" data-post=\"3\" data-topic=\"4473\">\n<div class=\"title\">\n<div class=\"quote-controls\"></div>\n<img alt=\"\" width=\"24\" height=\"24\" src=\"https://forum.typst.app/letter_avatar_proxy/v4/letter/s/0A3649/48.png\" class=\"avatar\"> sijo:</div>\n<blockquote>\n<p>(Regarding the <code>math.overbrace</code> and <code>ref</code> things I’m a bit confused, are you sure they belong to this post?)</p>\n</blockquote>\n</aside>\n<p>I was expanding on the topic of elements by picking at something that is unexpectedly an element, e.g., “math.overbrace”, and the fact that some elements that in theory should exist, don’t, e.g., bibliography items.</p>",
      "raw": "[quote=\"sijo, post:3, topic:4473\"]\n(Regarding the `math.overbrace` and `ref` things I’m a bit confused, are you sure they belong to this post?)\n[/quote]\n\nI was expanding on the topic of elements by picking at something that is unexpectedly an element, e.g., \"math.overbrace\", and the fact that some elements that in theory should exist, don't, e.g., bibliography items.",
      "reply_to_post_number": 3,
      "reply_count": 0,
      "quote_count": 1,
      "like_count": 0,
      "reads": 17,
      "score": 3.0,
      "accepted_answer": false,
      "trust_level": 3,
      "user_id": 258
    },
    {
      "id": 13793,
      "post_number": 6,
      "username": "Andrew",
      "name": "",
      "created_at": "2025-06-05T19:33:54.409Z",
      "updated_at": "2025-06-05T19:36:13.307Z",
      "cooked": "<p>I thought <code>pagebreak</code> is as long as a <code>state.update</code> or <code>metadata</code> — you can’t do anything with it, and the start/end markers will be in the exact same spot. But apparently pagebreak literally spans a whole page if needed.</p>\n<p>I’m aware that <code>pagebreak</code> is an element. So, the title isn’t actually something that someone asked or interested in answer to (not me).</p>",
      "raw": "I thought `pagebreak` is as long as a `state.update` or `metadata` --- you can't do anything with it, and the start/end markers will be in the exact same spot. But apparently pagebreak literally spans a whole page if needed.\n\nI'm aware that `pagebreak` is an element. So, the title isn't actually something that someone asked or interested in answer to (not me).",
      "reply_to_post_number": null,
      "reply_count": 0,
      "quote_count": 0,
      "like_count": 0,
      "reads": 15,
      "score": 12.8,
      "accepted_answer": false,
      "trust_level": 3,
      "user_id": 51
    }
  ],
  "scraped_at": "2025-06-10T09:46:45.004020"
}