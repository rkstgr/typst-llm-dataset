{
  "topic_metadata": {
    "id": 2103,
    "title": "How to reference a figure from a variable?",
    "slug": "how-to-reference-a-figure-from-a-variable",
    "posts_count": 3,
    "created_at": "2024-12-15T20:00:54.623Z",
    "last_posted_at": "2024-12-15T22:01:43.706Z",
    "views": 230,
    "like_count": 0,
    "reply_count": 1,
    "has_accepted_answer": true,
    "accepted_answer_post_number": 2,
    "accepted_answer_username": "flokl",
    "tags": [
      "scripting",
      "figures"
    ],
    "category_id": 5,
    "participant_count": 2,
    "word_count": 264
  },
  "posts": [
    {
      "id": 6658,
      "post_number": 1,
      "username": "Stine",
      "name": "Stine",
      "created_at": "2024-12-15T20:00:54.780Z",
      "updated_at": "2024-12-16T05:44:06.059Z",
      "cooked": "<p>Iâ€™m trying to refer to my figure, but the figure label name is stored in a variable.</p>\n<p>If I did not have a mix of tables and figures in my document <code>counter(figure).at(label(\"sample_c\"))</code> would work. However as I have a table first this is included in the counter.</p>\n<p>Here is my attempts:</p>\n<pre data-code-wrap=\"typ\"><code class=\"lang-typ\">#figure(\n  table(columns:2,[test],[test]),\n  caption: [A table],\n  kind: table\n) &lt;table_1&gt;\n\n#let samples = ((tag:\"a\"),(tag:\"b\"),(tag:\"c\"),)\n#for s in samples {\n  block([\n  #figure(\n    [Some figure],\n    caption: [Statistics for measurement #s.tag.],\n    ) #label(\"sample_\" + s.tag)        \n  ])\n}\n\n// The below of cause works as expected\n@sample_c \\\n@table_1\n\n// But if I have the lable name in a variable I struggle to get the correct figure number\n// The counter does not differentiate between tables and figures.\n#context locate(label(\"sample_c\")).position()\n\n#context counter(figure).at(label(\"sample_c\")) // The figure number is 3 - Returns 4 as the table is counted as well\n</code></pre>",
      "raw": "I'm trying to refer to my figure, but the figure label name is stored in a variable.\n\nIf I did not have a mix of tables and figures in my document ``` counter(figure).at(label(\"sample_c\")) ``` would work. However as I have a table first this is included in the counter.\n\nHere is my attempts:\n\n```typ\n#figure(\n  table(columns:2,[test],[test]),\n  caption: [A table],\n  kind: table\n) <table_1>\n\n#let samples = ((tag:\"a\"),(tag:\"b\"),(tag:\"c\"),)\n#for s in samples {\n  block([\n  #figure(\n    [Some figure],\n    caption: [Statistics for measurement #s.tag.],\n    ) #label(\"sample_\" + s.tag)        \n  ])\n}\n\n// The below of cause works as expected\n@sample_c \\\n@table_1\n\n// But if I have the lable name in a variable I struggle to get the correct figure number\n// The counter does not differentiate between tables and figures.\n#context locate(label(\"sample_c\")).position()\n\n#context counter(figure).at(label(\"sample_c\")) // The figure number is 3 - Returns 4 as the table is counted as well\n```",
      "reply_to_post_number": null,
      "reply_count": 0,
      "quote_count": 0,
      "like_count": 0,
      "reads": 29,
      "score": 1020.8,
      "accepted_answer": false,
      "trust_level": 1,
      "user_id": 937
    },
    {
      "id": 6663,
      "post_number": 2,
      "username": "flokl",
      "name": "",
      "created_at": "2024-12-15T20:52:01.887Z",
      "updated_at": "2024-12-15T20:54:18.698Z",
      "cooked": "<p>Hi <a class=\"mention\" href=\"/u/stine\">@Stine</a>,</p>\n<p><code>figure</code> includes all <code>kinds</code> of figures, the built-in kinds <code>image</code>, <code>table</code>, and <code>raw</code>, and custom ones. Typst automatically uses the build in ones: if you wrap a table with a figure, it automatically creates a figure of kind <code>table</code>. By default, and in your case, the 3 figures generated by the <code>for</code> loop are of kind <code>image</code>.</p>\n<p>You can get the correct counter with <code>.where(kind: image)</code>.</p>\n<pre data-code-wrap=\"typ\"><code class=\"lang-typ\">#context counter(figure.where(kind: image)).at(label(\"sample_c\"))\n</code></pre>\n<p>If you do something special with your figures I would recommend to use a custom <code>kind</code>.</p>",
      "raw": "Hi @Stine,\n\n`figure` includes all `kinds` of figures, the built-in kinds `image`, `table`, and `raw`, and custom ones. Typst automatically uses the build in ones: if you wrap a table with a figure, it automatically creates a figure of kind `table`. By default, and in your case, the 3 figures generated by the `for` loop are of kind `image`.\n\nYou can get the correct counter with `.where(kind: image)`.\n```typ\n#context counter(figure.where(kind: image)).at(label(\"sample_c\"))\n```\nIf you do something special with your figures I would recommend to use a custom `kind`.",
      "reply_to_post_number": null,
      "reply_count": 1,
      "quote_count": 0,
      "like_count": 0,
      "reads": 28,
      "score": 25.6,
      "accepted_answer": true,
      "trust_level": 3,
      "user_id": 8
    },
    {
      "id": 6666,
      "post_number": 3,
      "username": "Stine",
      "name": "Stine",
      "created_at": "2024-12-15T22:01:43.706Z",
      "updated_at": "2024-12-15T22:01:43.706Z",
      "cooked": "<p>Thanks a lot for your time, this was just what I needed.</p>",
      "raw": "Thanks a lot for your time, this was just what I needed.",
      "reply_to_post_number": 2,
      "reply_count": 0,
      "quote_count": 0,
      "like_count": 0,
      "reads": 28,
      "score": 5.6,
      "accepted_answer": false,
      "trust_level": 1,
      "user_id": 937
    }
  ],
  "scraped_at": "2025-06-10T09:53:35.874323"
}