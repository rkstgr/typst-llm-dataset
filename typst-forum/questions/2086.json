{
  "topic_metadata": {
    "id": 2086,
    "title": "How to reset the line number counter?",
    "slug": "how-to-reset-the-line-number-counter",
    "posts_count": 5,
    "created_at": "2024-12-13T22:25:02.521Z",
    "last_posted_at": "2024-12-15T20:40:59.990Z",
    "views": 283,
    "like_count": 3,
    "reply_count": 1,
    "has_accepted_answer": true,
    "accepted_answer_post_number": 4,
    "accepted_answer_username": "PgBiel",
    "tags": [
      "scripting"
    ],
    "category_id": 5,
    "participant_count": 3,
    "word_count": 540
  },
  "posts": [
    {
      "id": 6614,
      "post_number": 1,
      "username": "Timo",
      "name": "Timo",
      "created_at": "2024-12-13T22:25:02.640Z",
      "updated_at": "2024-12-15T06:59:20.916Z",
      "cooked": "<p>Hello,</p>\n<p>I am currently writing a document where I have some appendix which requires to be have line numbers. Unfortunately, I have 4 chapters which need line numbers individually (each chapter starting from 1 again). I know this might be possible with raw text, but I really would like to use normal text and just reset the counter if possible.</p>\n<p>What I tried was using <code>#set par.line(numbering-scope: \"page\")</code>, but this resulted in the start of new numbers on every new page. This does not work for me, because my content is longer than one page. I also tried resetting the counter like so <code>#counter(par.line).update(0)</code>, but this did not have any effect as well.</p>\n<p>Did any of you faced this issue before or know a solution to my problem?</p>\n<p>Thanks!</p>",
      "raw": "Hello,\n\nI am currently writing a document where I have some appendix which requires to be have line numbers. Unfortunately, I have 4 chapters which need line numbers individually (each chapter starting from 1 again). I know this might be possible with raw text, but I really would like to use normal text and just reset the counter if possible.\n\nWhat I tried was using `#set par.line(numbering-scope: \"page\")`, but this resulted in the start of new numbers on every new page. This does not work for me, because my content is longer than one page. I also tried resetting the counter like so `#counter(par.line).update(0)`, but this did not have any effect as well.\n\nDid any of you faced this issue before or know a solution to my problem?\n\nThanks!",
      "reply_to_post_number": null,
      "reply_count": 0,
      "quote_count": 0,
      "like_count": 0,
      "reads": 42,
      "score": 1133.4,
      "accepted_answer": false,
      "trust_level": 1,
      "user_id": 130
    },
    {
      "id": 6616,
      "post_number": 2,
      "username": "ParaN3xus",
      "name": "ParaN3xus",
      "created_at": "2024-12-14T03:12:46.880Z",
      "updated_at": "2024-12-14T03:12:46.880Z",
      "cooked": "<p>I think this is currently not possible. According to the <a href=\"https://github.com/typst/typst/blob/a3ad0a0bba3ce3abb1d8ed84656f54cc2d74be25/crates/typst-layout/src/flow/compose.rs#L836\">comments</a> for <code>layout-line-number</code> in <code>crates/typst-layout/src/flow/compose.rs</code> , the <code>par.line</code> counter is currently different from normal counters, so this counter is not exposed to users through <code>counter(par.line)</code> or any other means.</p>",
      "raw": "I think this is currently not possible. According to the [comments](https://github.com/typst/typst/blob/a3ad0a0bba3ce3abb1d8ed84656f54cc2d74be25/crates/typst-layout/src/flow/compose.rs#L836) for `layout-line-number` in `crates/typst-layout/src/flow/compose.rs` , the `par.line` counter is currently different from normal counters, so this counter is not exposed to users through `counter(par.line)` or any other means.",
      "reply_to_post_number": null,
      "reply_count": 0,
      "quote_count": 0,
      "like_count": 1,
      "reads": 40,
      "score": 73.0,
      "accepted_answer": false,
      "trust_level": 2,
      "user_id": 14
    },
    {
      "id": 6639,
      "post_number": 3,
      "username": "PgBiel",
      "name": "",
      "created_at": "2024-12-15T07:01:36.568Z",
      "updated_at": "2024-12-15T07:01:36.568Z",
      "cooked": "<p>Hey <a class=\"mention\" href=\"/u/timo\">@Timo</a>, welcome to the forum! In addition to adding a tag to your post, I’ve changed your question post’s title to better fit our guidelines: <a href=\"https://forum.typst.app/t/how-to-post-in-the-questions-category/11\" class=\"inline-onebox\">How to post in the Questions category</a></p>\n<p>For future posts, make sure your title is a question you’d ask to a friend about Typst. <img src=\"https://forum.typst.app/images/emoji/apple/wink.png?v=12\" title=\":wink:\" class=\"emoji\" alt=\":wink:\" loading=\"lazy\" width=\"20\" height=\"20\"></p>",
      "raw": "Hey @Timo, welcome to the forum! In addition to adding a tag to your post, I’ve changed your question post’s title to better fit our guidelines: https://forum.typst.app/t/how-to-post-in-the-questions-category/11\n\nFor future posts, make sure your title is a question you’d ask to a friend about Typst. :wink:",
      "reply_to_post_number": null,
      "reply_count": 1,
      "quote_count": 0,
      "like_count": 1,
      "reads": 34,
      "score": 36.8,
      "accepted_answer": false,
      "trust_level": 2,
      "user_id": 3
    },
    {
      "id": 6640,
      "post_number": 4,
      "username": "PgBiel",
      "name": "",
      "created_at": "2024-12-15T07:11:56.449Z",
      "updated_at": "2024-12-15T07:11:56.449Z",
      "cooked": "<p>As explained by <a class=\"mention\" href=\"/u/paran3xus\">@ParaN3xus</a> above, this is not currently possible due to technical limitations in the compiler. However, <strong>you can do it manually,</strong> if you don’t mind adding some extra code before your chapters. Note that this extra code <strong>has to be updated for a chapter each time you add more text to the previous chapter,</strong> so there’s a bit of a maintenance burden, but it can at least provide the results you are expecting.</p>\n<p>The core idea is that you will add the following code before each chapter:</p>\n<pre data-code-wrap=\"typ\"><code class=\"lang-typ\">// N is the last line number in the previous chapter\n#show: reset-line-numbers-from(N)\n</code></pre>\n<p>You will have to update N manually as you add more lines. (You don’t have to do this all the time - you can choose to only do it when exporting, for example.)</p>\n<p>Here’s the code, and some sample usage:</p>\n<pre data-code-wrap=\"typ\"><code class=\"lang-typ\">// /!\\ Pick your numbering format here /!\\\n#let num-format = \"1.\"\n#set par.line(numbering: num-format)\n\n#let reset-line-numbers-from(n, format: num-format) = doc =&gt; context {\n  let previous-n = counter(\"par-line-reset\").get().first()\n  set par.line(numbering: line =&gt; numbering(format, line - n - previous-n))\n  counter(\"par-line-reset\").update(count =&gt; count + n)\n  doc\n}\n\n// Sample usage:\n\n= ABC\n\nHello world\n\n// Replace '2' with the last line number before here\n#show: reset-line-numbers-from(2)\n\n= Other chapter\n\nHello\n\nworld \\\na \\\na \\\na \\\nb\n\n// Line number of 'b' was 7\n#show: reset-line-numbers-from(7)\n\n= My own chapter\n\nThis\n\nis a\n\nchapter\n\n#show: reset-line-numbers-from(4)\n\n= My own chapter\n</code></pre>\n<p><img src=\"https://forum.typst.app/uploads/default/original/2X/1/1debb74af9ef1738f05281279096fda6b3973b19.png\" alt=\"output: line numbers reset at each chapter\" data-base62-sha1=\"4gGRGcC4kkgDbdRsq2q8GLFMiBH\" width=\"284\" height=\"472\"></p>",
      "raw": "As explained by @ParaN3xus above, this is not currently possible due to technical limitations in the compiler. However, **you can do it manually,** if you don't mind adding some extra code before your chapters. Note that this extra code **has to be updated for a chapter each time you add more text to the previous chapter,** so there's a bit of a maintenance burden, but it can at least provide the results you are expecting.\n\nThe core idea is that you will add the following code before each chapter:\n\n```typ\n// N is the last line number in the previous chapter\n#show: reset-line-numbers-from(N)\n```\n\nYou will have to update N manually as you add more lines. (You don't have to do this all the time - you can choose to only do it when exporting, for example.)\n\nHere's the code, and some sample usage:\n\n```typ\n// /!\\ Pick your numbering format here /!\\\n#let num-format = \"1.\"\n#set par.line(numbering: num-format)\n\n#let reset-line-numbers-from(n, format: num-format) = doc => context {\n  let previous-n = counter(\"par-line-reset\").get().first()\n  set par.line(numbering: line => numbering(format, line - n - previous-n))\n  counter(\"par-line-reset\").update(count => count + n)\n  doc\n}\n\n// Sample usage:\n\n= ABC\n\nHello world\n\n// Replace '2' with the last line number before here\n#show: reset-line-numbers-from(2)\n\n= Other chapter\n\nHello\n\nworld \\\na \\\na \\\na \\\nb\n\n// Line number of 'b' was 7\n#show: reset-line-numbers-from(7)\n\n= My own chapter\n\nThis\n\nis a\n\nchapter\n\n#show: reset-line-numbers-from(4)\n\n= My own chapter\n```\n\n![output: line numbers reset at each chapter|284x472](upload://4gGRGcC4kkgDbdRsq2q8GLFMiBH.png)",
      "reply_to_post_number": null,
      "reply_count": 0,
      "quote_count": 0,
      "like_count": 1,
      "reads": 32,
      "score": 46.4,
      "accepted_answer": true,
      "trust_level": 2,
      "user_id": 3
    },
    {
      "id": 6661,
      "post_number": 5,
      "username": "Timo",
      "name": "Timo",
      "created_at": "2024-12-15T20:40:59.990Z",
      "updated_at": "2024-12-15T20:40:59.990Z",
      "cooked": "<p>Thanks, I will make sure next time <img src=\"https://forum.typst.app/images/emoji/apple/smiley.png?v=12\" title=\":smiley:\" class=\"emoji\" alt=\":smiley:\" loading=\"lazy\" width=\"20\" height=\"20\"></p>",
      "raw": "Thanks, I will make sure next time :smiley:",
      "reply_to_post_number": 3,
      "reply_count": 0,
      "quote_count": 0,
      "like_count": 0,
      "reads": 22,
      "score": 4.4,
      "accepted_answer": false,
      "trust_level": 1,
      "user_id": 130
    }
  ],
  "scraped_at": "2025-06-10T09:53:38.850244"
}