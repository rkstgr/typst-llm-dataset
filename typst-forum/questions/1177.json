{
  "topic_metadata": {
    "id": 1177,
    "title": "How can I use attach in such a way that the layout is not affected?",
    "slug": "how-can-i-use-attach-in-such-a-way-that-the-layout-is-not-affected",
    "posts_count": 7,
    "created_at": "2024-10-18T05:59:30.879Z",
    "last_posted_at": "2024-10-18T07:38:06.478Z",
    "views": 132,
    "like_count": 2,
    "reply_count": 5,
    "has_accepted_answer": true,
    "accepted_answer_post_number": 6,
    "accepted_answer_username": "sijo",
    "tags": [],
    "category_id": 5,
    "participant_count": 3,
    "word_count": 472
  },
  "posts": [
    {
      "id": 4145,
      "post_number": 1,
      "username": "Bryn",
      "name": "Bryn Humberstone",
      "created_at": "2024-10-18T05:59:30.972Z",
      "updated_at": "2024-10-18T05:59:30.972Z",
      "cooked": "<p>I am trying to lay out some school-level mathematics and I’d like to show the borrowing/relabelling involved in a subtraction. The closest I can get is shown below, but you can see that when I add the workings (in red), this moves the digits ‘5’ and ‘2’ so they are no longer aligned.</p>\n<p><div class=\"lightbox-wrapper\"><a class=\"lightbox\" href=\"https://forum.typst.app/uploads/default/original/1X/faa8793d5f66dc83881acc6583b9ed28ebe9c780.png\" data-download-href=\"https://forum.typst.app/uploads/default/faa8793d5f66dc83881acc6583b9ed28ebe9c780\" title=\"image\"><img src=\"https://forum.typst.app/uploads/default/optimized/1X/faa8793d5f66dc83881acc6583b9ed28ebe9c780_2_318x375.png\" alt=\"image\" data-base62-sha1=\"zLqjSsIsBCx2XnDLhWgCX0qkiyY\" width=\"318\" height=\"375\" srcset=\"https://forum.typst.app/uploads/default/optimized/1X/faa8793d5f66dc83881acc6583b9ed28ebe9c780_2_318x375.png, https://forum.typst.app/uploads/default/optimized/1X/faa8793d5f66dc83881acc6583b9ed28ebe9c780_2_477x562.png 1.5x, https://forum.typst.app/uploads/default/original/1X/faa8793d5f66dc83881acc6583b9ed28ebe9c780.png 2x\" data-dominant-color=\"F3F3F3\"><div class=\"meta\"><svg class=\"fa d-icon d-icon-far-image svg-icon\" aria-hidden=\"true\"><use href=\"#far-image\"></use></svg><span class=\"filename\">image</span><span class=\"informations\">611×719 51.5 KB</span><svg class=\"fa d-icon d-icon-discourse-expand svg-icon\" aria-hidden=\"true\"><use href=\"#discourse-expand\"></use></svg></div></a></div></p>\n<p>The second part of the diagram was generated using the code below.</p>\n<pre data-code-wrap=\"typ\"><code class=\"lang-typ\">$#grid(columns:5,\nalign: center,\nstroke: (x, y) =&gt; if y == 2  and x &gt;= 0 { (top: 0.4pt + black) },\ninset: (x, y) =&gt; if x == 2 { (x: 0pt, y: 3pt) } else { (x: 2pt, y: 3pt) },\n[], [$attach(tl: #text(red)[4], cancel(stroke: #(paint: red), 5))$], [.], [$attach(2, tl: #text(red)[1])$], [7],\n[$minus$], [3], [.], [4], [2], \n[], [1], [.], [8], [5])$\n</code></pre>\n<p>I couldn’t work out how to use <code>place</code> (or something else) to make it so the attachments did not affect the layout of the original text shown in black.</p>",
      "raw": "I am trying to lay out some school-level mathematics and I'd like to show the borrowing/relabelling involved in a subtraction. The closest I can get is shown below, but you can see that when I add the workings (in red), this moves the digits '5' and '2' so they are no longer aligned. \n\n![image|424x500, 75%](upload://zLqjSsIsBCx2XnDLhWgCX0qkiyY.png)\n\nThe second part of the diagram was generated using the code below. \n\n```typ\n$#grid(columns:5,\nalign: center,\nstroke: (x, y) => if y == 2  and x >= 0 { (top: 0.4pt + black) },\ninset: (x, y) => if x == 2 { (x: 0pt, y: 3pt) } else { (x: 2pt, y: 3pt) },\n[], [$attach(tl: #text(red)[4], cancel(stroke: #(paint: red), 5))$], [.], [$attach(2, tl: #text(red)[1])$], [7],\n[$minus$], [3], [.], [4], [2], \n[], [1], [.], [8], [5])$\n```\n\nI couldn't work out how to use `place` (or something else) to make it so the attachments did not affect the layout of the original text shown in black.",
      "reply_to_post_number": null,
      "reply_count": 0,
      "quote_count": 0,
      "like_count": 0,
      "reads": 33,
      "score": 526.6,
      "accepted_answer": false,
      "trust_level": 2,
      "user_id": 389
    },
    {
      "id": 4146,
      "post_number": 2,
      "username": "quachpas",
      "name": "Pascal Quach",
      "created_at": "2024-10-18T06:10:39.296Z",
      "updated_at": "2024-10-18T06:10:39.296Z",
      "cooked": "<p>Would aligning your columns <code>right</code> help you?</p>\n<p><img src=\"https://forum.typst.app/uploads/default/original/1X/181d8e5e09c069f9167245c14da2fddacdb382e4.png\" alt=\"image\" data-base62-sha1=\"3rkMxOFWwZcK5teStgdPrn3RSK0\" width=\"416\" height=\"288\"></p>",
      "raw": "Would aligning your columns `right` help you?\n\n![image|416x288](upload://3rkMxOFWwZcK5teStgdPrn3RSK0.png)",
      "reply_to_post_number": null,
      "reply_count": 1,
      "quote_count": 0,
      "like_count": 1,
      "reads": 30,
      "score": 26.0,
      "accepted_answer": false,
      "trust_level": 3,
      "user_id": 258
    },
    {
      "id": 4148,
      "post_number": 3,
      "username": "Bryn",
      "name": "Bryn Humberstone",
      "created_at": "2024-10-18T06:25:55.200Z",
      "updated_at": "2024-10-18T06:26:41.410Z",
      "cooked": "<p>Thanks for this suggestion, which I had not considered. One issue is that the decimal points are not centred nicely (but I can change it to center that column), but a bigger issue is the fact that columns with attachments are much wider.</p>\n<p>I would like it to have the exact same width as the original grid, but just with the items attached, but as you can see, it is now much wider.<br>\n<img src=\"https://forum.typst.app/uploads/default/original/1X/8a5a2463444b641f15c66f67a2acedcd26e9365f.png\" alt=\"image\" data-base62-sha1=\"jJV1dd1fchTNtoe91YqfvgQPEsf\" width=\"174\" height=\"245\"></p>",
      "raw": "Thanks for this suggestion, which I had not considered. One issue is that the decimal points are not centred nicely (but I can change it to center that column), but a bigger issue is the fact that columns with attachments are much wider.\n\nI would like it to have the exact same width as the original grid, but just with the items attached, but as you can see, it is now much wider.\n![image|349x490, 50%](upload://jJV1dd1fchTNtoe91YqfvgQPEsf.png)",
      "reply_to_post_number": 2,
      "reply_count": 1,
      "quote_count": 0,
      "like_count": 0,
      "reads": 30,
      "score": 10.8,
      "accepted_answer": false,
      "trust_level": 2,
      "user_id": 389
    },
    {
      "id": 4151,
      "post_number": 4,
      "username": "quachpas",
      "name": "Pascal Quach",
      "created_at": "2024-10-18T06:53:59.926Z",
      "updated_at": "2024-10-18T06:53:59.926Z",
      "cooked": "<p>I think, you should use place in that case for absolute positioning. <code>dx</code> and <code>dy</code> should get your supscript in the right place!</p>",
      "raw": "I think, you should use place in that case for absolute positioning. `dx` and `dy` should get your supscript in the right place!",
      "reply_to_post_number": 3,
      "reply_count": 1,
      "quote_count": 0,
      "like_count": 0,
      "reads": 28,
      "score": 20.4,
      "accepted_answer": false,
      "trust_level": 3,
      "user_id": 258
    },
    {
      "id": 4152,
      "post_number": 5,
      "username": "Bryn",
      "name": "Bryn Humberstone",
      "created_at": "2024-10-18T06:57:26.633Z",
      "updated_at": "2024-10-18T06:57:26.633Z",
      "cooked": "<p>I couldn’t work out how to get place to work with the attach function though. I also couldn’t really work out how to manufacture the right appearance of small text using place directly.</p>",
      "raw": "I couldn’t work out how to get place to work with the attach function though. I also couldn’t really work out how to manufacture the right appearance of small text using place directly.",
      "reply_to_post_number": 4,
      "reply_count": 1,
      "quote_count": 0,
      "like_count": 0,
      "reads": 28,
      "score": 15.4,
      "accepted_answer": false,
      "trust_level": 2,
      "user_id": 389
    },
    {
      "id": 4153,
      "post_number": 6,
      "username": "sijo",
      "name": "",
      "created_at": "2024-10-18T07:31:08.127Z",
      "updated_at": "2024-10-18T07:31:08.127Z",
      "cooked": "<p>The following seems to work:</p>\n<pre data-code-wrap=\"typ\"><code class=\"lang-typ\">#let annotate(it, with: none) = math.attach(it, tl: box(\n  place(\n    bottom+right,\n    text(red, with),\n)))\n\n#let strike = math.cancel.with(stroke: red)\n\n#grid(\n  columns:5,\n  align: center,\n  stroke: (x, y) =&gt; if y == 2  and x &gt;= 0 { (top: 0.4pt + black) },\n  inset: (x, y) =&gt; if x == 2 { (x: 0pt, y: 3pt) } else { (x: 2pt, y: 3pt) },\n  [], $annotate(strike(5), with: 4)$, $.$, $annotate(2, with: 1)$, $7$,\n  $-$, $3$, $.$, $4$, $2$, \n  $$, $1$, $.$, $8$, $5$,\n)\n</code></pre>\n<p><img src=\"https://forum.typst.app/uploads/default/original/1X/5067a36ee15c2be7fc6bd34cdd6e739cf265003e.png\" alt=\"image\" data-base62-sha1=\"btieZT8qJwxpS2JITRUwl5Vpvqe\" width=\"114\" height=\"76\"></p>\n<p>I put the <code>place</code> call in a box: the placed content doesn’t take any space so the box will be zero-size, at the correct position. Aligning the bottom-right of the placed content with the (bottom-right of) the zero-sized box works well. (I’m not sure what happens here with spacing when you don’t include the box.)</p>",
      "raw": "The following seems to work:\n\n```typ\n#let annotate(it, with: none) = math.attach(it, tl: box(\n  place(\n    bottom+right,\n    text(red, with),\n)))\n\n#let strike = math.cancel.with(stroke: red)\n\n#grid(\n  columns:5,\n  align: center,\n  stroke: (x, y) => if y == 2  and x >= 0 { (top: 0.4pt + black) },\n  inset: (x, y) => if x == 2 { (x: 0pt, y: 3pt) } else { (x: 2pt, y: 3pt) },\n  [], $annotate(strike(5), with: 4)$, $.$, $annotate(2, with: 1)$, $7$,\n  $-$, $3$, $.$, $4$, $2$, \n  $$, $1$, $.$, $8$, $5$,\n)\n```\n\n![image|114x76](upload://btieZT8qJwxpS2JITRUwl5Vpvqe.png)\n\nI put the `place` call in a box: the placed content doesn't take any space so the box will be zero-size, at the correct position. Aligning the bottom-right of the placed content with the (bottom-right of) the zero-sized box works well. (I'm not sure what happens here with spacing when you don't include the box.)",
      "reply_to_post_number": 5,
      "reply_count": 1,
      "quote_count": 0,
      "like_count": 1,
      "reads": 28,
      "score": 30.4,
      "accepted_answer": true,
      "trust_level": 3,
      "user_id": 332
    },
    {
      "id": 4154,
      "post_number": 7,
      "username": "Bryn",
      "name": "Bryn Humberstone",
      "created_at": "2024-10-18T07:38:06.478Z",
      "updated_at": "2024-10-18T07:38:06.478Z",
      "cooked": "<p>The use of the box was the missing piece of the puzzle for me! Thank you.</p>",
      "raw": "The use of the box was the missing piece of the puzzle for me! Thank you.",
      "reply_to_post_number": 6,
      "reply_count": 0,
      "quote_count": 0,
      "like_count": 0,
      "reads": 26,
      "score": 20.0,
      "accepted_answer": false,
      "trust_level": 2,
      "user_id": 389
    }
  ],
  "scraped_at": "2025-06-10T09:56:34.833786"
}