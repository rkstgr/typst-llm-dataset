{
  "topic_metadata": {
    "id": 2841,
    "title": "Use something like math.attach() in text mode?",
    "slug": "use-something-like-math-attach-in-text-mode",
    "posts_count": 4,
    "created_at": "2025-02-15T15:10:39.864Z",
    "last_posted_at": "2025-02-15T19:01:40.912Z",
    "views": 62,
    "like_count": 2,
    "reply_count": 2,
    "has_accepted_answer": true,
    "accepted_answer_post_number": 2,
    "accepted_answer_username": "sijo",
    "tags": [
      "text-formatting"
    ],
    "category_id": 5,
    "participant_count": 2,
    "word_count": 442
  },
  "posts": [
    {
      "id": 8712,
      "post_number": 1,
      "username": "Mathieu",
      "name": "Mathieu",
      "created_at": "2025-02-15T15:10:39.967Z",
      "updated_at": "2025-02-21T22:48:02.257Z",
      "cooked": "<p>LaTeX lets you do crazy things like placing superscripts and subscripts on both sides of something, applying arbitrary text styles to the different parts of the expression, e.g.:</p>\n<p><img src=\"https://forum.typst.app/uploads/default/original/2X/e/ef0edcad1051ce4c955bae1978f34cd95c0cdad8.png\" alt=\"Screenshot 2025-02-15 at 16.01.26\" data-base62-sha1=\"y6NXljPXxoOztaUuIUTAqagYhpC\" width=\"301\" height=\"136\"></p>\n<p>When I try to do something similar using <code>#attach()</code> in Typst, I can’t apply any text styles, apparently because of how Typst implements math styles.</p>\n<p>Is there a way to attach <strong>text</strong> blocks all around another block while remaining in text mode? In geochemistry one would like to typeset things like this:</p>\n<p><div class=\"lightbox-wrapper\"><a class=\"lightbox\" href=\"https://forum.typst.app/uploads/default/original/2X/0/0c34e9e021410104083736f4da7923f55d8b8f84.png\" data-download-href=\"https://forum.typst.app/uploads/default/0c34e9e021410104083736f4da7923f55d8b8f84\" title=\"Screenshot 2025-02-15 at 16.07.56\"><img src=\"https://forum.typst.app/uploads/default/optimized/2X/0/0c34e9e021410104083736f4da7923f55d8b8f84_2_345x133.png\" alt=\"Screenshot 2025-02-15 at 16.07.56\" data-base62-sha1=\"1JZ5YN0OWeUx8ycyPsceIbOyRRG\" width=\"345\" height=\"133\" srcset=\"https://forum.typst.app/uploads/default/optimized/2X/0/0c34e9e021410104083736f4da7923f55d8b8f84_2_345x133.png, https://forum.typst.app/uploads/default/optimized/2X/0/0c34e9e021410104083736f4da7923f55d8b8f84_2_517x199.png 1.5x, https://forum.typst.app/uploads/default/optimized/2X/0/0c34e9e021410104083736f4da7923f55d8b8f84_2_690x266.png 2x\" data-dominant-color=\"E3E3E3\"><div class=\"meta\"><svg class=\"fa d-icon d-icon-far-image svg-icon\" aria-hidden=\"true\"><use href=\"#far-image\"></use></svg><span class=\"filename\">Screenshot 2025-02-15 at 16.07.56</span><span class=\"informations\">702×272 31.3 KB</span><svg class=\"fa d-icon d-icon-discourse-expand svg-icon\" aria-hidden=\"true\"><use href=\"#discourse-expand\"></use></svg></div></a></div></p>\n<p>In other words, is there a way to duplicate <code>#attach()</code> in text mode?</p>",
      "raw": "LaTeX lets you do crazy things like placing superscripts and subscripts on both sides of something, applying arbitrary text styles to the different parts of the expression, e.g.:\n\n![Screenshot 2025-02-15 at 16.01.26|602x272, 50%](upload://y6NXljPXxoOztaUuIUTAqagYhpC.png)\n\nWhen I try to do something similar using `#attach()` in Typst, I can't apply any text styles, apparently because of how Typst implements math styles.\n\nIs there a way to attach **text** blocks all around another block while remaining in text mode? In geochemistry one would like to typeset things like this:\n\n![Screenshot 2025-02-15 at 16.07.56|690x267, 50%](upload://1JZ5YN0OWeUx8ycyPsceIbOyRRG.png)\n\nIn other words, is there a way to duplicate `#attach()` in text mode?",
      "reply_to_post_number": null,
      "reply_count": 0,
      "quote_count": 0,
      "like_count": 0,
      "reads": 28,
      "score": 120.6,
      "accepted_answer": false,
      "trust_level": 1,
      "user_id": 1200
    },
    {
      "id": 8714,
      "post_number": 2,
      "username": "sijo",
      "name": "",
      "created_at": "2025-02-15T16:26:49.982Z",
      "updated_at": "2025-02-15T16:27:21.404Z",
      "cooked": "<p>The current situation is not ideal and will probably change in the future. One of the difficulties is that it’s often not clear what should be typeset with a math font (which can include seperate glyphs for upright, italic, sans serif…) and what should be typeset with the text font (which can look different from the upright math font).</p>\n<p>Anyway currently, to use the characters from the math font you can do this:</p>\n<pre data-code-wrap=\"typ\"><code class=\"lang-typ\">$\n  attach(\n    upright(O),\n    tl: sans(\"xyz\"),\n    bl: upright(\"abc\"),\n    tr: italic(\"sample\"),\n    br: upright(\"VSMOW\"),\n  )\n$\n</code></pre>\n<p><img src=\"https://forum.typst.app/uploads/default/original/2X/b/b542c2c16c1cf4f40941c1c57850e59d2160c082.png\" alt=\"image\" data-base62-sha1=\"pRvsivD8a31iSNcbZnAy7MpwOPg\" width=\"108\" height=\"38\"></p>\n<p>And to use the text font (and the monospace font for sans serif), as described in <a href=\"https://github.com/typst/typst/issues/366\" rel=\"noopener nofollow ugc\">this issue on GitHub</a> you can define a helper function to include normal text elements in math mode:</p>\n<pre data-code-wrap=\"typ\"><code class=\"lang-typ\">#let mtext = text.with(font: \"Libertinus Serif\")\n\n$\n  attach(\n    upright(O),\n    tl: #`xyz`,\n    bl: #mtext[abc],\n    tr: #mtext[_sample_],\n    br: #mtext[VSMOW],\n  )\n$\n</code></pre>\n<p><img src=\"https://forum.typst.app/uploads/default/original/2X/7/75f4631b64977a0f2cf0f7576213f4b0490ac09b.png\" alt=\"image\" data-base62-sha1=\"gPtsAlsr7DzqVw0KVgWB4HtpKrN\" width=\"107\" height=\"34\"></p>\n<p>Note a related change in Typts 0.13 (the next release): single letter words written in double quotes (for example <code>\"a\"</code>) will be typeset with the upright math instead of italic math font, i.e. single letter words will be treated the same as multi-letter words.</p>",
      "raw": "The current situation is not ideal and will probably change in the future. One of the difficulties is that it's often not clear what should be typeset with a math font (which can include seperate glyphs for upright, italic, sans serif...) and what should be typeset with the text font (which can look different from the upright math font).\n\nAnyway currently, to use the characters from the math font you can do this:\n\n```typ\n$\n  attach(\n    upright(O),\n    tl: sans(\"xyz\"),\n    bl: upright(\"abc\"),\n    tr: italic(\"sample\"),\n    br: upright(\"VSMOW\"),\n  )\n$\n```\n\n![image|216x76, 50%](upload://pRvsivD8a31iSNcbZnAy7MpwOPg.png)\n\nAnd to use the text font (and the monospace font for sans serif), as described in [this issue on GitHub](https://github.com/typst/typst/issues/366) you can define a helper function to include normal text elements in math mode:\n\n```typ\n#let mtext = text.with(font: \"Libertinus Serif\")\n\n$\n  attach(\n    upright(O),\n    tl: #`xyz`,\n    bl: #mtext[abc],\n    tr: #mtext[_sample_],\n    br: #mtext[VSMOW],\n  )\n$\n```\n![image|214x68, 50%](upload://gPtsAlsr7DzqVw0KVgWB4HtpKrN.png)\n\nNote a related change in Typts 0.13 (the next release): single letter words written in double quotes (for example `\"a\"`) will be typeset with the upright math instead of italic math font, i.e. single letter words will be treated the same as multi-letter words.",
      "reply_to_post_number": null,
      "reply_count": 1,
      "quote_count": 0,
      "like_count": 1,
      "reads": 26,
      "score": 55.2,
      "accepted_answer": true,
      "trust_level": 3,
      "user_id": 332
    },
    {
      "id": 8716,
      "post_number": 3,
      "username": "Mathieu",
      "name": "Mathieu",
      "created_at": "2025-02-15T18:34:13.826Z",
      "updated_at": "2025-02-15T18:34:13.826Z",
      "cooked": "<aside class=\"quote no-group\" data-username=\"sijo\" data-post=\"2\" data-topic=\"2841\">\n<div class=\"title\">\n<div class=\"quote-controls\"></div>\n<img loading=\"lazy\" alt=\"\" width=\"24\" height=\"24\" src=\"https://forum.typst.app/letter_avatar_proxy/v4/letter/s/0A3649/48.png\" class=\"avatar\"> sijo:</div>\n<blockquote>\n<p>And to use the text font (and the monospace font for sans serif), as described in <a href=\"https://github.com/typst/typst/issues/366\" rel=\"noopener nofollow ugc\">this issue on GitHub</a> you can define a helper function to include normal text elements in math mode:</p>\n</blockquote>\n</aside>\n<p>Thanks, that sounds great. Is there a way to define the text font (here: <code>Libertinus Serif</code>) dynamically (by introspection), defining it as whatever is used in the current document/context?</p>",
      "raw": "[quote=\"sijo, post:2, topic:2841\"]\nAnd to use the text font (and the monospace font for sans serif), as described in [this issue on GitHub](https://github.com/typst/typst/issues/366) you can define a helper function to include normal text elements in math mode:\n[/quote]\n\nThanks, that sounds great. Is there a way to define the text font (here: `Libertinus Serif`) dynamically (by introspection), defining it as whatever is used in the current document/context?",
      "reply_to_post_number": 2,
      "reply_count": 1,
      "quote_count": 1,
      "like_count": 0,
      "reads": 22,
      "score": 9.4,
      "accepted_answer": false,
      "trust_level": 1,
      "user_id": 1200
    },
    {
      "id": 8719,
      "post_number": 4,
      "username": "sijo",
      "name": "",
      "created_at": "2025-02-15T19:01:40.912Z",
      "updated_at": "2025-02-15T19:01:40.912Z",
      "cooked": "<p>Maybe like this:</p>\n<pre data-code-wrap=\"typ\"><code class=\"lang-typ\">// Do the following wherever you want to capture the current font\n#context state(\"font\").update(text.font)\n\n#let mtext(it) = context text(font: state(\"font\").get(), it)\n</code></pre>",
      "raw": "Maybe like this:\n\n```typ\n// Do the following wherever you want to capture the current font\n#context state(\"font\").update(text.font)\n\n#let mtext(it) = context text(font: state(\"font\").get(), it)\n```",
      "reply_to_post_number": 3,
      "reply_count": 0,
      "quote_count": 0,
      "like_count": 1,
      "reads": 19,
      "score": 18.8,
      "accepted_answer": false,
      "trust_level": 3,
      "user_id": 332
    }
  ],
  "scraped_at": "2025-06-10T09:51:32.729455"
}