{
  "topic_metadata": {
    "id": 1605,
    "title": "How to share bibliography in a multi-file setup?",
    "slug": "how-to-share-bibliography-in-a-multi-file-setup",
    "posts_count": 11,
    "created_at": "2024-11-08T08:23:04.391Z",
    "last_posted_at": "2025-02-12T10:22:42.934Z",
    "views": 699,
    "like_count": 5,
    "reply_count": 5,
    "has_accepted_answer": true,
    "accepted_answer_post_number": 9,
    "accepted_answer_username": "PgBiel",
    "tags": [
      "scripting",
      "literature"
    ],
    "category_id": 5,
    "participant_count": 6,
    "word_count": 971
  },
  "posts": [
    {
      "id": 5304,
      "post_number": 1,
      "username": "Daniel_Nief",
      "name": "Daniel Nief",
      "created_at": "2024-11-08T08:23:04.515Z",
      "updated_at": "2025-02-05T15:05:52.233Z",
      "cooked": "<p>In my setup where I include my chapters into separate typ files and include them in my main file, I can create the bibliography in the main file and it detects all references across the included subfiles. However when previewing the parts, the referenced citation can’t be found, throwing an error and file preview is disabled. I can’t import the same bibliography either, since only one is supported. It has to be shared somehow but I don’t know how.</p>",
      "raw": "In my setup where I include my chapters into separate typ files and include them in my main file, I can create the bibliography in the main file and it detects all references across the included subfiles. However when previewing the parts, the referenced citation can't be found, throwing an error and file preview is disabled. I can't import the same bibliography either, since only one is supported. It has to be shared somehow but I don't know how.",
      "reply_to_post_number": null,
      "reply_count": 0,
      "quote_count": 0,
      "like_count": 1,
      "reads": 79,
      "score": 2985.8,
      "accepted_answer": false,
      "trust_level": 1,
      "user_id": 768
    },
    {
      "id": 5309,
      "post_number": 2,
      "username": "danborek",
      "name": "danborek",
      "created_at": "2024-11-08T13:19:23.948Z",
      "updated_at": "2024-11-08T13:19:23.948Z",
      "cooked": "<p>there was an workaround, but it stopped working in 0.12<br>\n<a href=\"https://github.com/typst/typst/issues/1097\" class=\"inline-onebox\" rel=\"noopener nofollow ugc\">Multiple bibliographies · Issue #1097 · typst/typst · GitHub</a></p>",
      "raw": "there was an workaround, but it stopped working in 0.12\n https://github.com/typst/typst/issues/1097",
      "reply_to_post_number": null,
      "reply_count": 0,
      "quote_count": 0,
      "like_count": 0,
      "reads": 79,
      "score": 35.8,
      "accepted_answer": false,
      "trust_level": 1,
      "user_id": 410
    },
    {
      "id": 5311,
      "post_number": 3,
      "username": "quachpas",
      "name": "Pascal Quach",
      "created_at": "2024-11-08T13:44:31.589Z",
      "updated_at": "2024-11-08T13:44:31.589Z",
      "cooked": "<p>Hello <a class=\"mention\" href=\"/u/daniel_nief\">@Daniel_Nief</a>, have you looked at</p>\n<ul>\n<li><a href=\"https://forum.typst.app/t/why-cant-i-use-a-function-in-a-chapter-even-though-i-imported-it-at-the-start-of-my-main-file/196/7\" class=\"inline-onebox\">Why can't I use a function in a chapter even though I imported it at the start of my main file? - #7 by PgBiel</a></li>\n<li><a href=\"https://forum.typst.app/t/best-practices-for-working-with-longer-documents/1228\" class=\"inline-onebox\">Best practices for working with longer documents</a></li>\n</ul>\n<p>I think it might help you!</p>\n<p>In any case, if you could tell us more about how you “preview the parts”, we could help you more.</p>",
      "raw": "Hello @Daniel_Nief, have you looked at \n- https://forum.typst.app/t/why-cant-i-use-a-function-in-a-chapter-even-though-i-imported-it-at-the-start-of-my-main-file/196/7\n- https://forum.typst.app/t/best-practices-for-working-with-longer-documents/1228\n\n\nI think it might help you! \n\nIn any case, if you could tell us more about how you \"preview the parts\", we could help you more.",
      "reply_to_post_number": null,
      "reply_count": 1,
      "quote_count": 0,
      "like_count": 1,
      "reads": 78,
      "score": 90.6,
      "accepted_answer": false,
      "trust_level": 3,
      "user_id": 258
    },
    {
      "id": 5968,
      "post_number": 4,
      "username": "Daniel_Nief",
      "name": "Daniel Nief",
      "created_at": "2024-11-21T15:42:18.561Z",
      "updated_at": "2025-01-03T18:54:18.797Z",
      "cooked": "<p>Those are some interesting sources but it didn’t quite solve the problem.<br>\nImporting the bibliography directly into the parts will lead to multiple bibliographies, which his not allowed.</p>\n<p>Here’s my setup:</p>\n<ul>\n<li>main.typ</li>\n<li>template.typ</li>\n<li>parts/\n<ul>\n<li>part1.typ</li>\n<li>part1.typ</li>\n</ul>\n</li>\n</ul>\n<p><strong>main.typ:</strong></p>\n<pre data-code-wrap=\"typ\"><code class=\"lang-typ\">#import \"styles.typ\" : *\n#show: layout\n...\n@source\n#include \"parts/part1.typ\"\n#include \"parts/part2.typ\"\n#bibliography(\"references.yml\")\n</code></pre>\n<p><strong>part1.typ &amp; part2.typ:</strong></p>\n<pre data-code-wrap=\"typ\"><code class=\"lang-typ\">#import \"styles.typ\" : *\n#show: layout\n@source\n...\n</code></pre>\n<p>In my references if have a source, it can be accessed using the label <code>&lt;source&gt;</code> or <code>@source</code>. But only if there’s a bibliography present in the file.<br>\nSo when I cite <code>@source1</code> in main.typ, it works. When I cite  <code>@source</code> in main.typ, I can preview main.typ because it knows the bibliography, I can’t preview part1.typ because it doesn’t recognize the label, because there’s no bibliography in part1.typ</p>\n<p>Now if I store the bibliography in a variable and add it to main.typ and part1.typ, this will generate two bibliography objects, throwing the error that I can’t have two bibliographies.</p>\n<p>I’ve seen the workaround of overwriting the labels at the beginning of the parts, but it’s a workaround, not a solution, it won’t show the source in the bibliography of main.typ with the workaround in place.</p>",
      "raw": "Those are some interesting sources but it didn't quite solve the problem. \nImporting the bibliography directly into the parts will lead to multiple bibliographies, which his not allowed.\n\nHere's my setup:\n* main.typ\n* template.typ\n* parts/\n  * part1.typ\n  * part1.typ\n\n**main.typ:**\n\n  ```typ\n  #import \"styles.typ\" : *\n  #show: layout\n  ...\n  @source\n  #include \"parts/part1.typ\"\n  #include \"parts/part2.typ\"\n  #bibliography(\"references.yml\")\n  ```\n\n**part1.typ & part2.typ:**\n  ```typ\n  #import \"styles.typ\" : *\n  #show: layout\n  @source\n  ...\n  ```\n\nIn my references if have a source, it can be accessed using the label `<source>` or `@source`. But only if there's a bibliography present in the file.\nSo when I cite `@source1` in main.typ, it works. When I cite  `@source` in main.typ, I can preview main.typ because it knows the bibliography, I can't preview part1.typ because it doesn't recognize the label, because there's no bibliography in part1.typ\n\nNow if I store the bibliography in a variable and add it to main.typ and part1.typ, this will generate two bibliography objects, throwing the error that I can't have two bibliographies.\n\nI've seen the workaround of overwriting the labels at the beginning of the parts, but it's a workaround, not a solution, it won't show the source in the bibliography of main.typ with the workaround in place.",
      "reply_to_post_number": 3,
      "reply_count": 1,
      "quote_count": 0,
      "like_count": 0,
      "reads": 69,
      "score": 43.8,
      "accepted_answer": false,
      "trust_level": 1,
      "user_id": 768
    },
    {
      "id": 5969,
      "post_number": 5,
      "username": "quachpas",
      "name": "Pascal Quach",
      "created_at": "2024-11-21T15:45:07.601Z",
      "updated_at": "2024-11-21T15:45:07.601Z",
      "cooked": "<aside class=\"quote no-group\" data-username=\"Daniel_Nief\" data-post=\"4\" data-topic=\"1605\">\n<div class=\"title\">\n<div class=\"quote-controls\"></div>\n<img loading=\"lazy\" alt=\"\" width=\"24\" height=\"24\" src=\"https://forum.typst.app/letter_avatar_proxy/v4/letter/d/C2387F/48.png\" class=\"avatar\"> Daniel_Nief:</div>\n<blockquote>\n<p>I can’t preview part1.typ because it doesn’t recognize the label, because there’s no bibliography in part1.typ</p>\n</blockquote>\n</aside>\n<p>I’m wondering what your use case would be to individually preview each part of your document? Is the compile time an issue?</p>",
      "raw": "[quote=\"Daniel_Nief, post:4, topic:1605\"]\nI can’t preview part1.typ because it doesn’t recognize the label, because there’s no bibliography in part1.typ\n[/quote]\n\nI'm wondering what your use case would be to individually preview each part of your document? Is the compile time an issue?",
      "reply_to_post_number": 4,
      "reply_count": 1,
      "quote_count": 1,
      "like_count": 0,
      "reads": 58,
      "score": 36.6,
      "accepted_answer": false,
      "trust_level": 3,
      "user_id": 258
    },
    {
      "id": 5970,
      "post_number": 6,
      "username": "Daniel_Nief",
      "name": "Daniel Nief",
      "created_at": "2024-11-21T15:48:05.677Z",
      "updated_at": "2024-11-21T15:48:05.677Z",
      "cooked": "<p>Well previewing main.typ would suffice, it really is nice, compared to other tools. There’s just little icks caused by the missing references like VS Code marking pages red adding to it.</p>\n<p>Not a real problem but would be nice to have a consistent fix.</p>",
      "raw": "Well previewing main.typ would suffice, it really is nice, compared to other tools. There's just little icks caused by the missing references like VS Code marking pages red adding to it.\n\nNot a real problem but would be nice to have a consistent fix.",
      "reply_to_post_number": 5,
      "reply_count": 1,
      "quote_count": 0,
      "like_count": 0,
      "reads": 56,
      "score": 26.2,
      "accepted_answer": false,
      "trust_level": 1,
      "user_id": 768
    },
    {
      "id": 5971,
      "post_number": 7,
      "username": "quachpas",
      "name": "Pascal Quach",
      "created_at": "2024-11-21T15:52:58.716Z",
      "updated_at": "2024-11-21T15:52:58.716Z",
      "cooked": "<p>What I suggest is to setup a conditional bibliography command. See <a href=\"https://forum.typst.app/t/can-i-configure-my-document-e-g-draft-release-version-color-theme-when-creating-a-pdf-without-modifying-the-typst-file-directly/160\" class=\"inline-onebox\">Can I configure my document (e.g. draft/release version, color theme) when creating a PDF without modifying the Typst file directly?</a>, so it will only import the references in the subfiles when you are in “subfile mode”.</p>\n<p>In any case, I am curious about your issues with missing references, could you give more details?</p>",
      "raw": "What I suggest is to setup a conditional bibliography command. See https://forum.typst.app/t/can-i-configure-my-document-e-g-draft-release-version-color-theme-when-creating-a-pdf-without-modifying-the-typst-file-directly/160, so it will only import the references in the subfiles when you are in \"subfile mode\".\n\nIn any case, I am curious about your issues with missing references, could you give more details?",
      "reply_to_post_number": 6,
      "reply_count": 1,
      "quote_count": 0,
      "like_count": 0,
      "reads": 58,
      "score": 46.6,
      "accepted_answer": false,
      "trust_level": 3,
      "user_id": 258
    },
    {
      "id": 5973,
      "post_number": 8,
      "username": "Daniel_Nief",
      "name": "Daniel Nief",
      "created_at": "2024-11-21T17:05:21.722Z",
      "updated_at": "2024-11-21T17:05:21.722Z",
      "cooked": "<p>There’s actually not much more to it other than VS Code error detection and the subfile not being able to compile. I’ll just preview main.typ from now on and/or use the dummy workaround for now. There’s not much configuration needed for it so…</p>",
      "raw": "There's actually not much more to it other than VS Code error detection and the subfile not being able to compile. I'll just preview main.typ from now on and/or use the dummy workaround for now. There's not much configuration needed for it so...",
      "reply_to_post_number": 7,
      "reply_count": 0,
      "quote_count": 0,
      "like_count": 0,
      "reads": 54,
      "score": 35.8,
      "accepted_answer": false,
      "trust_level": 1,
      "user_id": 768
    },
    {
      "id": 5980,
      "post_number": 9,
      "username": "PgBiel",
      "name": "",
      "created_at": "2024-11-22T04:33:55.903Z",
      "updated_at": "2024-11-22T04:35:48.288Z",
      "cooked": "<p>This is a pretty well-known request: <a href=\"https://github.com/typst/typst/issues/4035\" class=\"inline-onebox\">Downgrade missing references from errors to warning · Issue #4035 · typst/typst · GitHub</a></p>\n<p>The main problem is that Typst can’t figure out what to reference if there’s no bibliography. What is being requested in the issue is the ability to ignore missing references so you can get an idea of how the file looks like (but it of course won’t be fully accurate). While that’s not implemented, you’ll have to resort to workarounds.</p>\n<p>Here’s one potential way to do it: a common <code>load-bib</code> function which does not render duplicate bibliographies, but gives priority to the bibliography loaded with <code>load-bib(main: true)</code> in the main file:</p>\n<pre data-code-wrap=\"typ\"><code class=\"lang-typ\">// bib.typ\n#let load-bib(main: false) = {\n  counter(\"bibs\").step()\n\n  context if main {\n    [#bibliography(\"bib.yml\") &lt;main-bib&gt;]\n  } else if query(&lt;main-bib&gt;) == () and counter(\"bibs\").get().first() == 1 {\n    // This is the first bibliography, and there is no main bibliography\n    bibliography(\"bib.yml\")\n  }\n}\n</code></pre>\n<p>You can use this in non-main files as follows:</p>\n<pre data-code-wrap=\"typ\"><code class=\"lang-typ\">// NON-MAIN FILE\n\n// Assuming bib.typ is at the root of the project\n// so we don't have to specify full relative paths each time\n#import \"/bib.typ\": load-bib\n\n// ...File contents...\n\n#load-bib()\n</code></pre>\n<p>And in the main file as follows:</p>\n<pre data-code-wrap=\"typ\"><code class=\"lang-typ\">// MAIN FILE\n\n#import \"/bib.typ\": load-bib\n\n#include \"some-non-main-file.typ\"\n\n// ...File contents...\n\n// 'main: true' to indicate this bibliography\n// must be prioritized\n#load-bib(main: true)\n</code></pre>\n<p>Since only the first bibliography is loaded (or the main bibliography, if there is one), this also supports <code>#include</code> between auxiliary (non-main) files!</p>\n<p>You can also use <code>hide(bibliography(\"bib.yml\"))</code> in the <code>else</code> of the function if you’d like to turn the bibliography invisible when compiling a non-main file.</p>",
      "raw": "This is a pretty well-known request: https://github.com/typst/typst/issues/4035\n\nThe main problem is that Typst can't figure out what to reference if there's no bibliography. What is being requested in the issue is the ability to ignore missing references so you can get an idea of how the file looks like (but it of course won't be fully accurate). While that's not implemented, you'll have to resort to workarounds.\n\nHere's one potential way to do it: a common `load-bib` function which does not render duplicate bibliographies, but gives priority to the bibliography loaded with `load-bib(main: true)` in the main file:\n\n```typ\n// bib.typ\n#let load-bib(main: false) = {\n  counter(\"bibs\").step()\n\n  context if main {\n    [#bibliography(\"bib.yml\") <main-bib>]\n  } else if query(<main-bib>) == () and counter(\"bibs\").get().first() == 1 {\n    // This is the first bibliography, and there is no main bibliography\n    bibliography(\"bib.yml\")\n  }\n}\n```\n\nYou can use this in non-main files as follows:\n\n```typ\n// NON-MAIN FILE\n\n// Assuming bib.typ is at the root of the project\n// so we don't have to specify full relative paths each time\n#import \"/bib.typ\": load-bib\n\n// ...File contents...\n\n#load-bib()\n```\n\nAnd in the main file as follows:\n\n```typ\n// MAIN FILE\n\n#import \"/bib.typ\": load-bib\n\n#include \"some-non-main-file.typ\"\n\n// ...File contents...\n\n// 'main: true' to indicate this bibliography\n// must be prioritized\n#load-bib(main: true)\n```\n\nSince only the first bibliography is loaded (or the main bibliography, if there is one), this also supports `#include` between auxiliary (non-main) files!\n\nYou can also use `hide(bibliography(\"bib.yml\"))` in the `else` of the function if you'd like to turn the bibliography invisible when compiling a non-main file.",
      "reply_to_post_number": null,
      "reply_count": 0,
      "quote_count": 0,
      "like_count": 2,
      "reads": 54,
      "score": 225.8,
      "accepted_answer": true,
      "trust_level": 2,
      "user_id": 3
    },
    {
      "id": 6936,
      "post_number": 10,
      "username": "Paul",
      "name": "Paul",
      "created_at": "2024-12-26T17:03:42.055Z",
      "updated_at": "2024-12-26T17:03:42.055Z",
      "cooked": "<p>One other way to permit multiple bibliography is to completely override the <code>bibliography</code> and <code>cite</code> function. This permits to have some multiple files with different bibliography. This is addressed by this package I think : <a href=\"https://github.com/pauladam94/multi-bib/tree/main\" class=\"inline-onebox\" rel=\"noopener nofollow ugc\">GitHub - pauladam94/multi-bib: Typst multiple bibliographie using same citation an bibliographie syntax.</a>.</p>",
      "raw": "One other way to permit multiple bibliography is to completely override the `bibliography` and `cite` function. This permits to have some multiple files with different bibliography. This is addressed by this package I think : https://github.com/pauladam94/multi-bib/tree/main.",
      "reply_to_post_number": null,
      "reply_count": 0,
      "quote_count": 0,
      "like_count": 1,
      "reads": 38,
      "score": 57.6,
      "accepted_answer": false,
      "trust_level": 1,
      "user_id": 564
    },
    {
      "id": 8502,
      "post_number": 11,
      "username": "YossiYanou",
      "name": "Yossi Yanou",
      "created_at": "2025-02-12T10:22:42.934Z",
      "updated_at": "2025-02-12T10:22:42.934Z",
      "cooked": "<p><a class=\"mention\" href=\"/u/daniel_nief\">@Daniel_Nief</a> I believe this is what you’re looking for (Tinymist Extension):</p>\n<p><div class=\"lightbox-wrapper\"><a class=\"lightbox\" href=\"https://forum.typst.app/uploads/default/original/2X/5/51e8eae5a7f4aec83fb74dab603b29d76b410596.png\" data-download-href=\"https://forum.typst.app/uploads/default/51e8eae5a7f4aec83fb74dab603b29d76b410596\" title=\"Screenshot 2025-02-12 at 11.21.07\"><img src=\"https://forum.typst.app/uploads/default/optimized/2X/5/51e8eae5a7f4aec83fb74dab603b29d76b410596_2_690x213.png\" alt=\"Screenshot 2025-02-12 at 11.21.07\" data-base62-sha1=\"bGBHjLNwos5zh7hVjEpGRb2yx4G\" width=\"690\" height=\"213\" srcset=\"https://forum.typst.app/uploads/default/optimized/2X/5/51e8eae5a7f4aec83fb74dab603b29d76b410596_2_690x213.png, https://forum.typst.app/uploads/default/optimized/2X/5/51e8eae5a7f4aec83fb74dab603b29d76b410596_2_1035x319.png 1.5x, https://forum.typst.app/uploads/default/optimized/2X/5/51e8eae5a7f4aec83fb74dab603b29d76b410596_2_1380x426.png 2x\" data-dominant-color=\"1A1D23\"><div class=\"meta\"><svg class=\"fa d-icon d-icon-far-image svg-icon\" aria-hidden=\"true\"><use href=\"#far-image\"></use></svg><span class=\"filename\">Screenshot 2025-02-12 at 11.21.07</span><span class=\"informations\">1742×540 117 KB</span><svg class=\"fa d-icon d-icon-discourse-expand svg-icon\" aria-hidden=\"true\"><use href=\"#discourse-expand\"></use></svg></div></a></div></p>",
      "raw": "@Daniel_Nief I believe this is what you're looking for (Tinymist Extension):\n\n![Screenshot 2025-02-12 at 11.21.07|690x213](upload://bGBHjLNwos5zh7hVjEpGRb2yx4G.png)",
      "reply_to_post_number": null,
      "reply_count": 0,
      "quote_count": 0,
      "like_count": 0,
      "reads": 26,
      "score": 15.2,
      "accepted_answer": false,
      "trust_level": 1,
      "user_id": 1183
    }
  ],
  "scraped_at": "2025-06-10T09:55:18.973865"
}